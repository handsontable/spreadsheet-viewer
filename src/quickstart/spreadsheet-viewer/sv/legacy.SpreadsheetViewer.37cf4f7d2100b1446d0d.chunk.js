/*!
 * Spreadsheet Viewer
 * 
 * Version: 1.0.0
 * Code version: 3346fe0
 * Build date: Tue, January 12, 2021, 11:46 PM GMT+1
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[2],Array(155).concat([function(e,t,n){"use strict";n.r(t),n.d(t,"duckSchema",(function(){return a})),n.d(t,"inherit",(function(){return l})),n.d(t,"extend",(function(){return s})),n.d(t,"deepExtend",(function(){return c})),n.d(t,"deepClone",(function(){return u})),n.d(t,"clone",(function(){return f})),n.d(t,"mixin",(function(){return h})),n.d(t,"isObjectEqual",(function(){return d})),n.d(t,"isObject",(function(){return p})),n.d(t,"defineGetter",(function(){return v})),n.d(t,"objectEach",(function(){return y})),n.d(t,"getProperty",(function(){return g})),n.d(t,"setProperty",(function(){return m})),n.d(t,"deepObjectSize",(function(){return b})),n.d(t,"createObjectPropListener",(function(){return w})),n.d(t,"hasOwnProperty",(function(){return C}));var r=n(156);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){var t;return Array.isArray(e)?t=[]:(t={},y(e,(function(e,n){"__children"!==n&&(e&&"object"===i(e)&&!Array.isArray(e)?t[n]=a(e):Array.isArray(e)?e.length&&"object"===i(e[0])&&!Array.isArray(e[0])?t[n]=[a(e[0])]:t[n]=[]:t[n]=null)}))),t}function l(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function s(e,t,n){var r=Array.isArray(n);return y(t,(function(t,o){(!1===r||n.includes(o))&&(e[o]=t)})),e}function c(e,t){y(t,(function(n,r){t[r]&&"object"===i(t[r])?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),c(e[r],t[r])):e[r]=t[r]}))}function u(e){return"object"===i(e)?JSON.parse(JSON.stringify(e)):e}function f(e){var t={};return y(e,(function(e,n){t[n]=e})),t}function h(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return Object(r.arrayEach)(n,(function(t){e.MIXINS.push(t.MIXIN_NAME),y(t,(function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"==typeof t)e.prototype[n]=t;else{Object.defineProperty(e.prototype,n,{get:(r=n,o=t,i="_".concat(r),function(){var e;return void 0===this[i]&&(this[i]=(e=o,(Array.isArray(e)||p(e))&&(e=u(e)),e)),this[i]}),set:function(e){var t="_".concat(e);return function(e){this[t]=e}}(n),configurable:!0})}var r,o,i}))})),e}function d(e,t){return JSON.stringify(e)===JSON.stringify(t)}function p(e){return"[object Object]"===Object.prototype.toString.call(e)}function v(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function y(e,t){for(var n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function g(e,t){var n=t.split("."),r=e;return y(n,(function(e){if(void 0===(r=r[e]))return r=void 0,!1})),r}function m(e,t,n){var r=t.split("."),o=e;r.forEach((function(e,t){t!==r.length-1?(C(o,e)||(o[e]={}),o=o[e]):o[e]=n}))}function b(e){if(!p(e))return 0;return function e(t){var n=0;return p(t)?y(t,(function(t,r){"__children"!==r&&(n+=e(t))})):n+=1,n}(e)}function w(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",r="_".concat(n),i=(o(t={_touched:!1},r,e),o(t,"isTouched",(function(){return this._touched})),t);return Object.defineProperty(i,n,{get:function(){return this[r]},set:function(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),i}function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},function(e,t,n){"use strict";function r(e){for(var t=e.length,n=0;n<t;)e[n]=[e[n]],n+=1}function o(e,t){for(var n=t.length,r=0;r<n;)e.push(t[r]),r+=1}function i(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,r=e[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function a(e,t,n,r){var o=-1,i=e,a=n;Array.isArray(e)||(i=Array.from(e));var l=i.length;for(r&&l&&(a=i[o+=1]),o+=1;o<l;)a=t(a,i[o],o,i),o+=1;return a}function l(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length,i=[],a=-1;n<o;){var l=r[n];t(l,n,r)&&(i[a+=1]=l),n+=1}return i}function s(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length,i=[],a=-1;n<o;){var l=r[n];i[a+=1]=t(l,n,r),n+=1}return i}function c(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var o=r.length;n<o&&!1!==t(r[n],n,r);)n+=1;return e}function u(e){return a(e,(function(e,t){return e+t}),0)}function f(e){return a(e,(function(e,t){return e>t?e:t}),Array.isArray(e)?e[0]:void 0)}function h(e){return a(e,(function(e,t){return e<t?e:t}),Array.isArray(e)?e[0]:void 0)}function d(e){return e.length?u(e)/e.length:0}function p(e){return a(e,(function(e,t){return e.concat(Array.isArray(t)?p(t):t)}),[])}function v(e){var t=[];return c(e,(function(e){-1===t.indexOf(e)&&t.push(e)})),t}function y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=o;return c(i,(function(e){a=a.filter((function(t){return!e.includes(t)}))})),a}function g(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=o;return c(i,(function(e){a=a.filter((function(t){return e.includes(t)}))})),a}function m(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),o=r[0],i=r.slice(1),a=new Set(o);return c(i,(function(e){c(e,(function(e){a.has(e)||a.add(e)}))})),Array.from(a)}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}n.r(t),n.d(t,"to2dArray",(function(){return r})),n.d(t,"extendArray",(function(){return o})),n.d(t,"pivot",(function(){return i})),n.d(t,"arrayReduce",(function(){return a})),n.d(t,"arrayFilter",(function(){return l})),n.d(t,"arrayMap",(function(){return s})),n.d(t,"arrayEach",(function(){return c})),n.d(t,"arraySum",(function(){return u})),n.d(t,"arrayMax",(function(){return f})),n.d(t,"arrayMin",(function(){return h})),n.d(t,"arrayAvg",(function(){return d})),n.d(t,"arrayFlatten",(function(){return p})),n.d(t,"arrayUnique",(function(){return v})),n.d(t,"getDifferenceOfArrays",(function(){return y})),n.d(t,"getIntersectionOfArrays",(function(){return g})),n.d(t,"getUnionOfArrays",(function(){return m})),n.d(t,"stringToArray",(function(){return b}))},function(e,t,n){"use strict";n.r(t),n.d(t,"getParent",(function(){return p})),n.d(t,"getFrameElement",(function(){return v})),n.d(t,"getParentWindow",(function(){return y})),n.d(t,"hasAccessToParentWindow",(function(){return g})),n.d(t,"closest",(function(){return m})),n.d(t,"closestDown",(function(){return b})),n.d(t,"isChildOf",(function(){return w})),n.d(t,"index",(function(){return C})),n.d(t,"overlayContainsElement",(function(){return O})),n.d(t,"hasClass",(function(){return T})),n.d(t,"addClass",(function(){return k})),n.d(t,"removeClass",(function(){return j})),n.d(t,"removeTextNodes",(function(){return M})),n.d(t,"empty",(function(){return A})),n.d(t,"HTML_CHARACTERS",(function(){return N})),n.d(t,"fastInnerHTML",(function(){return _})),n.d(t,"fastInnerText",(function(){return H})),n.d(t,"isVisible",(function(){return I})),n.d(t,"offset",(function(){return x})),n.d(t,"getWindowScrollTop",(function(){return L})),n.d(t,"getWindowScrollLeft",(function(){return P})),n.d(t,"getScrollTop",(function(){return D})),n.d(t,"getScrollLeft",(function(){return B})),n.d(t,"clientWidth",(function(){return F})),n.d(t,"clientHeight",(function(){return V})),n.d(t,"offsetWidth",(function(){return W})),n.d(t,"offsetHeight",(function(){return U})),n.d(t,"scrollWidth",(function(){return z})),n.d(t,"scrollHeight",(function(){return G})),n.d(t,"getScrollableElement",(function(){return X})),n.d(t,"getTrimmingContainer",(function(){return K})),n.d(t,"getStyle",(function(){return Y})),n.d(t,"matchesCSSRules",(function(){return q})),n.d(t,"getComputedStyle",(function(){return $})),n.d(t,"outerWidth",(function(){return Q})),n.d(t,"outerHeight",(function(){return Z})),n.d(t,"innerHeight",(function(){return ee})),n.d(t,"innerWidth",(function(){return te})),n.d(t,"addEvent",(function(){return ne})),n.d(t,"removeEvent",(function(){return re})),n.d(t,"getCaretPosition",(function(){return oe})),n.d(t,"getSelectionEndPosition",(function(){return ie})),n.d(t,"getSelectionText",(function(){return ae})),n.d(t,"clearTextSelection",(function(){return le})),n.d(t,"setCaretPosition",(function(){return se})),n.d(t,"getScrollbarWidth",(function(){return ue})),n.d(t,"hasVerticalScrollbar",(function(){return fe})),n.d(t,"hasHorizontalScrollbar",(function(){return he})),n.d(t,"setOverlayPosition",(function(){return de})),n.d(t,"getCssTransform",(function(){return pe})),n.d(t,"resetCssTransform",(function(){return ve})),n.d(t,"isInput",(function(){return ye})),n.d(t,"isOutsideInput",(function(){return ge})),n.d(t,"selectElementIfAllowed",(function(){return me})),n.d(t,"getBoundingClientRect",(function(){return be})),n.d(t,"clearMemoizedFunctionsBeforeRender",(function(){return Ce}));var r,o,i,a=n(176),l=n(169),s=n(262),c=n.n(s),u=function(e){var t=c()(e,{maxSize:1/0});return t.cache.orderByLru=function(e,n,r){t.cache.keys[r]=e,t.cache.values[r]=n},t.clear=function(){t.cache.keys.length=0,t.cache.values.length=0},t},f=function(e){return e.clear=function(){},e};function h(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,o=e;null!==o;){if(n===t){r=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(n+=1,o=o.parentNode)}return r}function v(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function y(e){return v(e)&&e.parent}function g(e){return!!Object.getPrototypeOf(e.parent)}function m(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=Node,o=r.ELEMENT_NODE,i=r.DOCUMENT_FRAGMENT_NODE,a=e;null!=a&&a!==n;){var l=a,s=l.nodeType,c=l.nodeName;if(s===o&&(t.includes(c)||t.includes(a)))return a;var u=a,f=u.host;a=f&&s===i?f:a.parentNode}return null}function b(e,t,n){for(var r=[],o=e;o&&(o=m(o,t,n))&&(!n||n.contains(o));)r.push(o),o=o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode;var i=r.length;return i?r[i-1]:null}function w(e,t){var n=e.parentNode,r=[];for("string"==typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function C(e){var t=0,n=e;if(n.previousSibling)for(;n=n.previousSibling;)t+=1;return t}function O(e,t,n){var r=n.parentElement.querySelector(".ht_clone_".concat(e));return r?r.contains(t):null}function E(e){return e&&e.length?e.filter((function(e){return!!e})):[]}if(Object(a.isClassListSupported)()){var S=function(e){var t=e.createElement("div");return t.classList.add("test","test2"),t.classList.contains("test2")};r=function(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)},o=function(e,t){var n,r=e.ownerDocument,o=t;if("string"==typeof o&&(o=o.split(" ")),(o=E(o)).length>0)if(S(r))(n=e.classList).add.apply(n,h(o));else for(var i=0;o&&o[i];)e.classList.add(o[i]),i+=1},i=function(e,t){var n,r=t;if("string"==typeof r&&(r=r.split(" ")),(r=E(r)).length>0)if(S)(n=e.classList).remove.apply(n,h(r));else for(var o=0;r&&r[o];)e.classList.remove(r[o]),o+=1}}else{var R=function(e){return new RegExp("(\\s|^)".concat(e,"(\\s|$)"))};r=function(e,t){return void 0!==e.className&&R(t).test(e.className)},o=function(e,t){var n=e.className,r=t;if("string"==typeof r&&(r=r.split(" ")),""===n)n=r.join(" ");else for(var o=0;o<r.length;o++)r[o]&&!R(r[o]).test(n)&&(n+=" ".concat(r[o]));e.className=n},i=function(e,t){var n=0,r=e.className,o=t;for("string"==typeof o&&(o=o.split(" "));o&&o[n];)r=r.replace(R(o[n])," ").trim(),n+=1;e.className!==r&&(e.className=r)}}function T(e,t){return r(e,t)}function k(e,t){o(e,t)}function j(e,t){i(e,t)}function M(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,n=t.length-1;n>=0;n--)M(t[n])}function A(e){for(var t;t=e.lastChild;)e.removeChild(t)}var N=/(<(.*)>|&(.*);)/;function _(e,t){N.test(t)?e.innerHTML=t:H(e,t)}function H(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?a.isTextContentSupported?n.textContent=t:n.data=t:(A(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function I(e){for(var t=e.ownerDocument.documentElement,n=e;n!==t;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return I(n.host.impl);if(n.host)return I(n.host);throw new Error("Lost in Web Components world")}return!1}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}function x(e){var t,n,r,o,i=e.ownerDocument,l=i.defaultView,s=i.documentElement,c=e;if(Object(a.hasCaptionProblem)()&&c.firstChild&&"CAPTION"===c.firstChild.nodeName)return{top:(o=be(c)).top+(l.pageYOffset||s.scrollTop)-(s.clientTop||0),left:o.left+(l.pageXOffset||s.scrollLeft)-(s.clientLeft||0)};for(t=c.offsetLeft,n=c.offsetTop,r=c;(c=c.offsetParent)&&c!==i.body;)t+=c.offsetLeft,n+=c.offsetTop,r=c;return r&&"fixed"===r.style.position&&(t+=l.pageXOffset||s.scrollLeft,n+=l.pageYOffset||s.scrollTop),{left:t,top:n}}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollY;return void 0===t&&(t=e.document.documentElement.scrollTop),t}function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.scrollX;return void 0===t&&(t=e.document.documentElement.scrollLeft),t}var D=u((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?L(t):e.scrollTop}));function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?P(t):e.scrollLeft}var F=u((function(e){return e.clientWidth})),V=f((function(e){return e.clientHeight})),W=f((function(e){return e.offsetWidth})),U=f((function(e){return e.offsetHeight})),z=f((function(e){return e.scrollWidth})),G=f((function(e){return e.scrollHeight}));function X(e){var t=e.ownerDocument,n=t?t.defaultView:void 0;t||(n=(t=e.document?e.document:e).defaultView);for(var r=["auto","scroll"],o=Object(a.isGetComputedStyleSupported)(),i=e.parentNode;i&&i.style&&t.body!==i;){var l=i.style,s=l.overflow,c=l.overflowX,u=l.overflowY;if([s,c,u].includes("scroll"))return i;if(o){var f=$(i,n);if(s=f.overflow,c=f.overflowX,u=f.overflowY,r.includes(s)||r.includes(c)||r.includes(u))return i}if(V(i)<=G(i)+1&&(r.includes(u)||r.includes(s)))return i;if(F(i)<=z(i)+1&&(r.includes(c)||r.includes(s)))return i;i=i.parentNode}return n}function K(e){for(var t=e.ownerDocument,n=t.defaultView,r=e.parentNode;r&&r.style&&t.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var o=$(r,n),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),s=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(l)||i.includes(s))return r;r=r.parentNode}return n}function Y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(e){if(e===n)return"width"===t?"".concat(n.innerWidth,"px"):"height"===t?"".concat(n.innerHeight,"px"):void 0;var r=e.style[t];if(""!==r&&void 0!==r)return r;var o=$(e,n);return""!==o[t]&&void 0!==o[t]?o[t]:void 0}}function q(e,t){var n=t.selectorText,r=!1;return t.type===CSSRule.STYLE_RULE&&n&&(e.msMatchesSelector?r=e.msMatchesSelector(n):e.matches&&(r=e.matches(n))),r}var $=f((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}));function Q(e){return W(e)}function Z(e){return Object(a.hasCaptionProblem)()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?U(e)+U(e.firstChild):U(e)}var J,ee=u((function(e){return V(e)||e.innerHeight})),te=u((function(e){return F(e)||e.innerWidth}));function ne(e,t,n){e.addEventListener(t,n,!1)}function re(e,t,n){e.removeEventListener(t,n,!1)}function oe(e){var t=e.ownerDocument;if(e.selectionStart)return e.selectionStart;if(t.selection){e.focus();var n=t.selection.createRange();if(null===n)return 0;var r=e.createTextRange(),o=r.duplicate();return r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length}return 0}function ie(e){var t=e.ownerDocument;if(e.selectionEnd)return e.selectionEnd;if(t.selection){var n=t.selection.createRange();return null===n?0:e.createTextRange().text.indexOf(n.text)+n.text.length}return 0}function ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,n="";return e.getSelection?n=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(n=t.selection.createRange().text),n}function le(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document;e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():t.selection&&t.selection.empty()}function se(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(i){var r=e.parentNode,o=r.style.display;r.style.display="block",e.setSelectionRange(t,n),r.style.display=o}}}function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);var r=W(t);n.style.overflow="scroll";var o=W(t);return r===o&&(o=F(n)),(e.body||e.documentElement).removeChild(n),r-o}function ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===J&&(J=ce(e)),J}function fe(e){return W(e)!==F(e)}function he(e){return U(e)!==V(e)}function de(e,t,n){Object(l.isIE9)()?(e.style.top=n,e.style.left=t):Object(l.isSafari)()?(e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(n,",0)"),e.style["-webkit-transform"]="translate3d(".concat(t,",").concat(n,",0)")):e.style.transform="translate3d(".concat(t,",").concat(n,",0)")}function pe(e){var t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!==(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1}function ve(e){e.style.transform&&""!==e.style.transform?e.style.transform="":e.style["-webkit-transform"]&&""!==e.style["-webkit-transform"]&&(e.style["-webkit-transform"]="")}function ye(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function ge(e){return ye(e)&&!1===e.hasAttribute("data-hot-input")}function me(e){ge(e.ownerDocument.activeElement)||e.select()}var be=f((function(e){return e.getBoundingClientRect()})),we=[D,be,F,V,W,U,z,G,$,te,ee],Ce=function(){we.forEach((function(e){return e.clear()}))}},,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return pn})),n.d(t,"c",(function(){return Co}));function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}var a=new WeakMap,l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,o=t.scrollOffset,i=t.totalItems,l=t.itemSizeFn,s=t.overrideFn,c=t.calculationType,u=t.stretchMode,f=t.stretchingItemWidthFn,h=void 0===f?function(e){return e}:f;r(this,e),a.set(this,{viewportWidth:n,scrollOffset:o,totalColumns:i,columnWidthFn:l,overrideFn:s,calculationType:c,stretchingColumnWidthFn:h}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=u,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return i(e,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),i(e,[{key:"calculate",value:function(){for(var e,t=0,n=!0,r=[],o=a.get(this),i=o.calculationType,l=o.overrideFn,s=o.scrollOffset,c=o.totalColumns,u=o.viewportWidth,f=0;f<c;f++){if(e=this._getColumnWidth(f),t<=s&&2!==i&&(this.startColumn=f),t>=s&&t+(2===i?e:0)<=s+(s>0?u+1:u)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=f),this.endColumn=f),r.push(t),t+=e,2!==i&&(this.endColumn=f),t>=s+u){n=!1;break}}if(this.endColumn===c-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var h=r[this.endColumn]+e-r[this.startColumn-1];if((h<=u||2!==i)&&(this.startColumn-=1),h>u)break}1===i&&null!==this.startColumn&&l&&l(this),this.startPosition=r[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),c<this.endColumn&&(this.endColumn=c-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){var t=e;this.totalTargetWidth=t;for(var n=a.get(this),r=n.totalColumns,o=0,i=0;i<r;i++){var l=this._getColumnWidth(i),s=n.stretchingColumnWidthFn(void 0,i);"number"==typeof s?t-=s:o+=l}var c=t-o;if("all"===this.stretch&&c>0)this.stretchAllRatio=t/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var u=this._getColumnWidth(r-1),f=c+u;this.stretchLastWidth=f>=0?f:u}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,r=a.get(this),o=r.totalColumns;if(!this.stretchAllColumnsWidth[e]){var i=Math.round(t*this.stretchAllRatio),l=r.stretchingColumnWidthFn(i,e);this.stretchAllColumnsWidth[e]=void 0===l?i:isNaN(l)?this._getColumnWidth(e):l}if(this.stretchAllColumnsWidth.length===o&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var s=0;s<this.stretchAllColumnsWidth.length;s++)n+=this.stretchAllColumnsWidth[s];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){return e===a.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=a.get(this).columnWidthFn(t);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}]),e}();function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}var f=new WeakMap,h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,o=t.totalItems,i=t.itemSizeFn,a=t.overrideFn,l=t.calculationType,c=t.scrollbarHeight;s(this,e),f.set(this,{viewportHeight:n,scrollOffset:r,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:l,horizontalScrollbarHeight:c}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return u(e,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),u(e,[{key:"calculate",value:function(){for(var t,n=0,r=!0,o=[],i=f.get(this),a=i.calculationType,l=i.overrideFn,s=i.rowHeightFn,c=i.scrollOffset,u=i.totalRows,h=i.viewportHeight,d=i.horizontalScrollbarHeight||0,p=0;p<u;p++)if(t=s(p),isNaN(t)&&(t=e.DEFAULT_HEIGHT),n<=c&&2!==a&&(this.startRow=p),n>=c&&n+(2===a?t:0)<=c+h-d&&(null===this.startRow&&(this.startRow=p),this.endRow=p),o.push(n),n+=t,2!==a&&(this.endRow=p),n>=c+h-d){r=!1;break}if(this.endRow===u-1&&r)for(this.startRow=this.endRow;this.startRow>0;){var v=o[this.endRow]+t-o[this.startRow-1];if((v<=h-d||2!==a)&&(this.startRow-=1),v>=h-d)break}1===a&&null!==this.startRow&&l&&l(this),this.startPosition=o[this.startRow],void 0===this.startPosition&&(this.startPosition=null),u<this.endRow&&(this.endRow=u-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}]),e}();function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=null,this.col=null,void 0!==t&&void 0!==n&&(this.row=t,this.col=n)}var t,n,r;return t=e,(n=[{key:"isValid",value:function(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&this.col>=e.col}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&this.col<=e.col}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&this.col<=e.col}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&this.col>=e.col}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}])&&d(t.prototype,n),r&&d(t,r),e}();function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;v(this,e),this.highlight=t,this.from=n,this.to=r}var t,n,r;return t=e,(n=[{key:"setHighlight",value:function(e){return this.highlight=e,this}},{key:"setFrom",value:function(e){return this.from=e,this}},{key:"setTo",value:function(e){return this.to=e,this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(e){var t=e.row,n=e.col,r=this.getTopLeftCorner(),o=this.getBottomRightCorner();return r.row<=t&&o.row>=t&&r.col<=n&&o.col>=n}},{key:"includesRange",value:function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getTopRightCorner().col>=e.getTopLeftCorner().col&&this.getTopRightCorner().col<=e.getTopRightCorner().col||this.getTopLeftCorner().col<=e.getTopRightCorner().col&&this.getTopLeftCorner().col>=e.getTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getBottomRightCorner().row>=e.getTopRightCorner().row&&this.getBottomRightCorner().row<=e.getBottomRightCorner().row||this.getTopRightCorner().row<=e.getBottomRightCorner().row&&this.getTopRightCorner().row>=e.getTopRightCorner().row}},{key:"expand",value:function(e){var t=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=new p(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new p(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=this.getDirection(),o=e.getTopLeftCorner(),i=e.getBottomRightCorner(),a=Math.min(t.row,o.row),l=Math.min(t.col,o.col),s=Math.max(n.row,i.row),c=Math.max(n.col,i.col),u=new p(a,l),f=new p(s,c);return this.from=u,this.to=f,this.setDirection(r),this.highlight.row===this.getBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var o=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=o[0],this.to=o[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getCorners",value:function(){return[Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col),Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)]}},{key:"getTopLeftCorner",value:function(){return new p(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new p(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new p(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new p(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new p(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new p(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new p(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new p(t.to.row,t.to.col))))||e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner())}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof p))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new p(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new p(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new p(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new p(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),o=Math.max(this.from.col,this.to.col),i=Math.min(e.from.row,e.to.row),a=Math.max(e.from.row,e.to.row),l=Math.min(e.from.col,e.to.col),s=Math.max(e.from.col,e.to.col),c=[];return t===i&&c.push("top"),o===s&&c.push("right"),n===a&&c.push("bottom"),r===l&&c.push("left"),c}},{key:"getInner",value:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)this.from.row===r&&this.from.col===o||this.to.row===r&&this.to.col===o||n.push(new p(r,o));return n}},{key:"getAll",value:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],r=e.row;r<=t.row;r++)for(var o=e.col;o<=t.col;o++)e.row===r&&e.col===o?n.push(e):t.row===r&&t.col===o?n.push(t):n.push(new p(r,o));return n}},{key:"forAll",value:function(e){for(var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=t.row;r<=n.row;r++)for(var o=t.col;o<=n.col;o++)if(!1===e(r,o))return}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}}])&&y(t.prototype,n),r&&y(t,r),e}();function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=n,this.countTH=r}var t,n,r;return t=e,(n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}])&&m(t.prototype,n),r&&m(t,r),e}();function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t,this.total=n,this.countTH=r}var t,n,r;return t=e,(n=[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}])&&w(t.prototype,n),r&&w(t,r),e}(),O=n(157);function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}var t,n,r;return t=e,(n=[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}])&&E(t.prototype,n),r&&E(t,r),e}();function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=new S,this.workingSpace=0,this.sharedSize=null}var t,n,r;return t=e,(n=[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof S}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}])&&R(t.prototype,n),r&&R(t,r),e}();function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootNode=t,this.nodesPool=n,this.sizeSet=new T,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}var t,n,r;return t=e,(n=[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,t=this.sizeSet,n=0;if(this.isSharedViewSet())for(var r=e.firstElementChild;r;){if(r.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(1))break;r=r.nextElementSibling}else n=e.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,t=this.sizeSet,n=this.isSharedViewSet(),r=t.getViewSize().nextSize,o=this.getRenderedChildCount();o<r;){var i=this.nodesPool();!n||n&&t.isPlaceOn(2)?e.appendChild(i):e.insertBefore(i,e.firstChild),o+=1}for(var a=n&&t.isPlaceOn(1);o>r;)e.removeChild(a?e.firstChild:e.lastChild),o-=1}},{key:"render",value:function(){var e=this.rootNode,t=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(n+=t.sharedSize.nextSize);var r=e.childNodes[n];if(r.tagName!==this.childNodeType){var o=this.nodesPool();e.replaceChild(o,r),r=o}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}])&&k(t.prototype,n),r&&k(t,r),e}();function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=x(e);if(t){var o=x(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return I(this,n)}}function I(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(i,e);var t,n,r,o=H(i);function i(){return A(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"prependView",value:function(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}])&&N(t.prototype,n),r&&N(t,r),i}(j);function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var D=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodeType=t.toUpperCase()}var t,n,r;return t=e,(n=[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}])&&P(t.prototype,n),r&&P(t,r),e}();function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var F=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodesPool="string"==typeof t?new D(t):null,this.nodeType=t,this.rootNode=n,this.table=null,this.renderedNodes=0}var t,n,r;return t=e,(n=[{key:"setTable",value:function(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}])&&B(t.prototype,n),r&&B(t,r),e}();function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=X(e);if(t){var o=X(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return G(this,n)}}function G(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var K=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(i,e);var t,n,r,o=z(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"TH")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return t=i,(n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new L(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.rowHeaderFunctions,r=e.rowHeadersCount,o=e.rows,i=e.cells,a=0;a<t;a++){var l=this.table.renderedRowToSource(a),s=o.getRenderedNode(a);this.sourceRowIndex=l;var c=this.obtainOrderView(s),u=i.obtainOrderView(s);c.appendView(u).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var f=0;f<r;f++){c.render();var h=c.getCurrentNode();h.className="",h.removeAttribute("style"),n[f](l,h,f)}c.end()}}}])&&W(t.prototype,n),r&&W(t,r),i}(F);function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J(e);if(t){var o=J(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Z(this,n)}}function Z(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(i,e);var t,n,r,o=Q(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,null,e)}return t=i,(n=[{key:"adjust",value:function(){var e=this.table,t=e.columnHeadersCount,n=e.rowHeadersCount,r=this.rootNode.firstChild,o=this.table.columnsToRender;if(t||o){for(var i=o+n,a=0,l=t;a<l;a++){for((r=this.rootNode.childNodes[a])||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<i;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)r.removeChild(r.lastChild),this.renderedNodes-=1}var s=this.rootNode.childNodes.length;if(s>t)for(var c=t;c<s;c++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Object(O.empty)(r)}},{key:"render",value:function(){for(var e=this.table.columnHeadersCount,t=0;t<e;t+=1)for(var n=this.table,r=n.columnHeaderFunctions,o=n.columnsToRender,i=n.rowHeadersCount,a=this.rootNode.childNodes[t],l=-1*i;l<o;l+=1){var s=this.table.renderedColumnToSource(l),c=a.childNodes[l+i];c.className="",c.removeAttribute("style"),r[t](s,c,t),s<0&&Object(O.addClass)(c,"wtTableCornerCell")}}}])&&q(t.prototype,n),r&&q(t,r),i}(F),te=n(177);function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e,t){return(oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=le(e);if(t){var o=le(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ae(this,n)}}function ae(e,t){return!t||"object"!==ne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function le(e){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oe(e,t)}(i,e);var t,n,r,o=ie(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,null,e)}return t=i,(n=[{key:"adjust",value:function(){for(var e=this.table,t=e.columnsToRender+e.rowHeadersCount;this.renderedNodes<t;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>t;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,r=0;r<n;r++){var o=this.table.renderedColumnToSource(r),i=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width="".concat(i,"px")}for(var a=0;a<t;a++){var l=this.table.renderedColumnToSource(a),s=this.table.columnUtils.getStretchedColumnWidth(l);0===n&&0===a&&(s+=te.a),this.rootNode.childNodes[a+n].style.width="".concat(s,"px")}var c=this.rootNode.firstChild;c&&Object(O.addClass)(c,"rowHeader")}}])&&re(t.prototype,n),r&&re(t,r),i}(F),ce=n(182),ue=n(175);function fe(e){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number \n        of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number\\x20\n        of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']);return he=function(){return e},e}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ge(e);if(t){var o=ge(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ye(this,n)}}function ye(e,t){return!t||"object"!==fe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var me=!1,be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(i,e);var t,n,r,o=ve(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,"TR",e)).orderView=new j(e,(function(e){return t.nodesPool.obtain(e)}),t.nodeType),t}return t=i,(n=[{key:"getRenderedNode",value:function(e){return this.orderView.getNode(e)}},{key:"render",value:function(){var e=this.table.rowsToRender;!me&&e>1e3&&(me=!0,Object(ce.b)(Object(ue.a)(he()))),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(var t=0;t<e;t++)this.orderView.render();this.orderView.end()}}])&&de(t.prototype,n),r&&de(t,r),i}(F);function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Re(e);if(t){var o=Re(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Se(this,n)}}function Se(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oe(e,t)}(i,e);var t,n,r,o=Ee(i);function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,"TD")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return t=i,(n=[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new L(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.columnsToRender,r=e.rows,o=e.rowHeaders,i=0;i<t;i++){var a=this.table.renderedRowToSource(i),l=r.getRenderedNode(i);this.sourceRowIndex=a;var s=this.obtainOrderView(l),c=o.obtainOrderView(l);s.prependView(c).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var u=0;u<n;u++){s.render();var f=s.getCurrentNode(),h=this.table.renderedColumnToSource(u);Object(O.hasClass)(f,"hide")||(f.className=""),f.removeAttribute("style"),this.table.cellRenderer(a,h,f)}s.end()}}}])&&Ce(t.prototype,n),r&&Ce(t,r),i}(F);function ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Me=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.cellRenderer;ke(this,e),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=r}var t,n,r;return t=e,(n=[{key:"setAxisUtils",value:function(e,t){this.rowUtils=e,this.columnUtils=t}},{key:"setViewportSize",value:function(e,t){this.rowsToRender=e,this.columnsToRender=t}},{key:"setFilters",value:function(e,t){this.rowFilter=e,this.columnFilter=t}},{key:"setHeaderContentRenderers",value:function(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowHeaders,n=e.columnHeaders,r=e.colGroup,o=e.rows,i=e.cells;t.setTable(this),n.setTable(this),r.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=t,this.columnHeaders=n,this.colGroup=r,this.rows=o,this.cells=i}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();var e=this.rowsToRender,t=this.rows;0===this.columnHeadersCount?Object(O.addClass)(t.rootNode,"afterEmptyThead"):Object(O.removeClass)(t.rootNode,"afterEmptyThead");for(var n=0;n<e;n++){var r=t.getRenderedNode(n);if(r.firstChild){var o=this.renderedRowToSource(n),i=this.rowUtils.getHeight(o);r.firstChild.style.height=i?"".concat(i-1,"px"):""}}}}])&&je(t.prototype,n),r&&je(t,r),e}();function Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _e,He=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.TABLE,r=t.THEAD,o=t.COLGROUP,i=t.TBODY,a=t.rowUtils,l=t.columnUtils,s=t.cellRenderer;Ae(this,e),this.renderer=new Me(n,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new K,columnHeaders:new ee(r),colGroup:new se(o),rows:new be(i),cells:new Te}),this.renderer.setAxisUtils(a,l)}var t,n,r;return t=e,(n=[{key:"setFilters",value:function(e,t){return this.renderer.setFilters(e,t),this}},{key:"setViewportSize",value:function(e,t){return this.renderer.setViewportSize(e,t),this}},{key:"setHeaderContentRenderers",value:function(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}},{key:"render",value:function(){this.renderer.render()}}])&&Ne(t.prototype,n),r&&Ne(t,r),e}(),Ie=n(166),xe=n(172);function Le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var De=/[-]{0,1}[\d]*[.]{0,1}[\d]+/g;var Be=new Map;function Fe(e){var t=Be.get(e);if(void 0!==t)return t;var n=function(e){var t=Le(e,3),n=t[0],r=t[1],o=t[2];return.2126*n+.7152*r+.0722*o}(function(e){_e.ownerDocument.body.appendChild(_e),_e.style.color=e;var t=_e.ownerDocument.defaultView,n=Object(O.getComputedStyle)(_e,t).color.match(De);return _e.ownerDocument.body.removeChild(_e),null===n||n.length<2?[0,0,0,1]:[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10),n.length>3?parseFloat(n[3]):1]}(e));return Be.set(e,n),n}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var We=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.guid="wt_".concat(Object(xe.randomString)()),this.rootDocument=t.table.ownerDocument,this.rootWindow=this.rootDocument.defaultView,function(e){(_e=e.document.createElement("span")).style.display="none"}(this.rootWindow)}var t,n,r;return t=e,(n=[{key:"getSetting",value:function(e,t,n,r,o){return this.wtSettings.getSetting(e,t,n,r,o)}},{key:"hasSetting",value:function(e){return this.wtSettings.has(e)}}])&&Ve(t.prototype,n),r&&Ve(t,r),e}(),Ue=n(183),ze=n(176),Ge=n(169);function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ke=new WeakMap,Ye=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.eventManager=new Ie.a(t),Ke.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}var t,n,r;return t=e,(n=[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.instance.wtTable.holder,"contextmenu",(function(t){return e.onContextMenu(t)})),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(this.instance.wtTable.TABLE,"mouseout",(function(t){return e.onMouseOut(t)}));var t=function(){e.eventManager.addEventListener(e.instance.wtTable.holder,"touchstart",(function(t){return e.onTouchStart(t)})),e.eventManager.addEventListener(e.instance.wtTable.holder,"touchend",(function(t){return e.onTouchEnd(t)})),e.instance.momentumScrolling||(e.instance.momentumScrolling={}),e.eventManager.addEventListener(e.instance.wtTable.holder,"scroll",(function(){clearTimeout(e.instance.momentumScrolling._timeout),e.instance.momentumScrolling.ongoing||e.instance.getSetting("onBeforeTouchScroll"),e.instance.momentumScrolling.ongoing=!0,e.instance.momentumScrolling._timeout=setTimeout((function(){e.instance.touchApplied||(e.instance.momentumScrolling.ongoing=!1,e.instance.getSetting("onAfterMomentumScroll"))}),200)}))};Object(Ge.isMobileBrowser)()?t():(Object(ze.isTouchSupported)()&&t(),e.eventManager.addEventListener(e.instance.wtTable.holder,"mouseup",(function(t){return e.onMouseUp(t)})),e.eventManager.addEventListener(e.instance.wtTable.holder,"mousedown",(function(t){return e.onMouseDown(t)})))}},{key:"selectedCellWasTouched",value:function(e){var t=Ke.get(this),n=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&n){var r=[n.row,t.selectedCellBeforeTouchEnd.from.row],o=r[0],i=r[1],a=[n.col,t.selectedCellBeforeTouchEnd.from.col];return o===i&&a[0]===a[1]}return!1}},{key:"parentCell",value:function(e){var t={},n=this.instance.wtTable.TABLE,r=Object(O.closestDown)(e,["TD","TH"],n);return r?(t.coords=this.instance.wtTable.getCoords(r),t.TD=r):Object(O.hasClass)(e,"wtBorder")&&Object(O.hasClass)(e,"current")?(t.coords=this.instance.selections.getCell().cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):Object(O.hasClass)(e,"wtBorder")&&Object(O.hasClass)(e,"area")&&this.instance.selections.createOrGetArea().cellRange&&(t.coords=this.instance.selections.createOrGetArea().cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t}},{key:"onMouseDown",value:function(e){var t=Ke.get(this),n=this.instance.rootDocument.activeElement,r=Object(Ue.partial)(O.getParent,e.target),o=e.target;if(o!==n&&r(0)!==n&&r(1)!==n){var i=this.parentCell(o);Object(O.hasClass)(o,"corner")?this.instance.getSetting("onCellCornerMouseDown",e,o):i.TD&&this.instance.hasSetting("onCellMouseDown")&&this.instance.getSetting("onCellMouseDown",e,i.coords,i.TD,this.instance),(0===e.button||this.instance.touchApplied)&&i.TD&&(t.dblClickOrigin[0]=i.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout((function(){t.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(e){if(this.instance.hasSetting("onCellContextMenu")){var t=this.parentCell(e.target);t.TD&&this.instance.getSetting("onCellContextMenu",e,t.coords,t.TD,this.instance)}}},{key:"onMouseOver",value:function(e){if(this.instance.hasSetting("onCellMouseOver")){var t=this.instance.wtTable.TABLE,n=Object(O.closestDown)(e.target,["TD","TH"],t),r=this.instance.overlay?this.instance.overlay.master:this.instance;n&&n!==r.lastMouseOver&&Object(O.isChildOf)(n,t)&&(r.lastMouseOver=n,this.instance.getSetting("onCellMouseOver",e,this.instance.wtTable.getCoords(n),n,this.instance))}}},{key:"onMouseOut",value:function(e){if(this.instance.hasSetting("onCellMouseOut")){var t=this.instance.wtTable.TABLE,n=Object(O.closestDown)(e.target,["TD","TH"],t),r=Object(O.closestDown)(e.relatedTarget,["TD","TH"],t);n&&n!==r&&Object(O.isChildOf)(n,t)&&this.instance.getSetting("onCellMouseOut",e,this.instance.wtTable.getCoords(n),n,this.instance)}}},{key:"onMouseUp",value:function(e){var t=Ke.get(this),n=this.parentCell(e.target);n.TD&&this.instance.hasSetting("onCellMouseUp")&&this.instance.getSetting("onCellMouseUp",e,n.coords,n.TD,this.instance),(0===e.button||this.instance.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?(Object(O.hasClass)(e.target,"corner")?this.instance.getSetting("onCellCornerDblClick",e,n.coords,n.TD,this.instance):this.instance.getSetting("onCellDblClick",e,n.coords,n.TD,this.instance),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout((function(){t.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(e){Ke.get(this).selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange,this.instance.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var t=e.target;!1===this.selectedCellWasTouched(t)&&["A","BUTTON","INPUT"].includes(t.tagName)&&e.preventDefault(),this.onMouseUp(e),this.instance.touchApplied=!1}},{key:"destroy",value:function(){var e=Ke.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}])&&Xe(t.prototype,n),r&&Xe(t,r),e}();function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $e=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t}var t,n,r;return t=e,(n=[{key:"scrollViewport",value:function(e,t,n,r,o){if(e.col<0||e.row<0)return!1;var i=this.scrollViewportHorizontally(e.col,n,o),a=this.scrollViewportVertically(e.row,t,r);return i||a}},{key:"scrollViewportHorizontally",value:function(e,t,n){if(!this.wot.drawn)return!1;var r=this._getVariables(),o=r.fixedColumnsLeft,i=r.leftOverlay,a=r.totalColumns,l=!1;if(e>=0&&e<=Math.max(a-1,0)){var s=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();e>=o&&s>-1&&(e<s||n)?l=i.scrollTo(e):(-1===c||c>-1&&(e>c||t))&&(l=i.scrollTo(e,!0))}return l}},{key:"scrollViewportVertically",value:function(e,t,n){if(!this.wot.drawn)return!1;var r=this._getVariables(),o=r.fixedRowsBottom,i=r.fixedRowsTop,a=r.topOverlay,l=r.totalRows,s=!1;if(e>=0&&e<=Math.max(l-1,0)){var c=this.getFirstVisibleRow(),u=this.getLastVisibleRow();e>=i&&c>-1&&(e<c||t)?s=a.scrollTo(e):(-1===u||u>-1&&(e>u&&e<l-o||n))&&(s=a.scrollTo(e,!0))}return s}},{key:"getFirstVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,i=e.fixedRowsTop,a=this.wot.rootWindow,l=n.getFirstVisibleRow();if(t.mainTableScrollableElement===a){var s=Object(O.offset)(n.wtRootElement),c=Object(O.innerHeight)(n.hider),u=Object(O.innerHeight)(a),f=Object(O.getScrollTop)(a,a);if(s.top+c-u<=f){var h=r.getColumnHeaderHeight();h+=t.sumCellSizes(0,i);for(var d=o;d>0;d--)if(h+=t.sumCellSizes(d-1,d),s.top+c-h<=f){l=d;break}}}return l}},{key:"getLastVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,i=this.wot.rootWindow,a=n.getLastVisibleRow();if(t.mainTableScrollableElement===i){var l=Object(O.offset)(n.wtRootElement),s=Object(O.getScrollTop)(i,i);if(l.top>s)for(var c=Object(O.innerHeight)(i),u=r.getColumnHeaderHeight(),f=1;f<=o;f++)if(u+=t.sumCellSizes(f-1,f),l.top+u-s>=c){a=f-2;break}}return a}},{key:"getFirstVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,i=this.wot.rootWindow,a=n.getFirstVisibleColumn();if(t.mainTableScrollableElement===i){var l=Object(O.offset)(n.wtRootElement),s=Object(O.innerWidth)(n.hider),c=Object(O.innerWidth)(i),u=Object(O.getScrollLeft)(i,i);if(l.left+s-c<=u)for(var f=r.getRowHeaderWidth(),h=o;h>0;h--)if(f+=t.sumCellSizes(h-1,h),l.left+s-f<=u){a=h;break}}return a}},{key:"getLastVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,i=this.wot.rootWindow,a=n.getLastVisibleColumn();if(t.mainTableScrollableElement===i){var l=Object(O.offset)(n.wtRootElement),s=Object(O.getScrollLeft)(i,i);if(l.left>s)for(var c=Object(O.innerWidth)(i),u=r.getRowHeaderWidth(),f=1;f<=o;f++)if(u+=t.sumCellSizes(f-1,f),l.left+u-s>=c){a=f-2;break}}return a}},{key:"_getVariables",value:function(){var e=this.wot;return{topOverlay:e.wtOverlays.topOverlay,leftOverlay:e.wtOverlays.leftOverlay,wtTable:e.wtTable,wtViewport:e.wtViewport,totalRows:e.getSetting("totalRows"),totalColumns:e.getSetting("totalColumns"),fixedRowsTop:e.getSetting("fixedRowsTop"),fixedRowsBottom:e.getSetting("fixedRowsBottom"),fixedColumnsLeft:e.getSetting("fixedColumnsLeft")}}}])&&qe(t.prototype,n),r&&qe(t,r),e}();function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rt(e);if(t){var o=rt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tt(this,n)}}function tt(e,t){return!t||"object"!==Qe(t)&&"function"!=typeof t?nt(e):t}function nt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rt(e){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ot=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(i,e);var t,n,r,o=et(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).overlay=e.overlay,t.overlayName=e.overlay.type,t.wtSettings=t.overlay.master.wtSettings,t.wtTable=e.createTableFn(nt(t),e.table),t.wtScroll=new $e(nt(t)),t.wtViewport=t.overlay.master.wtViewport,t.wtEvent=new Ye(nt(t)),t.selections=t.overlay.master.selections,t}return t=i,(n=[{key:"drawClone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.wtTable.draw(e),this}},{key:"getOverlayName",value:function(){return this.overlayName}}])&&Ze(t.prototype,n),r&&Ze(t,r),i}(We);function it(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function at(e,t,n){return t&&it(e.prototype,t),n&&it(e,n),e}var lt,st={},ct=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.master=t,this.type="",this.mainTableScrollableElement=null,this.areElementSizesAdjusted=!1}return at(e,null,[{key:"registerOverlay",value:function(t,n){if(-1===e.CLONE_TYPES.indexOf(t))throw new Error("Unsupported overlay (".concat(t,")."));st[t]=n}},{key:"createOverlay",value:function(e,t){return new st[e](t)}},{key:"hasOverlay",value:function(e){return void 0!==st[e]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_TYPES",get:function(){return[e.CLONE_TOP,e.CLONE_BOTTOM,e.CLONE_LEFT,e.CLONE_TOP_LEFT_CORNER,e.CLONE_BOTTOM_LEFT_CORNER]}}]),at(e,[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered(),e&&!this.needFullRender&&this.resetElementsSize()}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateMainScrollableElement",value:function(){var e=this.master;"hidden"===Object(O.getComputedStyle)(e.wtTable.wtRootElement.parentNode,e.rootWindow).getPropertyValue("overflow")?this.mainTableScrollableElement=e.wtTable.holder:this.mainTableScrollableElement=Object(O.getScrollableElement)(e.wtTable.TABLE)}},{key:"getRelativeCellPosition",value:function(e,t,n){if(!1!==this.clone.wtTable.holder.contains(e)){var r=this.mainTableScrollableElement===this.master.rootWindow,o=n<this.master.getSetting("fixedColumnsLeft"),i=t<this.master.getSetting("fixedRowsTop"),a=t>=this.master.getSetting("totalRows")-this.master.getSetting("fixedRowsBottom"),l={left:this.clone.wtTable.spreader.offsetLeft,top:this.clone.wtTable.spreader.offsetTop},s={left:e.offsetLeft,top:e.offsetTop};return r?this.getRelativeCellPositionWithinWindow(i,o,s,l):this.getRelativeCellPositionWithinHolder(i,a,o,s,l)}Object(ce.b)("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeCellPositionWithinWindow",value:function(e,t,n,r){var o=Object(O.getBoundingClientRect)(this.master.wtTable.wtRootElement),i=0,a=0;(i=t?o.left<=0?-1*o.left:0:r.left,e)?a=Object(O.getBoundingClientRect)(this.clone.wtTable.TABLE).top-o.top:a=r.top;return{left:n.left+i,top:n.top+a}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,t,n,r,o){var i=this.clone.overlay.master.wtOverlays.leftOverlay.getScrollPosition(),a=this.clone.overlay.master.wtOverlays.topOverlay.getScrollPosition(),l=0,s=0;if(n||(l=i-o.left),t){var c=Object(O.getBoundingClientRect)(this.master.wtTable.wtRootElement);s=-1*Object(O.getBoundingClientRect)(this.clone.wtTable.TABLE).top+c.top}else e||(s=a-o.top);return{left:r.left-l,top:r.top-s}}},{key:"makeClone",value:function(t){if(-1===e.CLONE_TYPES.indexOf(t))throw new Error('Clone type "'.concat(t,'" is not supported.'));var n=this.master,r=n.rootDocument.createElement("DIV"),o=n.rootDocument.createElement("TABLE");r.className="ht_clone_".concat(t," handsontable"),r.style.position="absolute",r.style.top=0,r.style.left=0,r.style.overflow="visible",o.className=n.wtTable.TABLE.className,r.appendChild(o),this.type=t,n.wtTable.wtRootElement.parentNode.appendChild(r);var i=n.getSetting("preventOverflow");return!0===i||"horizontal"===i&&this.type===e.CLONE_TOP||"vertical"===i&&this.type===e.CLONE_LEFT?this.mainTableScrollableElement=n.rootWindow:"hidden"===Object(O.getComputedStyle)(n.wtTable.wtRootElement.parentNode,n.rootWindow).getPropertyValue("overflow")?this.mainTableScrollableElement=n.wtTable.holder:this.mainTableScrollableElement=Object(O.getScrollableElement)(n.wtTable.TABLE),new ot({overlay:this,createTableFn:this.createTable,table:o})}},{key:"redrawClone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.adjustElementsPosition(),this.needFullRender&&this.clone.drawClone(e)}},{key:"resetElementsSize",value:function(){var e=this.clone;e.wtTable.holder.style.width="",e.wtTable.holder.style.height="",e.wtTable.hider.style.width="",e.wtTable.hider.style.height="",e.wtTable.wtRootElement.style.width="",e.wtTable.wtRootElement.style.height=""}},{key:"destroy",value:function(){new Ie.a(this.clone).destroy()}}]),e}();function ut(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ft(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ft(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ht(e){e.command=""}function dt(e){e.renderedCommand!==e.command&&(e.elem.setAttribute("d",e.command),e.renderedCommand=e.command)}function pt(e,t){var n=e.split(" "),r=t.split(" "),o=parseInt(n[0],10),i=parseInt(r[0],10);n.shift(),n.shift(),r.shift(),r.shift();var a,l,s=n.join(" "),c=r.join(" ");return o>i?1:o<i?-1:(a=Fe(c),l=Fe(s),a>l?1:a<l?-1:0)}function vt(e,t,n){var r=e.get(t);if(!r){var o=n.ownerDocument.createElementNS("http://www.w3.org/2000/svg","path"),i=t.split(" "),a=parseInt(i[0],10);i.shift(),i.shift();var l=i.join(" ");o.setAttribute("stroke",l),o.setAttribute("stroke-width",a),o.setAttribute("shape-rendering","geometricPrecision"),o.setAttribute("data-stroke-style",t),ht(r={elem:o,command:"",renderedCommand:""});for(var s=null,c=n.firstElementChild;c;){if(-1===pt(t,c.getAttribute("data-stroke-style"))){s=c;break}c=c.nextSibling}s?n.insertBefore(o,s):n.appendChild(o),e.set(t,r)}return r}function yt(e){for(var t="M ",n=0;n<e.length;n++)t+=n>1&&n%2==0?" L ".concat(e[n]):" ".concat(e[n]);return t}function gt(e){return"M ".concat(e.join(" "))}function mt(e){return function(e){if(Array.isArray(e))return bt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return bt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wt(e){for(var t=[],n=new Map,r=0;r<e.length;r++){var o=e[r],i=o[1]===o[3]?"h-".concat(o[1]):"v-".concat(o[0]),a=n.get(i);a?a.push(o):n.set(i,[o])}return n.forEach((function(e){e.length>1?t.push.apply(t,mt(function(e){var t=0;do{var n=e[t],r=n[1]===n[3],o=void 0;do{o=!1;for(var i=t+1;i<e.length;i++){var a=e[i];if(!a.deleted&&(s=n,o=Ct((c=a)[0],c[1],s)||Ct(c[2],c[3],s))){var l=Et(n,a);r?(n[0]=l.low[0],n[2]=l.high[0]):(n[1]=l.low[1],n[3]=l.high[1]),a.deleted=!0;break}}}while(o);t+=1}while(t<e.length);var s,c;return e.filter((function(e){return!e.deleted}))}(e))):t.push(e[0])})),t}function Ct(e,t,n){return!!Ot(e,n[0],n[2])&&Ot(t,n[1],n[3])}function Ot(e,t,n){return n>t?e>=t&&e<=n:e>=n&&e<=t}function Et(e,t){var n,r,o=St(e),i=St(t);return r=i,Tt((n=o).low,r.low,Math.min),Tt(n.high,r.high,Math.max),n}function St(e){return{low:Rt(e,Math.min),high:Rt(e,Math.max)}}function Rt(e,t){return[t(e[0],e[2]),t(e[1],e[3])]}function Tt(e,t,n){e[0]=n(e[0],t[0]),e[1]=n(e[1],t[1])}function kt(e){return function(e){if(Array.isArray(e))return jt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return jt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mt(e){for(var t=new At,n=[],r=0;r<e.length;r++){var o=e[r],i=t.insertValue({pathContext:o,reversed:!1});t.insertValueIdAtPoint(i,Nt(o));var a=t.insertValue({pathContext:o,reversed:!0});t.insertValueIdAtPoint(a,_t(o))}var l=[];t.forEachPoint((function(e,r){if(r.length>0){var o=[];if(Ht(t,e[0],o,e[0]),o.endless)n.push(o);else{o.reverse();var i=o[0];o.forEach((function(e){e.reversed=!e.reversed}));var a=o.pop();Ht(t,a,o,i),o.length>1?(o.endless=(s=Lt(o[0],!0),c=Lt(o[o.length-1]),s[0]===c[0]&&s[1]===c[1]),n.push(o)):l.push(o[0].pathContext)}}var s,c}));var s=[];return n.forEach((function(e){s.push(function(e){var t=[];t.push.apply(t,kt(It(e[0].pathContext,!e[0].reversed)));for(var n=0;n<e.length;n++)t.push.apply(t,kt(It(e[n].pathContext,e[n].reversed)));return t}(e))})),l.forEach((function(e){s.push(e)})),s}function At(){this.reset()}function Nt(e){return e.slice(0,2)}function _t(e){return e.slice(2,4)}function Ht(e,t,n,r){for(;t;){n.push(t);var o=It(t.pathContext,t.reversed),i=e.getElementAtPoint(o);if(!i||0===i.length)break;var a=xt(i.map((function(t){return e.values[t]})),t.pathContext);if(i.splice(0,2),!a)break;if(a.pathContext===r.pathContext){n.length>1&&(n.endless=!0);break}t=a}}function It(e,t){return t?Nt(e):_t(e)}function xt(e,t){return e[0].pathContext===t?e[1]:e[0]}function Lt(e,t){return t===e.reversed?_t(e.pathContext):Nt(e.pathContext)}function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}At.prototype.reset=function(){this.insertedCount=0,this.graph={},this.index={},this.values=[]},At.prototype.insertValue=function(e){return this.values.push(e),this.values.length-1},At.prototype.insertValueIdAtPoint=function(e,t){var n=t[0],r=t[1];this.graph[n]||(this.graph[n]={});var o,i,a=this.graph[n];r in a?(i=a[r],(o=this.index[i]).push(e)):(i=this.insertedCount,a[r]=i,this.insertedCount+=1,o=[e],this.index[i]=o)},At.prototype.forEachPoint=function(e){for(var t=this,n=0;n<this.insertedCount;n++){var r=this.index[n];r&&r.length>0&&e(r.map((function(e){return t.values[e]})),r)}},At.prototype.getIdOfPoint=function(e){var t=this.graph[e[0]];if(t){var n=t[e[1]];if(n>=0)return n}},At.prototype.getElementAtPoint=function(e){var t=this.getIdOfPoint(e);if(t>=0)return this.index[t]};var Bt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Dt(this,"rootDocument",void 0),Dt(this,"uniqueDomInnerClipId",void 0),Dt(this,"svg",void 0),Dt(this,"rect",void 0),this.rootDocument=t,this.uniqueDomInnerClipId="".concat(Object(xe.randomString)(),"-inner-clip"),this.createElement()}var t,n,r;return t=e,(n=[{key:"createSvgGroup",value:function(e){var t=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","g");return e&&t.setAttribute("clip-path","url(#".concat(this.uniqueDomInnerClipId)),this.svg.appendChild(t),t}},{key:"setClipAttributes",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.rect.setAttribute(n,e[n])}))}},{key:"createElement",value:function(){if(void 0===this.svg){var e=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","svg");e.style.top="0",e.style.left="0",e.style.width="0",e.style.height="0",e.style.position="absolute",e.style.zIndex="5",e.setAttribute("pointer-events","none"),e.setAttribute("class","wtBorders");var t=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","defs"),n=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","clipPath"),r=this.rootDocument.createElementNS("http://www.w3.org/2000/svg","rect");n.setAttribute("id",this.uniqueDomInnerClipId),n.appendChild(r),t.appendChild(n),e.appendChild(t),this.rect=r,this.svg=e}}}])&&Pt(t.prototype,n),r&&Pt(t,r),e}();function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vt(e){return function(e){if(Array.isArray(e))return Wt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var zt=-te.a,Gt=function(){function e(t,n,r){var o,i,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.overlayName=n,this.getCellFn=r,this.svgElement=new Bt(t.ownerDocument),this.svgResizer=(o=this.svgElement.svg,function(e,t){e=Math.max(e,0),t=Math.max(t,0),e===i&&t===a||(o.setAttribute("viewBox","0 0 ".concat(e," ").concat(t)),e!==i&&(o.style.width="".concat(e,"px"),o.setAttribute("width",e),i=e),t!==a&&(o.style.height="".concat(t,"px"),o.setAttribute("height",t),a=t))}),this.pathGroups=[],this.containerBoundingRect=null,this.maxSvgWidth=0,this.maxSvgHeight=0,this.rootWindow=t.ownerDocument.defaultView,t.appendChild(this.svgElement.svg)}var t,n,r;return t=e,(n=[{key:"ensurePathGroup",value:function(e){var t=this.pathGroups[e];if(!t){this.pathGroups.length<e&&this.ensurePathGroup(e-1);var n=0===e,r={svgPathsRenderer:this.getSvgPathsRendererForGroup(n),stylesAndLines:new Map,styles:[],commands:[]};return this.pathGroups[e]=r,r}return t}},{key:"render",value:function(e,t,n){var r=this;this.containerBoundingRect=Object(O.getBoundingClientRect)(e),this.pathGroups.forEach((function(e){return e.stylesAndLines.clear()}));for(var o=e.querySelector("tbody td"),i=o?Object(O.getBoundingClientRect)(o):null,a=0;a<n.length;a++)this.convertBorderEdgesDescriptorToLines(n[a]);this.pathGroups.forEach((function(e){return r.convertLinesToCommands(e)}));var l=Math.min(this.maxSvgWidth,this.containerBoundingRect.width),s=Math.min(this.maxSvgHeight,this.containerBoundingRect.height);if(this.svgResizer(l,s),i){var c=t.left+i.left-this.containerBoundingRect.left+zt,u=t.top+i.top-this.containerBoundingRect.top+zt;this.svgElement.setClipAttributes({width:Math.max(l-c-t.right,0),height:Math.max(s-u-t.bottom,0),x:c,y:u})}this.pathGroups.forEach((function(e){return e.svgPathsRenderer(e.styles,e.commands)}))}},{key:"sumArrayElementAtIndex",value:function(e,t){return e.reduce((function(e,n){return Math.max(e,n[t])}),0)}},{key:"setIn2dMap",value:function(e,t,n,r){var o=e.get(t);o?o.set(n,r):e.set(t,new Map([[n,r]]))}},{key:"adjustTipsOfLines",value:function(e,t,n,r){if(0!==e.length)for(var o=0;o<e.length;o++){var i,a,l=e[o],s=l[0]===l[2],c=s?n:r,u=s?r:n,f=s?1:0,h=l.length,d=h-2,p=h-1,v=s?p:d,y=null===(i=c.get(l[0]))||void 0===i?void 0:i.get(l[1]),g=null===(a=c.get(l[d]))||void 0===a?void 0:a.get(l[p]);if(t>1)for(var m=0;m<h;m+=2)this.setIn2dMap(u,l[m],l[m+1],t);if(y&&(l[f]-=Math.floor(y/2)),l[v]+=te.a,g){var b=g%2==0?-1:0;l[v]+=Math.floor(g/2)+b}}}},{key:"convertLinesToCommands",value:function(e){var t=this,n=e.stylesAndLines,r=e.commands,o=Vt(n.keys()),i=new Map,a=new Map;r.length=0,e.styles=o.sort(pt),e.styles.forEach((function(e){var o=n.get(e),l=parseInt(e,10);t.adjustTipsOfLines(o,l,i,a);var s=function(e,t){for(var n="",r=-1,o=-1,i=-1,a=-1,l=0;l<e.length;l++){var s=e[l];0===l&&(r=s[0],o=s[1]);var c=s.length;i=s[c-2],a=s[c-1],l>0&&(n+=" "),n+=lt(s)}var u=e[0],f=e[e.length-1];if(r!==i||o!==a){if(1===t){var h=f.length;n="M ".concat(u[2]," ").concat(u[3]," ").concat(n.substring(2)," ").concat(f[h-4]," ").concat(f[h-3])}}else n+=" Z";return n}(function(e){return Mt(wt(e))}(function(e,t){for(var n=new Array(t.length),r=e%2!=0,o=0;o<t.length;o++){var i=ut(t[o],4),a=i[0],l=i[1],s=i[2],c=i[3];r&&(l===c?(l+=.5,c+=.5):(a+=.5,s+=.5)),n[o]=[a,l,s,c]}return n}(l,o))),c=Math.ceil(l/2),u=t.sumArrayElementAtIndex(o,2)+c,f=t.sumArrayElementAtIndex(o,3)+c;u>t.maxSvgWidth&&(t.maxSvgWidth=u),f>t.maxSvgHeight&&(t.maxSvgHeight=f),r.push(s)}))}},{key:"getSvgPathsRendererForGroup",value:function(e){return function(e){lt||(lt=function(e){var t=e.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d","M 0 0 10 0"),"M 0 0 10 0"!==t.getAttribute("d")}(e.ownerDocument)?yt:gt),e.setAttribute("fill","none");var t=new Map;return function(n,r){t.forEach(ht);for(var o=0;o<n.length;o++)vt(t,n[o],e).command=r[o];t.forEach(dt)}}(this.svgElement.createSvgGroup(e))}},{key:"getLayerNumber",value:function(e){switch(e.className){case"current":return 3;case"area":return 2;case"fill":return 1;default:return 0}}},{key:"convertBorderEdgesDescriptorToLines",value:function(e){var t=e.settings,n=e.selectionStart,r=e.selectionEnd,o=e.hasTopEdge,i=e.hasRightEdge,a=e.hasBottomEdge,l=e.hasLeftEdge,s=this.getLayerNumber(t),c=this.ensurePathGroup(s).stylesAndLines,u=n.row===r.row&&n.col===r.col,f=0,h=0,d=this.getCellFn(n);if(-1===d&&(n.row+=1,d=this.getCellFn(n),h=-1),-2===d&&(n.row-=1,d=this.getCellFn(n),h=1),-4===d&&(n.col-=1,d=this.getCellFn(n),f=1),"object"===Ft(d)){var p,v=0,y=0;if(u?(p=d,v=f,y=h):(-1===(p=this.getCellFn(r))&&(r.row+=1,p=this.getCellFn(r),y=-1),-2===p&&(r.row-=1,p=this.getCellFn(r),y=1),-4===p&&(r.col-=1,p=this.getCellFn(r),v=1)),"object"===Ft(p)){var g=Object(O.getBoundingClientRect)(d),m=d===p?g:Object(O.getBoundingClientRect)(p),b=g.left,w=g.top,C=m.left+m.width,E=m.top+m.height;b+=f*g.width,w+=h*g.height,C+=v*m.width,E+=y*m.height;var S=!("TH"===d.nodeName||d.previousElementSibling),R=!d.parentNode.previousElementSibling&&!d.parentNode.parentNode.previousElementSibling.firstElementChild;if(S||(b+=zt),R||(w+=zt),b+=-this.containerBoundingRect.left,w+=-this.containerBoundingRect.top,C+=zt-this.containerBoundingRect.left,E+=zt-this.containerBoundingRect.top,t.border&&t.border.width&&"inside"===t.border.strokeAlignment){var T=Math.floor(t.border.width/2),k=Math.ceil(t.border.width/2)-1;b+=T,w+=T,C-=k,E-=k}"bottom"!==this.overlayName&&"bottom_left_corner"!==this.overlayName||-1===E&&(E=0),o&&this.hasLineAtEdge(t,"top")&&this.getLines(c,t,"top").push([b,w,C,w]),i&&this.hasLineAtEdge(t,"right")&&this.getLines(c,t,"right").push([C,w,C,E]),a&&this.hasLineAtEdge(t,"bottom")&&this.getLines(c,t,"bottom").push([b,E,C,E]),l&&this.hasLineAtEdge(t,"left")&&this.getLines(c,t,"left").push([b,w,b,E])}}}},{key:"hasLineAtEdge",value:function(e,t){return!(e[t]&&e[t].hide)}},{key:"getLines",value:function(e,t,n){var r=1;t[n]&&void 0!==t[n].width?r=t[n].width:t.border&&void 0!==t.border.width&&(r=t.border.width);var o=t[n]&&t[n].color||t.border&&t.border.color||"black",i="".concat(r,"px solid ").concat(o),a=e.get(i);if(a)return a;var l=[];return e.set(i,l),l}}])&&Ut(t.prototype,n),r&&Ut(t,r),e}(),Xt=n(155),Kt=n(156),Yt=n(197);function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $t=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t;var n=this.wot,r=n.rootDocument,o=n.rootWindow,i=n.wtTable,a=parseInt(Object(O.getComputedStyle)(r.body,o).lineHeight,10),l=1.2*parseInt(Object(O.getComputedStyle)(r.body,o).fontSize,10);this.eventManager=new Ie.a(this.wot),this.scrollbarSize=Object(O.getScrollbarWidth)(r),this.wot.update("scrollbarWidth",this.scrollbarSize),this.wot.update("scrollbarHeight",this.scrollbarSize);var s="hidden"===Object(O.getComputedStyle)(i.wtRootElement.parentNode,o).getPropertyValue("overflow");this.scrollableElement=s?i.holder:Object(O.getScrollableElement)(i.TABLE),this.topOverlay=void 0,this.bottomOverlay=void 0,this.leftOverlay=void 0,this.topLeftCornerOverlay=void 0,this.bottomLeftCornerOverlay=void 0,this.prepareOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.browserLineHeight=a||l,this.registerListeners(),this.lastScrollX=o.scrollX,this.lastScrollY=o.scrollY}var t,n,r;return t=e,(n=[{key:"prepareOverlays",value:function(){this.topOverlay?this.topOverlay.updateStateOfRendering():this.topOverlay=ct.createOverlay(ct.CLONE_TOP,this.wot),ct.hasOverlay(ct.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){}}),ct.hasOverlay(ct.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){}}),this.bottomOverlay?this.bottomOverlay.updateStateOfRendering():this.bottomOverlay=ct.createOverlay(ct.CLONE_BOTTOM,this.wot),this.leftOverlay?this.leftOverlay.updateStateOfRendering():this.leftOverlay=ct.createOverlay(ct.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?this.topLeftCornerOverlay.updateStateOfRendering():this.topLeftCornerOverlay=ct.createOverlay(ct.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?this.bottomLeftCornerOverlay.updateStateOfRendering():this.bottomLeftCornerOverlay=ct.createOverlay(ct.CLONE_BOTTOM_LEFT_CORNER,this.wot))}},{key:"refreshMasterAndClones",value:function(){this.wot.drawn&&(this.wot.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var e=this,t=this.wot,n=t.rootDocument,r=t.rootWindow,o=this.topOverlay.mainTableScrollableElement,i=this.leftOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(t){return e.onKeyDown(t)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(o,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0}),o!==i&&this.eventManager.addEventListener(i,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0});var a,l=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,c=this.wot.wtSettings.getSetting("preventWheel"),u={passive:s};(c||l||!Object(Ge.isChrome)())&&this.eventManager.addEventListener(this.wot.wtTable.wtRootElement,"wheel",(function(t){return e.onCloneWheel(t,c)}),u),[this.topOverlay,this.bottomOverlay,this.leftOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay].forEach((function(t){if(t&&t.needFullRender){var n=t.clone.wtTable.holder;e.eventManager.addEventListener(n,"wheel",(function(t){return e.onCloneWheel(t,c)}),u)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(a),a=setTimeout((function(){e.wot.getSetting("onWindowResize")}),200)}))}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var t=this.wot.rootWindow,n=this.leftOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==t&&o!==t&&!e.target.contains(r)||n!==t&&o!==t&&!e.target.contains(n))||(this.propagateMasterScrollPositionsToClones(),this.refreshMasterAndClones())}},{key:"onCloneWheel",value:function(e,t){var n=this.wot.rootWindow,r=this.leftOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target,a=o!==n&&i!==n&&!i.contains(o),l=r!==n&&i!==n&&!i.contains(r);if(!this.keyPressed||!a&&!l){var s=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&s)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=Object(Yt.isKey)(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=this.browserLineHeight,n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(r+=r*t,n+=n*t);var o=this.scrollVertically(n),i=this.scrollHorizontally(r);return o||i}},{key:"scrollVertically",value:function(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}},{key:"propagateMasterScrollPositionsToClones",value:function(){if(!this.destroyed){var e=this.wot.rootWindow,t=this.topOverlay.clone.wtTable.holder,n=this.leftOverlay.clone.wtTable.holder,r=this.bottomOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],i=o[0],a=o[1];this.horizontalScrolling=t.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==a||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling&&(this.topOverlay.needFullRender&&(t.scrollLeft=i),this.bottomOverlay.needFullRender&&(r.scrollLeft=i)),this.verticalScrolling&&this.leftOverlay.needFullRender&&(n.scrollTop=a)}}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wot,t=e.rootWindow,n=e.wtTable;"hidden"===Object(O.getComputedStyle)(n.wtRootElement.parentNode,t).getPropertyValue("overflow")?this.scrollableElement=n.holder:this.scrollableElement=Object(O.getScrollableElement)(n.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.destroyed=!0}},{key:"refreshClones",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||this.prepareOverlays(),this.bottomOverlay.clone&&this.bottomOverlay.redrawClone(e),this.leftOverlay.redrawClone(e),this.topOverlay.redrawClone(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.redrawClone(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.redrawClone(e),this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,n=Object(O.clientWidth)(t),r=Object(O.clientHeight)(t);n===this.spreaderLastSize.width&&r===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r,this.adjustElementsSizes())}else e||this.adjustElementsSizes()}},{key:"adjustElementsSizes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot,n=t.wtViewport,r=t.wtTable,o=this.wot.getSetting("totalColumns"),i=this.wot.getSetting("totalRows"),a=n.getRowHeaderWidth(),l=n.getColumnHeaderHeight(),s=r.hider.style,c=a||te.a,u=l||te.a;if(s.width="".concat(c+this.leftOverlay.sumCellSizes(0,o),"px"),s.height="".concat(u+this.topOverlay.sumCellSizes(0,i),"px"),this.scrollbarSize>0){var f=r.wtRootElement,h=f.scrollHeight,d=f.scrollWidth,p=r.holder,v=p.scrollHeight,y=p.scrollWidth;this.hasScrollbarRight=h<v,this.hasScrollbarBottom=d<y,this.hasScrollbarRight&&Object(O.scrollWidth)(r.hider)+this.scrollbarSize>d?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&Object(O.scrollHeight)(r.hider)+this.scrollbarSize>h&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.adjustElementsSize(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.adjustElementsSize(e)}},{key:"getParentOverlay",value:function(e){if(!e)return null;var t=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return Object(Kt.arrayEach)(t,(function(t){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)})),n}},{key:"syncOverlayTableClassNames",value:function(){var e=this.wot.wtTable.TABLE,t=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];Object(Kt.arrayEach)(t,(function(t){t&&(t.clone.wtTable.TABLE.className=e.className)}))}}])&&qt(t.prototype,n),r&&qt(t,r),e}();function Qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zt=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t,this.defaults={table:void 0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,t,n){var o=r.getSetting("data",e,t);Object(O.fastInnerText)(n,null==o?"":o)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onWindowResize:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={},Object(Xt.objectEach)(this.defaults,(function(e,t){if(void 0!==n[t])r.settings[t]=n[t];else{if(void 0===e)throw new Error('A required setting "'.concat(t,'" was not provided'));r.settings[t]=e}}))}var t,n,r;return t=e,(n=[{key:"update",value:function(e,t){var n=this;return void 0===t?Object(Xt.objectEach)(e,(function(e,t){n.settings[t]=e})):this.settings[e]=t,this.wot}},{key:"getSetting",value:function(e,t,n,r,o){return"function"==typeof this.settings[e]?this.settings[e](t,n,r,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}])&&Qt(t.prototype,n),r&&Qt(t,r),e}();function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var en=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked=!1,this.clientHeight=this._getWorkspaceHeight(),this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new Ie.a(this.wot),this.eventManager.addEventListener(this.wot.rootWindow,"resize",(function(){n.clientHeight=n._getWorkspaceHeight()}))}var t,n,r;return t=e,(n=[{key:"getWorkspaceHeight",value:function(){return this.clientHeight}},{key:"_getWorkspaceHeight",value:function(){var e=this.wot.rootDocument,t=this.wot.wtTable.trimmingContainer;return t===this.wot.rootWindow?Object(O.clientHeight)(e.documentElement):Object(O.outerHeight)(t)>0&&Object(O.clientHeight)(t)>0?Object(O.clientHeight)(t):1/0}},{key:"getWorkspaceWidth",value:function(){return window.innerWidth}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){for(var n=0,r=e;r<t;)n+=this.wot.columnUtils.getWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.wot.wtTable.holder,t=this.wot.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);var n=Object(O.offsetWidth)(t);return this.containerWidth=n,e.removeChild(t),n}},{key:"getWorkspaceOffset",value:function(){return Object(O.offset)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return Object(O.outerHeight)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){var e=this.wot.wtTable;return Object(O.outerWidth)(e.TABLE)||Object(O.outerWidth)(e.TBODY)||Object(O.outerWidth)(e.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return this.columnHeaderHeight||(this.wot.getSetting("columnHeaders").length?this.columnHeaderHeight||(this.columnHeaderHeight=Object(O.outerHeight)(this.wot.wtTable.THEAD)):this.columnHeaderHeight=0),this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}},{key:"getRowHeaderWidth",value:function(){return this.rowHeaderWidth=50,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e-te.a}},{key:"createRowsCalculator",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=this.wot,i=o.wtSettings,a=o.wtOverlays;o.wtTable,o.rootDocument,this.rowHeaderWidth=NaN,e=i.settings.renderAllRows&&1===r?1/0:this.getViewportHeight();var l=a.topOverlay.getScrollPosition()-a.topOverlay.getTableParentOffset();l<0&&(l=0);var s=o.getSetting("fixedRowsTop"),c=o.getSetting("fixedRowsBottom"),u=o.getSetting("totalRows");return s&&(l+=n=a.topOverlay.sumCellSizes(0,s),e-=n),c&&a.bottomOverlay.clone&&(e-=n=a.bottomOverlay.sumCellSizes(u-c,u)),t=0,new h({viewportSize:e,scrollOffset:l,totalItems:o.getSetting("totalRows"),itemSizeFn:function(e){return o.rowUtils.getHeight(e)},overrideFn:i.settings.viewportRowCalculatorOverride,calculationType:r,scrollbarHeight:t})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.wot,n=t.wtSettings,r=t.wtOverlays,o=(t.wtTable,t.rootDocument,this.getViewportWidth()),i=r.leftOverlay.getScrollPosition()-r.leftOverlay.getTableParentOffset();i<0&&(i=0);var a=t.getSetting("fixedColumnsLeft");if(a){var s=r.leftOverlay.sumCellSizes(0,a);i+=s,o-=s}return new l({viewportSize:o,scrollOffset:i,totalItems:t.getSetting("totalColumns"),itemSizeFn:function(e){return t.columnUtils.getWidth(e)},overrideFn:n.settings.viewportColumnCalculatorOverride,calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:function(e,n){return t.getSetting("onBeforeStretchingColumnWidth",e,n)}})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e;if(t){var n=this.createRowsCalculator(2),r=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var t=e.startRow,n=e.endRow,r=this.rowsRenderCalculator,o=r.startRow,i=r.endRow;return!(t<o||t===o&&t>0||n>i||n===i&&n<this.wot.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var t=e.startColumn,n=e.endColumn,r=this.columnsRenderCalculator,o=r.startColumn,i=r.endColumn;return!(t<o||t===o&&t>0||n>i||n===i&&n<this.wot.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){this.hasOversizedColumnHeadersMarked=!1}}])&&Jt(t.prototype,n),r&&Jt(t,r),e}();function tn(e){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t,this.headerWidths=new Map}var t,n,r;return t=e,(n=[{key:"getWidth",value:function(e){var t=this.wot.wtSettings.settings.columnWidth;return"function"==typeof t?t=t(e):"object"===tn(t)&&(t=t[e]),t||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(e){var t=this.getWidth(e),n=this.wot.wtViewport.columnsRenderCalculator,r=null==t?this.wot.wtSettings.settings.defaultColumnWidth:t;if(n){var o=n.getStretchedColumnWidth(e,r);o&&(r=o)}return r}},{key:"getHeaderHeight",value:function(e){var t=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.wot.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wot,t=e.getSetting("rowHeaderWidth");null==(t=e.getSetting("onModifyRowHeaderWidth",t))&&(t=50);for(var n=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth"),o=0;o<n;o++){var i=Array.isArray(t)?t[o]:t;i=null==i?r:i,this.headerWidths.set(o,i)}}}])&&nn(t.prototype,n),r&&nn(t,r),e}();function on(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var an=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wot=t}var t,n,r;return t=e,(n=[{key:"getHeight",value:function(e){var t=this.wot.wtSettings.settings.rowHeight(e),n=this.wot.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}}])&&on(t.prototype,n),r&&on(t,r),e}();function ln(e){return(ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cn(e,t){return(cn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function un(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=dn(e);if(t){var o=dn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fn(this,n)}}function fn(e,t){return!t||"object"!==ln(t)&&"function"!=typeof t?hn(e):t}function hn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dn(e){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cn(e,t)}(i,e);var t,n,r,o=un(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).wtSettings=new Zt(hn(t),e),t.rowUtils=new an(hn(t)),t.columnUtils=new rn(hn(t)),t.wtTable=new An(hn(t),e.table),t.wtScroll=new $e(hn(t)),t.wtViewport=new en(hn(t)),t.wtEvent=new Ye(hn(t)),t.selections=t.getSetting("selections"),t.wtOverlays=new $t(hn(t)),t.exportSettingsAsClassNames();var n=[];if(t.wtTable.THEAD.childNodes.length&&t.wtTable.THEAD.childNodes[0].childNodes.length){for(var r=0,a=t.wtTable.THEAD.childNodes[0].childNodes.length;r<a;r++)n.push(t.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);t.getSetting("columnHeaders").length||t.update("columnHeaders",[function(e,t){Object(O.fastInnerText)(t,n[e])}])}return t.drawn=!1,t.drawInterrupted=!1,t}return t=i,(n=[{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(O.clearMemoizedFunctionsBeforeRender)(),this.drawInterrupted=!1,e||this.wtTable.isVisible()?(this.wtTable.draw(e),this.drawn=!0):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsLeft");if(e.row<r&&e.col<i)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=n-o){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"update",value:function(e,t){return this.wtSettings.update(e,t)}},{key:"scrollViewport",value:function(e,t,n,r,o){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"exportSettingsAsClassNames",value:function(){var e=this,t=[],n=[];Object(Xt.objectEach)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(function(r,o){e.getSetting(o).length&&n.push(r),t.push(r)})),Object(O.removeClass)(this.wtTable.wtRootElement.parentNode,t),Object(O.addClass)(this.wtTable.wtRootElement.parentNode,n)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}])&&sn(t.prototype,n),r&&sn(t,r),i}(We);function vn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var mn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isMaster=t instanceof pn,this.wot=t,this.TABLE=n,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.hasTableHeight=!0,this.hasTableWidth=!0,Object(O.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1,this.tableRenderer=new He({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.isMaster?this.wot.rowUtils:this.wot.overlay.master.rowUtils,columnUtils:this.isMaster?this.wot.columnUtils:this.wot.overlay.master.columnUtils,cellRenderer:this.wot.wtSettings.settings.cellRenderer}),this.borderRenderer=new Gt(this.spreader,this.isMaster?"master":this.wot.getOverlayName(),this.getCell.bind(this))}var t,n,r;return t=e,(n=[{key:"is",value:function(e){return!this.isMaster&&this.wot.getOverlayName()===e}},{key:"createBorderPaddingObject",value:function(){var e=0,t=0,n=0,r=0;return(this.is(ct.CLONE_LEFT)||this.is(ct.CLONE_TOP_LEFT_CORNER)||this.is(ct.CLONE_BOTTOM_LEFT_CORNER))&&(r=1,this.wot.getSetting("rowHeaders").length>0&&(t=1)),(this.is(ct.CLONE_TOP)||this.is(ct.CLONE_TOP_LEFT_CORNER))&&(n=1,this.wot.getSetting("columnHeaders").length>0&&(e=1)),(this.is(ct.CLONE_BOTTOM)||this.is(ct.CLONE_BOTTOM_LEFT_CORNER))&&(e=1),{top:e,left:t,bottom:n,right:r}}},{key:"fixTableDomTree",value:function(){var e=this.wot.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(O.hasClass)(n,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).className="wtSpreader",n&&n.insertBefore(t,e),t.appendChild(e)),t.style.position="relative",t}},{key:"createHider",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(O.hasClass)(n,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(t,e),t.appendChild(e)),t}},{key:"createHolder",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&Object(O.hasClass)(n,"wtHolder")||((t=this.wot.rootDocument.createElement("div")).style.position="relative",t.className="wtHolder",n&&n.insertBefore(t,e),t.appendChild(e)),t}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot,n=t.getSetting("totalRows"),r=t.getSetting("totalColumns"),o=t.getSetting("rowHeaders"),i=o.length,a=t.getSetting("columnHeaders"),l=a.length;if(!e){var s=n>0?this.getFirstRenderedRow():0,c=r>0?this.getFirstRenderedColumn():0;this.rowFilter=new C(s,n,l),this.columnFilter=new b(c,r,i),this.is(ct.CLONE_BOTTOM)||this.is(ct.CLONE_BOTTOM_LEFT_CORNER)?this.tableRenderer.setHeaderContentRenderers(o,[]):this.tableRenderer.setHeaderContentRenderers(o,a),this.is(ct.CLONE_BOTTOM)&&this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.adjustColumnHeaderHeights(),this.is(ct.CLONE_BOTTOM)&&this.markOversizedRows()}this.refreshSelections(e)}},{key:"markIfOversizedColumnHeader",value:function(e){for(var t,n,r,o=this.columnFilter.renderedToSource(e),i=this.wot.getSetting("columnHeaders").length,a=this.wot.wtSettings.settings.defaultRowHeight,l=this.wot.getSetting("columnHeaderHeight")||[];i;)i-=1,t=this.wot.columnUtils.getHeaderHeight(i),(n=this.getColumnHeader(o,i))&&(r=Object(O.innerHeight)(n),(!t&&a<r||t<r)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=r),Array.isArray(l)?null!==l[i]&&void 0!==l[i]&&(this.wot.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.wot.wtViewport.oversizedColumnHeaders[i]=l),this.wot.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wot,t=this.THEAD.childNodes,n=e.wtViewport.oversizedColumnHeaders,r=0,o=e.getSetting("columnHeaders").length;r<o;r++)if(n[r]){if(!t[r]||0===t[r].childNodes.length)return;t[r].childNodes[0].style.height="".concat(n[r],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wot;if(!e.getSetting("externalRowCalculator"))for(var t=this.getRenderedRowsCount(),n=0;n<t;n++){var r=this.rowFilter.renderedToSource(n);e.wtViewport.oversizedRows&&e.wtViewport.oversizedRows[r]&&(e.wtViewport.oversizedRows[r]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll(".".concat(e)),n=0,r=t.length;n<r;n++)Object(O.removeClass)(t[n],e)}},{key:"refreshSelections",value:function(e){var t=this.wot;if(t.selections){var n=Array.isArray(t.selections)?t.selections:t.selections.getAll(),r=n.length;if(e){for(var o=new Set,i=t.getSetting("onBeforeRemoveCellClassNames"),a=0;a<r;a++){var l=n[a].settings,s=l.highlightHeaderClassName,c=l.highlightRowClassName,u=l.highlightColumnClassName;n[a].classNames.forEach(o.add,o),s&&o.add(s),c&&o.add(c),u&&o.add(u)}Array.isArray(i)&&i.forEach(o.add,o),o.forEach(this.removeClassFromCells,this)}var f=this.getRenderedRowsCount(),h=this.getRenderedColumnsCount(),d=this.getFirstRenderedRow(),p=this.getFirstRenderedColumn(),v=this.getLastRenderedRow(),y=this.getLastRenderedColumn(),g=[];(this.is(ct.CLONE_LEFT)||this.is(ct.CLONE_TOP_LEFT_CORNER)||this.is(ct.CLONE_BOTTOM_LEFT_CORNER))&&(y+=1),(this.is(ct.CLONE_TOP)||this.is(ct.CLONE_TOP_LEFT_CORNER))&&(v+=1),(this.is(ct.CLONE_BOTTOM)||this.is(ct.CLONE_BOTTOM_LEFT_CORNER))&&(d-=1);for(var m=0;m<r;m++){var b=n[m].draw(t,f,h,d,p,v,y);b&&g.push(b)}this.wot.getSetting("columnHeaders"),this.borderRenderer.render(this.TABLE,this.createBorderPaddingObject(),g)}}},{key:"getCell",value:function(e){var t,n=e.row,r=e.col,o=this.wot.getSetting("onModifyGetCellCoords",n,r);if(o&&Array.isArray(o)){var i=vn(o,2);n=i[0],r=i[1]}if(this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;if(!(t=n<0?this.THEAD.childNodes[this.rowFilter.sourceRowToVisibleColHeadedRow(n)]:this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)])&&n>=0)throw new Error("TR was expected to be rendered but is not");var a=t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!a&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}},{key:"getColumnHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[t];if(n)return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getRowHeader",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0}},{key:"getCoords",value:function(e){var t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Object(O.closest)(t,["TD","TH"])),null===t)return null;var n=t.parentNode,r=n.parentNode,o=Object(O.index)(n),i=t.cellIndex;return Object(O.overlayContainsElement)(ct.CLONE_TOP_LEFT_CORNER,t,this.wtRootElement)||Object(O.overlayContainsElement)(ct.CLONE_TOP,t,this.wtRootElement)?"THEAD"===r.nodeName&&(o-=r.childNodes.length):o=Object(O.overlayContainsElement)(ct.CLONE_BOTTOM_LEFT_CORNER,t,this.wtRootElement)||Object(O.overlayContainsElement)(ct.CLONE_BOTTOM,t,this.wtRootElement)?this.wot.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o),i=Object(O.overlayContainsElement)(ct.CLONE_TOP_LEFT_CORNER,t,this.wtRootElement)||Object(O.overlayContainsElement)(ct.CLONE_LEFT,t,this.wtRootElement)||Object(O.overlayContainsElement)(ct.CLONE_BOTTOM_LEFT_CORNER,t,this.wtRootElement)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),new p(o,i)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var e,t,n,r,o,i=this.TBODY.childNodes.length,a=i*this.wot.wtSettings.settings.defaultRowHeight,l=Object(O.innerHeight)(this.TBODY)-1,s=this.isMaster?this.wot.rowUtils:this.wot.overlay.master.rowUtils;if(a!==l||this.wot.getSetting("fixedRowsBottom"))for(;i;)i-=1,n=this.rowFilter.renderedToSource(i),e=s.getHeight(n),t=(o=(r=this.getTrForRow(n)).querySelector("th"))?Object(O.innerHeight)(o):Object(O.innerHeight)(r)-1,(!e&&this.wot.wtSettings.settings.defaultRowHeight<t||e<t)&&(t+=1,this.wot.wtViewport.oversizedRows[n]=t)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderLevelRendered",value:function(e){return e>this.wot.getSetting("columnHeaders").length-1}},{key:"isRowHeaderLevelRendered",value:function(e){return e>this.wot.getSetting("rowHeaders").length-1}},{key:"isRowBeforeRenderedRows",value:function(e){var t=this.getFirstRenderedRow();return e<0&&(e=0),-1===t||e<t}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(e){if(e<0){var t=this.wot.getSetting("columnHeaders").length+e;return this.isColumnHeaderLevelRendered(t)}return e>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isColumnBeforeRenderedColumns",value:function(e){var t=this.getFirstRenderedColumn();return e<0&&(e=0),-1===t||e<t}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isColumnAfterRenderedColumns",value:function(e){if(e<0){var t=this.wot.getSetting("rowHeaders").length+e;return this.isRowHeaderLevelRendered(t)}return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"isVisible",value:function(){return Object(O.isVisible)(this.TABLE)}}])&&gn(t.prototype,n),r&&gn(t,r),e}(),bn={getFirstRenderedRow:function(){var e=this.wot.wtViewport.rowsRenderCalculator.startRow;return null===e?-1:e},getFirstVisibleRow:function(){var e=this.wot.wtViewport.rowsVisibleCalculator.startRow;return null===e?-1:e},getLastRenderedRow:function(){var e=this.wot.wtViewport.rowsRenderCalculator.endRow;return null===e?-1:e},getLastVisibleRow:function(){var e=this.wot.wtViewport.rowsVisibleCalculator.endRow;return null===e?-1:e},getRenderedRowsCount:function(){return this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}};Object(Xt.defineGetter)(bn,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var wn=bn,Cn={getFirstRenderedColumn:function(){var e=this.wot.wtViewport.columnsRenderCalculator.startColumn;return null===e?-1:e},getFirstVisibleColumn:function(){var e=this.wot.wtViewport.columnsVisibleCalculator.startColumn;return null===e?-1:e},getLastRenderedColumn:function(){var e=this.wot.wtViewport.columnsRenderCalculator.endColumn;return null===e?-1:e},getLastVisibleColumn:function(){var e=this.wot.wtViewport.columnsVisibleCalculator.endColumn;return null===e?-1:e},getRenderedColumnsCount:function(){return this.wot.wtViewport.columnsRenderCalculator.count},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}};Object(Xt.defineGetter)(Cn,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var On=Cn;function En(e){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rn(e,t){return(Rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=jn(e);if(t){var o=jn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kn(this,n)}}function kn(e,t){return!t||"object"!==En(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jn(e){return(jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rn(e,t)}(i,e);var t,n,r,o=Tn(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e,t)).holderOffset=0,n.wtRootElement.className+="ht_master handsontable",n.trimmingContainer=null,n.alignOverlaysWithTrimmingContainer(),n}return t=i,(n=[{key:"alignOverlaysWithTrimmingContainer",value:function(){this.trimmingContainer=Object(O.getTrimmingContainer)(this.wtRootElement);var e=this.trimmingContainer,t=this.wot.rootWindow;if(e===t)this.wot.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{e.parentElement;var n=Object(O.getStyle)(e,"height",t),r=(Object(O.getStyle)(e,"overflow",t),this.holder.style),o=Object(O.getBoundingClientRect)(e),i=o.width,a=o.height;a=Math.min(a,Object(O.scrollHeight)(e)),r.height="auto"===n?"auto":"".concat(a,"px"),i=Math.min(i,Object(O.scrollWidth)(e)),r.width="".concat(i,"px"),r.overflow="",this.hasTableHeight="auto"===r.height||a>0,this.hasTableWidth=i>0}}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wot,t=e.getSetting("columnHeaders").length;if(t&&!e.wtViewport.hasOversizedColumnHeadersMarked){for(var n=e.getSetting("rowHeaders").length,r=this.getRenderedColumnsCount(),o=0;o<t;o++)for(var i=-1*n;i<r;i++)this.markIfOversizedColumnHeader(i);e.wtViewport.hasOversizedColumnHeadersMarked=!0}}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot,n=t.wtOverlays,r=t.wtViewport,o=t.getSetting("totalRows"),i=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,s=t.getSetting("columnHeaders"),c=s.length,u=e;if(this.holderOffset=Object(O.offset)(this.holder),u=r.createRenderCalculators(u))r.createVisibleCalculators(),n.refreshClones(!0),this.refreshSelections(!0);else{var f=o>0?this.getFirstRenderedRow():0,h=i>0?this.getFirstRenderedColumn():0;this.rowFilter=new C(f,o,c),this.columnFilter=new b(h,i,l),this.alignOverlaysWithTrimmingContainer();var d={};this.wot.getSetting("beforeDraw",!0,d);var p=!0!==d.skipRender;p&&(this.tableRenderer.setHeaderContentRenderers(a,s),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),r.getWorkspaceWidth(),r.containerWidth=null,this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),this.markOversizedRows(),r.createVisibleCalculators(),n.refreshClones(!1),this.refreshSelections(!1),this.wot.getSetting("onDraw",!0))}}}])&&Sn(t.prototype,n),r&&Sn(t,r),i}(mn);Object(Xt.mixin)(Mn,wn),Object(Xt.mixin)(Mn,On);var An=Mn,Nn={getFirstRenderedColumn:function(){return 0===this.wot.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wot.getSetting("totalColumns");return Math.min(this.wot.getSetting("fixedColumnsLeft"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Object(Xt.defineGetter)(Nn,"MIXIN_NAME","stickyColumnsLeft",{writable:!1,enumerable:!1});var _n=Nn;function Hn(e){return(Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function In(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xn(e,t){return(xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ln(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Dn(e);if(t){var o=Dn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pn(this,n)}}function Pn(e,t){return!t||"object"!==Hn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dn(e){return(Dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Bn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xn(e,t)}(n,e);var t=Ln(n);function n(){return In(this,n),t.apply(this,arguments)}return n}(mn);Object(Xt.mixin)(Bn,wn),Object(Xt.mixin)(Bn,_n);var Fn=Bn;function Vn(e){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wn(e,t,n){return(Wn=Xn()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&zn(o,n.prototype),o}).apply(null,arguments)}function Un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zn(e,t){return(zn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gn(e,t){return!t||"object"!==Vn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Kn(e){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zn(e,t)}(l,e);var t,n,r,o,i,a=(t=l,n=Xn(),function(){var e,r=Kn(t);if(n){var o=Kn(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Gn(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).clone=t.makeClone(ct.CLONE_LEFT),t.updateStateOfRendering(),t}return r=l,(o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Wn(Fn,t)}},{key:"shouldBeRendered",value:function(){return!(!this.master.getSetting("fixedColumnsLeft")&&!this.master.getSetting("rowHeaders").length)}},{key:"adjustElementsPosition",value:function(){var e=this.master,t=e.getSetting("totalColumns");if("number"==typeof e.wtViewport.columnsRenderCalculator.startPosition)e.wtTable.spreader.style.left="".concat(e.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the columnsRenderCalculator");e.wtTable.spreader.style.left="0"}if(e.wtTable.spreader.style.right="",this.needFullRender&&("number"==typeof e.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(e.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""),this.needFullRender&&e.wtTable.holder.parentNode){var n=this.clone.wtTable.wtRootElement,r=e.getSetting("preventOverflow");if(e.wtTable.trimmingContainer!==e.rootWindow||r&&"horizontal"===r)Object(O.resetCssTransform)(n);else{var o,i,a=Object(O.getBoundingClientRect)(e.wtTable.hider),l=Math.ceil(a.left),s=Math.ceil(a.right);i=""===(i=e.wtTable.hider.style.top)?0:i,o=l<0&&s-Object(O.offsetWidth)(n)>0?-l:0,o+="px",Object(O.setOverlayPosition)(n,o,i)}var c=e.wtTable.wtRootElement;e.getSetting("totalRows")?Object(O.removeClass)(c,"emptyRows"):Object(O.addClass)(c,"emptyRows")}}},{key:"setScrollPosition",value:function(e){var t=this.master.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Object(O.getWindowScrollTop)(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}},{key:"onScroll",value:function(){this.master.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.master.wtSettings.defaultColumnWidth,r=e,o=0;r<t;)o+=this.master.columnUtils.getStretchedColumnWidth(r)||n,r+=1;return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender||e){var t=this.clone,n=this.master,r=t.wtTable.wtRootElement,o=r.style,i=n.getSetting("preventOverflow");if(n.wtTable.trimmingContainer!==n.rootWindow||"vertical"===i){var a=n.wtViewport.getWorkspaceHeight();n.wtOverlays.hasScrollbarBottom&&(a-=Object(O.getScrollbarWidth)(n.rootDocument)),a=Math.min(a,Object(O.scrollHeight)(n.wtTable.wtRootElement)),o.height="".concat(a,"px")}else o.height="";var l=Object(O.outerWidth)(t.wtTable.TABLE);o.width="".concat(l,"px"),t.wtTable.hider.style.height=n.wtTable.hider.style.height,t.wtTable.holder.style.height=o.height,t.wtTable.holder.style.width=o.width,e||(this.areElementSizesAdjusted=!0)}}},{key:"scrollTo",value:function(e,t){var n=this.master,r=this.getTableParentOffset(),o=n.wtTable.holder,i=0;return t&&Object(O.offsetWidth)(o)!==Object(O.clientWidth)(o)&&(i=Object(O.getScrollbarWidth)(n.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=n.wtViewport.getViewportWidth()):r+=this.sumCellSizes(n.getSetting("fixedColumnsLeft"),e),r+=i,this.setScrollPosition(r)}},{key:"getTableParentOffset",value:function(){var e=0;return this.master.getSetting("preventOverflow")||this.master.wtTable.trimmingContainer!==this.master.rootWindow||(e=this.master.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return Object(O.getScrollLeft)(this.mainTableScrollableElement,this.master.rootWindow)}}])&&Un(r.prototype,o),i&&Un(r,i),l}(ct);ct.registerOverlay(ct.CLONE_LEFT,Yn);var qn={getFirstRenderedRow:function(){return 0===this.wot.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(Xt.defineGetter)(qn,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var $n=qn;function Qn(e){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jn(e,t){return(Jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function er(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nr(e);if(t){var o=nr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tr(this,n)}}function tr(e,t){return!t||"object"!==Qn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jn(e,t)}(n,e);var t=er(n);function n(){return Zn(this,n),t.apply(this,arguments)}return n}(mn);Object(Xt.mixin)(rr,$n),Object(Xt.mixin)(rr,On);var or=rr;function ir(e){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ar(e,t,n){return(ar=fr()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&cr(o,n.prototype),o}).apply(null,arguments)}function lr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sr(e,t,n){return(sr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hr(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function cr(e,t){return(cr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ur(e,t){return!t||"object"!==ir(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function hr(e){return(hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cr(e,t)}(l,e);var t,n,r,o,i,a=(t=l,n=fr(),function(){var e,r=hr(t);if(n){var o=hr(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return ur(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).clone=t.makeClone(ct.CLONE_TOP),t.updateStateOfRendering(),t}return r=l,(o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ar(or,t)}},{key:"shouldBeRendered",value:function(){return!(!this.master.getSetting("fixedRowsTop")&&!this.master.getSetting("columnHeaders").length)}},{key:"adjustElementsPosition",value:function(){var e=this.master,t=e.getSetting("totalRows");if("number"==typeof e.wtViewport.rowsRenderCalculator.startPosition)e.wtTable.spreader.style.top="".concat(e.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");e.wtTable.spreader.style.top="0"}if(e.wtTable.spreader.style.bottom="",this.needFullRender&&("number"==typeof e.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(e.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""),this.needFullRender&&e.wtTable.holder.parentNode){var n=this.clone.wtTable.wtRootElement,r=e.getSetting("preventOverflow");if(e.wtTable.trimmingContainer!==e.rootWindow||r&&"vertical"===r)Object(O.resetCssTransform)(n);else{var o,i,a=Object(O.getBoundingClientRect)(e.wtTable.hider),l=Math.ceil(a.top),s=Math.ceil(a.bottom);o=""===(o=e.wtTable.hider.style.left)?0:o,i=l<0&&s-Object(O.offsetHeight)(n)>0?-l:0,i+="px",Object(O.setOverlayPosition)(n,o,i)}}}},{key:"setScrollPosition",value:function(e){var t=this.master.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Object(O.getWindowScrollLeft)(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.master.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.master.wtSettings.settings.defaultRowHeight,r=e,o=0;r<t;){var i=this.master.rowUtils.getHeight(r);o+=void 0===i?n:i,r+=1}return o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender||e){var t=this.clone,n=this.master,r=t.wtTable.wtRootElement,o=r.style,i=n.getSetting("preventOverflow");if(n.wtTable.trimmingContainer!==n.rootWindow||"horizontal"===i){var a=n.wtViewport.getWorkspaceWidth();n.wtOverlays.hasScrollbarRight&&(a-=Object(O.getScrollbarWidth)(n.rootDocument)),a=Math.min(a,Object(O.scrollWidth)(n.wtTable.wtRootElement)),o.width="".concat(a,"px")}else o.width="";var l=Object(O.outerHeight)(t.wtTable.TABLE);n.wtTable.hasDefinedSize()||(l=0),o.height="".concat(l,"px"),t.wtTable.hider.style.width=n.wtTable.hider.style.width,t.wtTable.holder.style.width=o.width,t.wtTable.holder.style.height=o.height,e||(this.areElementSizesAdjusted=!0)}}},{key:"scrollTo",value:function(e,t){var n=this.master,r=n.wtTable.holder,o=this.getTableParentOffset(),i=0;if(t&&Object(O.offsetHeight)(r)!==Object(O.clientHeight)(r)&&(i=Object(O.getScrollbarWidth)(n.rootDocument)),t){var a=n.getSetting("fixedRowsBottom"),l=n.getSetting("totalRows");o+=this.sumCellSizes(0,e+1),o-=n.wtViewport.getViewportHeight()-this.sumCellSizes(l-a,l),o+=1}else o+=this.sumCellSizes(n.getSetting("fixedRowsTop"),e);return o+=i,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.master.rootWindow?this.master.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(O.getScrollTop)(this.mainTableScrollableElement,this.master.rootWindow)}},{key:"redrawSelectionBorders",value:function(e){if(e&&e.cellRange&&e.hasSelectionHandle()){var t=e.getSelectionHandle(this.master),n=e.getCorners();t.disappear(),t.appear(n)}}},{key:"redrawAllSelectionsBorders",value:function(){var e=this,t=this.master.selections;this.redrawSelectionBorders(t.getCell()),Object(Kt.arrayEach)(t.getAreas(),(function(t){e.redrawSelectionBorders(t)})),this.redrawSelectionBorders(t.getFill()),this.master.wtOverlays.leftOverlay.redrawClone()}},{key:"redrawClone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(sr(hr(l.prototype),"redrawClone",this).call(this,e),!e&&0===this.master.getSetting("rowHeaders").length){var t=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(t)for(var n=0;n<t.length;n++)t[n].style["border-left-width"]=0}}}])&&lr(r.prototype,o),i&&lr(r,i),l}(ct);ct.registerOverlay(ct.CLONE_TOP,dr);function pr(e){return(pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yr(e,t){return(yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=br(e);if(t){var o=br(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mr(this,n)}}function mr(e,t){return!t||"object"!==pr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function br(e){return(br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yr(e,t)}(n,e);var t=gr(n);function n(){return vr(this,n),t.apply(this,arguments)}return n}(mn);Object(Xt.mixin)(wr,$n),Object(Xt.mixin)(wr,_n);var Cr=wr;function Or(e){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Er(e,t,n){return(Er=kr()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&Rr(o,n.prototype),o}).apply(null,arguments)}function Sr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rr(e,t){return(Rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tr(e,t){return!t||"object"!==Or(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function jr(e){return(jr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rr(e,t)}(l,e);var t,n,r,o,i,a=(t=l,n=kr(),function(){var e,r=jr(t);if(n){var o=jr(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Tr(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).clone=t.makeClone(ct.CLONE_TOP_LEFT_CORNER),t.updateStateOfRendering(),t}return r=l,(o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Er(Cr,t)}},{key:"shouldBeRendered",value:function(){var e=this.master;return!(!e.getSetting("fixedRowsTop")&&!e.getSetting("columnHeaders").length||!e.getSetting("fixedColumnsLeft")&&!e.getSetting("rowHeaders").length)}},{key:"adjustElementsPosition",value:function(){var e=this.clone,t=this.master;if(t.wtTable.holder.parentNode){var n=e.wtTable.wtRootElement,r=t.getSetting("preventOverflow");if(t.wtTable.trimmingContainer===t.rootWindow){var o=Object(O.getBoundingClientRect)(t.wtTable.hider),i=Math.ceil(o.top),a=Math.ceil(o.left),l=Math.ceil(o.bottom),s=Math.ceil(o.right),c="0",u="0";r&&"vertical"!==r||a<0&&s-Object(O.offsetWidth)(n)>0&&(c="".concat(-a,"px")),r&&"horizontal"!==r||i<0&&l-Object(O.offsetHeight)(n)>0&&(u="".concat(-i,"px")),Object(O.setOverlayPosition)(n,c,u)}else Object(O.resetCssTransform)(n)}}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender||e){var t=this.clone,n=this.master,r=Object(O.outerHeight)(t.wtTable.TABLE),o=Object(O.outerWidth)(t.wtTable.TABLE),i=t.wtTable.wtRootElement;n.wtTable.hasDefinedSize()||(r=0),i.style.height="".concat(r,"px"),i.style.width="".concat(o,"px")}}}])&&Sr(r.prototype,o),i&&Sr(r,i),l}(ct);ct.registerOverlay(ct.CLONE_TOP_LEFT_CORNER,Mr);var Ar={getFirstRenderedRow:function(){var e=this.wot.getSetting("totalRows"),t=this.wot.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wot.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wot.getSetting("totalRows");return Math.min(this.wot.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Object(Xt.defineGetter)(Ar,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var Nr=Ar;function _r(e){return(_r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ir(e,t){return(Ir=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pr(e);if(t){var o=Pr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Lr(this,n)}}function Lr(e,t){return!t||"object"!==_r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pr(e){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ir(e,t)}(n,e);var t=xr(n);function n(){return Hr(this,n),t.apply(this,arguments)}return n}(mn);Object(Xt.mixin)(Dr,Nr),Object(Xt.mixin)(Dr,On);var Br=Dr;function Fr(e){return(Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vr(e,t,n){return(Vr=Xr()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&zr(o,n.prototype),o}).apply(null,arguments)}function Wr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ur(e,t,n){return(Ur="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kr(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function zr(e,t){return(zr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gr(e,t){return!t||"object"!==Fr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Kr(e){return(Kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zr(e,t)}(l,e);var t,n,r,o,i,a=(t=l,n=Xr(),function(){var e,r=Kr(t);if(n){var o=Kr(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return Gr(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).clone=t.makeClone(ct.CLONE_BOTTOM),t.updateStateOfRendering(),t}return r=l,(o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Vr(Br,t)}},{key:"shouldBeRendered",value:function(){return!!this.master.getSetting("fixedRowsBottom")}},{key:"adjustElementsPosition",value:function(){var e=this.master,t=e.getSetting("totalRows");if("number"==typeof e.wtViewport.rowsRenderCalculator.startPosition)e.wtTable.spreader.style.top="".concat(e.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==t)throw new Error("Incorrect value of the rowsRenderCalculator");e.wtTable.spreader.style.top="0"}if(e.wtTable.spreader.style.bottom="",this.needFullRender&&("number"==typeof e.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left="".concat(e.wtViewport.columnsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.left=""),this.needFullRender&&e.wtTable.holder.parentNode){var n=this.clone.wtTable.wtRootElement,r=e.getSetting("preventOverflow");if(n.style.top="",e.wtTable.trimmingContainer!==e.rootWindow||r&&"vertical"===r){Object(O.resetCssTransform)(n);var o=Object(O.getScrollbarWidth)(e.rootDocument);Object(O.clientHeight)(e.wtTable.holder)===Object(O.offsetHeight)(e.wtTable.holder)&&(o=0),n.style.top="",n.style.bottom="".concat(o,"px")}else{var i,a,l=Object(O.getBoundingClientRect)(e.wtTable.hider),s=Math.ceil(l.bottom),c=Object(O.offsetHeight)(e.rootDocument.body);i=""===(i=e.wtTable.hider.style.left)?0:i,a=s>c?s-c:0,a+="px",n.style.top="",n.style.left=i,n.style.bottom=a}}}},{key:"setScrollPosition",value:function(e){var t=this.master,n=!1;return this.mainTableScrollableElement===t.rootWindow?(t.rootWindow.scrollTo(Object(O.getWindowScrollLeft)(t.rootWindow),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.master.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.master,r=n.wtSettings.settings.defaultRowHeight,o=e,i=0;o<t;){var a=n.rowUtils.getHeight(o);i+=void 0===a?r:a,o+=1}return i}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender||e){var t=this.clone,n=this.master,r=t.wtTable.wtRootElement,o=r.style,i=n.getSetting("preventOverflow");if(n.wtTable.trimmingContainer!==n.rootWindow||"horizontal"===i){var a=n.wtViewport.getWorkspaceWidth();n.wtOverlays.hasScrollbarRight&&(a-=Object(O.getScrollbarWidth)(n.rootDocument)),a=Math.min(a,Object(O.scrollWidth)(n.wtTable.wtRootElement)),o.width="".concat(a,"px")}else o.width="";var l=Object(O.outerHeight)(t.wtTable.TABLE);n.wtTable.hasDefinedSize()||(l=0),o.height="".concat(l,"px"),t.wtTable.hider.style.width=this.master.wtTable.hider.style.width,t.wtTable.holder.style.width=o.width,t.wtTable.holder.style.height=o.height,e||(this.areElementSizesAdjusted=!0)}}},{key:"scrollTo",value:function(e,t){var n=this.master,r=this.getTableParentOffset(),o=n.wtTable.holder,i=0;t&&Object(O.offsetHeight)(o)!==Object(O.clientHeight)(o)&&(i=Object(O.getScrollbarWidth)(n.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=n.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(n.getSetting("fixedRowsBottom"),e),r+=i,this.setScrollPosition(r)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.master.rootWindow?this.master.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Object(O.getScrollTop)(this.mainTableScrollableElement,this.master.rootWindow)}},{key:"redrawClone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(Ur(Kr(l.prototype),"redrawClone",this).call(this,e),!e&&0===this.master.getSetting("rowHeaders").length){var t=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");t&&(t.style["border-left-width"]=0)}}}])&&Wr(r.prototype,o),i&&Wr(r,i),l}(ct);ct.registerOverlay(ct.CLONE_BOTTOM,Yr);function qr(e){return(qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qr(e,t){return(Qr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=eo(e);if(t){var o=eo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jr(this,n)}}function Jr(e,t){return!t||"object"!==qr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eo(e){return(eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var to=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qr(e,t)}(n,e);var t=Zr(n);function n(){return $r(this,n),t.apply(this,arguments)}return n}(mn);Object(Xt.mixin)(to,Nr),Object(Xt.mixin)(to,_n);var no=to;function ro(e){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oo(e,t,n){return(oo=so()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&ao(o,n.prototype),o}).apply(null,arguments)}function io(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ao(e,t){return(ao=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lo(e,t){return!t||"object"!==ro(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function so(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function co(e){return(co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ao(e,t)}(l,e);var t,n,r,o,i,a=(t=l,n=so(),function(){var e,r=co(t);if(n){var o=co(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return lo(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).clone=t.makeClone(ct.CLONE_BOTTOM_LEFT_CORNER),t.updateStateOfRendering(),t}return r=l,(o=[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return oo(no,t)}},{key:"shouldBeRendered",value:function(){var e=this.master;return!(!e.getSetting("fixedRowsBottom")||!e.getSetting("fixedColumnsLeft")&&!e.getSetting("rowHeaders").length)}},{key:"adjustElementsPosition",value:function(){var e=this.clone,t=this.master;if(t.wtTable.holder.parentNode){var n=e.wtTable.wtRootElement;if(n.style.top="",t.wtTable.trimmingContainer===t.rootWindow){var r,o,i=Object(O.getBoundingClientRect)(t.wtTable.hider),a=Math.ceil(i.bottom),l=Math.ceil(i.left),s=Object(O.offsetHeight)(t.rootDocument.body);r=l<0?-l:0,o=a>s?a-s:0,o+="px",r+="px",n.style.top="",n.style.left=r,n.style.bottom=o}else{Object(O.resetCssTransform)(n);var c=Object(O.getScrollbarWidth)(t.rootDocument);Object(O.clientHeight)(t.wtTable.holder)===Object(O.offsetHeight)(t.wtTable.holder)&&(c=0),n.style.top="",n.style.bottom="".concat(c,"px")}}}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender||e){var t=this.clone,n=this.master,r=Object(O.outerHeight)(t.wtTable.TABLE),o=Object(O.outerWidth)(t.wtTable.TABLE),i=t.wtTable.wtRootElement;n.wtTable.hasDefinedSize()||(r=0),i.style.height="".concat(r,"px"),i.style.width="".concat(o,"px")}}}])&&io(r.prototype,o),i&&io(r,i),l}(ct);ct.registerOverlay(ct.CLONE_BOTTOM_LEFT_CORNER,uo);var fo=n(178);function ho(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return po(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return po(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function po(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var yo=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&(this.eventManager=new Ie.a(t),this.wot=t,this.settings=n,this.mouseDown=!1,this.main=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createElements(n),this.registerListeners())}var t,n,r;return t=e,(n=[{key:"registerListeners",value:function(){var e=this,t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(function(){return e.onMouseDown()})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}));for(var n=function(t,n){e.eventManager.addEventListener(e.main.childNodes[t],"mouseenter",(function(n){return e.onMouseEnter(n,e.main.childNodes[t])}))},r=0,o=this.main.childNodes.length;r<o;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),Object(fo.stopImmediatePropagation)(e);var n=this,r=this.wot.rootDocument.body,o=Object(O.getBoundingClientRect)(t);t.style.display="none",this.eventManager.addEventListener(r,"mousemove",(function e(i){var a;((a=i).clientY<Math.floor(o.top)||a.clientY>Math.ceil(o.top+o.height)||a.clientX<Math.floor(o.left)||a.clientX>Math.ceil(o.left+o.width))&&(n.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")}))}}},{key:"createElements",value:function(e){var t=this.wot.rootDocument;this.main=t.createElement("div");var n=this.main.style;n.position="absolute",n.top=0,n.left=0;var r=t.createElement("div");r.className="wtBorder ".concat(this.settings.className||""),(n=r.style).height=this.settings.corner&&this.settings.corner.width?"".concat(this.settings.corner.width,"px"):"".concat(e.border.width,"px"),n.width=this.settings.corner&&this.settings.corner.width?"".concat(this.settings.corner.width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(r),this.corner=r,this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Object(Ge.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear();var o=this.wot.wtTable,i=o.selectionHandlesHolder;i||((i=t.createElement("div")).className="htBorders",o.selectionHandlesHolder=i,o.spreader.appendChild(i)),i.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,t=this.wot.rootDocument;this.selectionHandles={topLeft:t.createElement("DIV"),topLeftHitArea:t.createElement("DIV"),bottomRight:t.createElement("DIV"),bottomRightHitArea:t.createElement("DIV")},this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var n={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};Object(Xt.objectEach)(n,(function(t,n){e.selectionHandles.styles.bottomRightHitArea[n]=t,e.selectionHandles.styles.topLeftHitArea[n]=t}));var r={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#FFFFFF","border-width":"1px","border-style":"solid"};Object(Xt.objectEach)(r,(function(t,n){e.selectionHandles.styles.bottomRight[n]=t,e.selectionHandles.styles.topLeft[n]=t})),this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(e,t){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,t,n,r,o,i){var a=parseInt(this.selectionHandles.styles.topLeft.width,10),l=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10),s=this.settings.corner&&this.settings.corner.color?this.settings.corner.color:this.settings.border.color;this.selectionHandles.styles.topLeft.borderColor=s,this.selectionHandles.styles.bottomRight.borderColor=s,this.selectionHandles.styles.topLeft.top="".concat(parseInt(n-a,10),"px"),this.selectionHandles.styles.topLeft.left="".concat(parseInt(r-a,10),"px"),this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(n-l/4*3,10),"px"),this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(r-l/4*3,10),"px"),this.selectionHandles.styles.bottomRight.top="".concat(parseInt(n+i,10),"px"),this.selectionHandles.styles.bottomRight.left="".concat(parseInt(r+o,10),"px"),this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(n+i-l/4,10),"px"),this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(r+o-l/4,10),"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(e,t)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var t,n,r,o,i=this.wot,a=i.wtTable,l=i.rootDocument,s=i.rootWindow,c=a.getRenderedRowsCount(),u=0;u<c;u+=1){var f=a.rowFilter.renderedToSource(u);if(f>=e[0]&&f<=e[2]){t=f;break}}for(var h=c-1;h>=0;h-=1){var d=a.rowFilter.renderedToSource(h);if(d>=e[0]&&d<=e[2]){n=d;break}}for(var v=a.getRenderedColumnsCount(),y=0;y<v;y+=1){var g=a.columnFilter.renderedToSource(y);if(g>=e[1]&&g<=e[3]){r=g;break}}for(var m=v-1;m>=0;m-=1){var b=a.columnFilter.renderedToSource(m);if(b>=e[1]&&b<=e[3]){o=b;break}}if(void 0!==t&&void 0!==r){var w=a.getCell(new p(t,r)),C=t!==n||r!==o,E=C?a.getCell(new p(n,o)):w,S=Object(O.offset)(w),R=C?Object(O.offset)(E):S,T=Object(O.offset)(a.TABLE),k=S.top,j=S.left,M=j-T.left-1,A=R.left+Object(O.outerWidth)(E)-j;if(this.isEntireColumnSelected(t,n)){var N=this.getDimensionsFromHeader("columns",r,o,T),_=null;if(N){var H=ho(N,3);_=H[0],M=H[1],A=H[2]}_&&(w=_)}var I=k-T.top-1,x=R.top+Object(O.outerHeight)(E)-k;if(this.isEntireRowSelected(r,o)){var L=this.getDimensionsFromHeader("rows",t,n,T),P=null;if(L){var D=ho(L,3);P=D[0],I=D[1],x=D[2]}P&&(w=P)}var B=this.settings.border.cornerVisible;B="function"==typeof B?B(this.settings.layerLevel):B;var F=this.wot.getSetting("onModifyGetCellCoords",n,o),V=n,W=o;if(F&&Array.isArray(F)){var U=ho(F,4);V=U[2],W=U[3]}if(Object(Ge.isMobileBrowser)()||!B||this.isPartRange(V,W))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(I+x-4,"px"),this.cornerStyle.left="".concat(M+A-4,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.backgroundColor=this.settings.corner&&this.settings.corner.color?this.settings.corner.color:this.settings.border.color,this.cornerStyle.display="none";var z=this.wot.overlay?this.wot.overlay.master.wtTable.trimmingContainer:a.trimmingContainer,G=z===s;if(G&&(z=l.documentElement),o===this.wot.getSetting("totalColumns")-1){var X=(G?Object(O.getBoundingClientRect)(E).left:E.offsetLeft)+Object(O.outerWidth)(E)+parseInt(this.cornerDefaultStyle.width,10)/2,K=this.wot.overlay?this.wot.overlay.master.columnUtils:this.wot.columnUtils;X>=Object(O.innerWidth)(z)-K.scrollbarCompensation&&(this.cornerStyle.left="".concat(Math.floor(M+A-3-parseInt(this.cornerDefaultStyle.width,10)/2),"px"),this.cornerStyle.borderRightWidth=0)}n===this.wot.getSetting("totalRows")-1&&(G?Object(O.getBoundingClientRect)(E).top:E.offsetTop)+Object(O.outerHeight)(E)+parseInt(this.cornerDefaultStyle.height,10)/2>=Object(O.innerHeight)(z)&&(this.cornerStyle.top="".concat(Math.floor(I+x-3-parseInt(this.cornerDefaultStyle.height,10)/2),"px"),this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Object(Ge.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(n,o,I,M,A,x)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,t,n,r){var o=this.wot.wtTable,i=o.wtRootElement.parentNode,a=null,l=null,s=null,c=null,u=null,f=null,h=null,d=null;switch(e){case"rows":a=function(){return o.getRowHeader.apply(o,arguments)},l=function(){return O.outerHeight.apply(void 0,arguments)},s="ht__selection--rows",f="top";break;case"columns":a=function(){return o.getColumnHeader.apply(o,arguments)},l=function(){return O.outerWidth.apply(void 0,arguments)},s="ht__selection--columns",f="left"}if(i.className.includes(s)){var p=this.wot.getSetting("columnHeaders").length;if(h=a(t,p-1),d=a(n,p-1),!h||!d)return!1;var v=Object(O.offset)(h),y=Object(O.offset)(d);return h&&d&&(c=v[f]-r[f]-1,u=y[f]+l(d)-v[f]),[h,c,u]}return!1}},{key:"disappear",value:function(){this.cornerStyle.display="none",Object(Ge.isMobileBrowser)()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}])&&vo(t.prototype,n),r&&vo(t,r),e}();function go(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bo(e){return(bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Co=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t,this.cellRange=n||null,this.instanceSelectionHandles=new Map,this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}var t,n,r;return t=e,(n=[{key:"hasSelectionHandle",value:function(){return this.settings.border&&"function"==typeof this.settings.border.cornerVisible}},{key:"getSelectionHandle",value:function(e){var t=this.getSelectionHandleIfExists(e);if(t)return t;var n=new yo(e,this.settings);return this.instanceSelectionHandles.set(e,n),n}},{key:"getSelectionHandleIfExists",value:function(e){return this.instanceSelectionHandles.get(e)}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=new g(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){return this.cellRange.getCorners()}},{key:"addClassAtCoords",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=e.getCell(new p(t,n));if("object"===bo(i)){var a=r;o&&(a=this.classNameGenerator(i),this.classNames.includes(a)||this.classNames.push(a)),Object(O.addClass)(i,a)}return this}},{key:"linearClassNameGenerator",value:function(e,t){return function n(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===o)return e;var i=o>=0?o:t,a=e,l=0==(i-=1)?e:"".concat(e,"-").concat(i);if(Object(O.hasClass)(r,l)){var s=i+1;a="".concat(e,"-").concat(s)}else a=n(r,i);return a}}},{key:"addClassIfElemExists",value:function(e,t){e&&Object(O.addClass)(e,t)}},{key:"draw",value:function(e,t,n,r,o,i,a){if(!this.isEmpty()){var l,s=e.wtTable,c=this.settings,u=c.highlightHeaderClassName,f=c.highlightRowClassName,h=c.highlightColumnClassName,d=this.getCorners(),p=go(d,4),v=p[0],y=p[1],g=p[2],m=p[3],b=Math.max(v,r),w=Math.max(y,o),C=Math.min(g,i),O=Math.min(m,a),E={row:b,col:w},S={row:C,col:O},R=b===v,T=O===m,k=C===g,j=w===y;if(n&&(u||h))for(var M=w;M<=O;M+=1)if(this.addClassIfElemExists(s.getColumnHeader(M),[u,h]),h)for(var A=0;A<t;A+=1)if(A<b||A>C){var N=s.rowFilter.renderedToSource(A);this.addClassAtCoords(s,N,M,h)}if(t&&(u||f))for(var _=b;_<=C;_+=1)if(this.addClassIfElemExists(s.getRowHeader(_),[u,f]),f)for(var H=0;H<n;H+=1)if(H<w||H>O){var I=s.columnFilter.renderedToSource(H);this.addClassAtCoords(s,_,I,f)}this.settings.border&&b<=C&&w<=O&&(l={settings:this.settings,selectionStart:E,selectionEnd:S,hasTopEdge:R,hasRightEdge:T,hasBottomEdge:k,hasLeftEdge:j});for(var x=b;x<=C;x+=1)for(var L=w;L<=O;L+=1)if(x>=b&&x<=C&&L>=w&&L<=O&&this.settings.className&&this.addClassAtCoords(s,x,L,this.settings.className,this.settings.markIntersections),this.settings.className){var P=e.getSetting("onAfterDrawSelection",x,L,d,this.settings.layerLevel);"string"==typeof P&&this.addClassAtCoords(s,x,L,P)}return e.getSetting("onBeforeDrawBorders",d,this.settings.className),this.hasSelectionHandle()&&this.getSelectionHandle(e).appear(d),l}if(this.hasSelectionHandle()){var D=this.getSelectionHandleIfExists(e);D&&D.disappear()}}},{key:"destroy",value:function(){this.instanceSelectionHandles.forEach((function(e){return e.destroy()}))}}])&&wo(t.prototype,n),r&&wo(t,r),e}()},,function(e,t,n){"use strict";n.r(t),n.d(t,"stringify",(function(){return o})),n.d(t,"isDefined",(function(){return i})),n.d(t,"isUndefined",(function(){return a})),n.d(t,"isEmpty",(function(){return l})),n.d(t,"isRegExp",(function(){return s})),n.d(t,"_injectProductInfo",(function(){return c}));n(175);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){var t;switch(r(e)){case"string":case"number":t="".concat(e);break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function i(e){return void 0!==e}function a(e){return void 0===e}function l(e){return null===e||""===e||a(e)}function s(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function c(e,t){}},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(176),o=n(178);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=0,s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}var t,n,o;return t=e,(n=[{key:"addEventListener",value:function(e,t,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function a(e){n.call(this,c(e))}return"boolean"==typeof i||Object(r.isPassiveEventSupported)()||(i=!1),this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:a,options:i,eventManager:this}),e.addEventListener(t,a,i),l+=1,function(){o.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){for(var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.context.eventListeners.length;i;)if(i-=1,(r=this.context.eventListeners[i]).event===t&&r.element===e){if(n&&n!==r.callback)continue;if(o&&r.eventManager!==this)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),l-=1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var n=this.context.eventListeners[t];n&&this.removeEventListener(n.element,n.event,n.callback,e)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(e,t){var n=e.document,r=e;n||(r=(n=e.ownerDocument?e.ownerDocument:e).defaultView);var o,i={bubbles:!0,cancelable:"mousemove"!==t,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};n.createEvent?(o=n.createEvent("MouseEvents")).initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on".concat(t),o)}}])&&a(t.prototype,n),o&&a(t,o),e}();function c(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Object(o.stopImmediatePropagation)(this)},e}function u(){return l}t.a=s},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){var t=r(e);return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function i(e,t,n){var r=-1;for("function"==typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function a(e,t,n){var r=e+1;for("function"==typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}function l(e,t){return t=parseInt(t.toString().replace("%",""),10),t=parseInt(e*t/100,10)}n.r(t),n.d(t,"isNumeric",(function(){return o})),n.d(t,"rangeEach",(function(){return i})),n.d(t,"rangeEachReverse",(function(){return a})),n.d(t,"valueAccordingPercent",(function(){return l}))},function(e,t,n){"use strict";n.r(t),n.d(t,"CONTEXT_MENU_ITEMS_NAMESPACE",(function(){return r})),n.d(t,"CONTEXTMENU_ITEMS_NO_ITEMS",(function(){return o})),n.d(t,"CONTEXTMENU_ITEMS_ROW_ABOVE",(function(){return i})),n.d(t,"CONTEXTMENU_ITEMS_ROW_BELOW",(function(){return a})),n.d(t,"CONTEXTMENU_ITEMS_INSERT_LEFT",(function(){return l})),n.d(t,"CONTEXTMENU_ITEMS_INSERT_RIGHT",(function(){return s})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_ROW",(function(){return c})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_COLUMN",(function(){return u})),n.d(t,"CONTEXTMENU_ITEMS_UNDO",(function(){return f})),n.d(t,"CONTEXTMENU_ITEMS_REDO",(function(){return h})),n.d(t,"CONTEXTMENU_ITEMS_READ_ONLY",(function(){return d})),n.d(t,"CONTEXTMENU_ITEMS_CLEAR_COLUMN",(function(){return p})),n.d(t,"CONTEXTMENU_ITEMS_COPY",(function(){return v})),n.d(t,"CONTEXTMENU_ITEMS_CUT",(function(){return y})),n.d(t,"CONTEXTMENU_ITEMS_FREEZE_COLUMN",(function(){return g})),n.d(t,"CONTEXTMENU_ITEMS_UNFREEZE_COLUMN",(function(){return m})),n.d(t,"CONTEXTMENU_ITEMS_MERGE_CELLS",(function(){return b})),n.d(t,"CONTEXTMENU_ITEMS_UNMERGE_CELLS",(function(){return w})),n.d(t,"CONTEXTMENU_ITEMS_ADD_COMMENT",(function(){return C})),n.d(t,"CONTEXTMENU_ITEMS_EDIT_COMMENT",(function(){return O})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_COMMENT",(function(){return E})),n.d(t,"CONTEXTMENU_ITEMS_READ_ONLY_COMMENT",(function(){return S})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT",(function(){return R})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_LEFT",(function(){return T})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_CENTER",(function(){return k})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT",(function(){return j})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY",(function(){return M})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_TOP",(function(){return A})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE",(function(){return N})),n.d(t,"CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM",(function(){return _})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS",(function(){return H})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_TOP",(function(){return I})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_RIGHT",(function(){return x})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_BOTTOM",(function(){return L})),n.d(t,"CONTEXTMENU_ITEMS_BORDERS_LEFT",(function(){return P})),n.d(t,"CONTEXTMENU_ITEMS_REMOVE_BORDERS",(function(){return D})),n.d(t,"CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD",(function(){return B})),n.d(t,"CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD",(function(){return F})),n.d(t,"CONTEXTMENU_ITEMS_HIDE_COLUMN",(function(){return V})),n.d(t,"CONTEXTMENU_ITEMS_SHOW_COLUMN",(function(){return W})),n.d(t,"CONTEXTMENU_ITEMS_HIDE_ROW",(function(){return U})),n.d(t,"CONTEXTMENU_ITEMS_SHOW_ROW",(function(){return z})),n.d(t,"FILTERS_NAMESPACE",(function(){return G})),n.d(t,"FILTERS_CONDITIONS_NAMESPACE",(function(){return X})),n.d(t,"FILTERS_CONDITIONS_NONE",(function(){return K})),n.d(t,"FILTERS_CONDITIONS_EMPTY",(function(){return Y})),n.d(t,"FILTERS_CONDITIONS_NOT_EMPTY",(function(){return q})),n.d(t,"FILTERS_CONDITIONS_EQUAL",(function(){return $})),n.d(t,"FILTERS_CONDITIONS_NOT_EQUAL",(function(){return Q})),n.d(t,"FILTERS_CONDITIONS_BEGINS_WITH",(function(){return Z})),n.d(t,"FILTERS_CONDITIONS_ENDS_WITH",(function(){return J})),n.d(t,"FILTERS_CONDITIONS_CONTAINS",(function(){return ee})),n.d(t,"FILTERS_CONDITIONS_NOT_CONTAIN",(function(){return te})),n.d(t,"FILTERS_CONDITIONS_BY_VALUE",(function(){return ne})),n.d(t,"FILTERS_CONDITIONS_GREATER_THAN",(function(){return re})),n.d(t,"FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL",(function(){return oe})),n.d(t,"FILTERS_CONDITIONS_LESS_THAN",(function(){return ie})),n.d(t,"FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL",(function(){return ae})),n.d(t,"FILTERS_CONDITIONS_BETWEEN",(function(){return le})),n.d(t,"FILTERS_CONDITIONS_NOT_BETWEEN",(function(){return se})),n.d(t,"FILTERS_CONDITIONS_AFTER",(function(){return ce})),n.d(t,"FILTERS_CONDITIONS_BEFORE",(function(){return ue})),n.d(t,"FILTERS_CONDITIONS_TODAY",(function(){return fe})),n.d(t,"FILTERS_CONDITIONS_TOMORROW",(function(){return he})),n.d(t,"FILTERS_CONDITIONS_YESTERDAY",(function(){return de})),n.d(t,"FILTERS_DIVS_FILTER_BY_CONDITION",(function(){return pe})),n.d(t,"FILTERS_DIVS_FILTER_BY_VALUE",(function(){return ve})),n.d(t,"FILTERS_LABELS_CONJUNCTION",(function(){return ye})),n.d(t,"FILTERS_LABELS_DISJUNCTION",(function(){return ge})),n.d(t,"FILTERS_VALUES_BLANK_CELLS",(function(){return me})),n.d(t,"FILTERS_BUTTONS_SELECT_ALL",(function(){return be})),n.d(t,"FILTERS_BUTTONS_CLEAR",(function(){return we})),n.d(t,"FILTERS_BUTTONS_OK",(function(){return Ce})),n.d(t,"FILTERS_BUTTONS_CANCEL",(function(){return Oe})),n.d(t,"FILTERS_BUTTONS_PLACEHOLDER_SEARCH",(function(){return Ee})),n.d(t,"FILTERS_BUTTONS_PLACEHOLDER_VALUE",(function(){return Se})),n.d(t,"FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE",(function(){return Re}));var r="ContextMenu:items",o="".concat(r,".noItems"),i="".concat(r,".insertRowAbove"),a="".concat(r,".insertRowBelow"),l="".concat(r,".insertColumnOnTheLeft"),s="".concat(r,".insertColumnOnTheRight"),c="".concat(r,".removeRow"),u="".concat(r,".removeColumn"),f="".concat(r,".undo"),h="".concat(r,".redo"),d="".concat(r,".readOnly"),p="".concat(r,".clearColumn"),v="".concat(r,".copy"),y="".concat(r,".cut"),g="".concat(r,".freezeColumn"),m="".concat(r,".unfreezeColumn"),b="".concat(r,".mergeCells"),w="".concat(r,".unmergeCells"),C="".concat(r,".addComment"),O="".concat(r,".editComment"),E="".concat(r,".removeComment"),S="".concat(r,".readOnlyComment"),R="".concat(r,".align"),T="".concat(r,".align.left"),k="".concat(r,".align.center"),j="".concat(r,".align.right"),M="".concat(r,".align.justify"),A="".concat(r,".align.top"),N="".concat(r,".align.middle"),_="".concat(r,".align.bottom"),H="".concat(r,".borders"),I="".concat(r,".borders.top"),x="".concat(r,".borders.right"),L="".concat(r,".borders.bottom"),P="".concat(r,".borders.left"),D="".concat(r,".borders.remove"),B="".concat(r,".nestedHeaders.insertChildRow"),F="".concat(r,".nestedHeaders.detachFromParent"),V="".concat(r,".hideColumn"),W="".concat(r,".showColumn"),U="".concat(r,".hideRow"),z="".concat(r,".showRow"),G="Filters:",X="".concat(G,"conditions"),K="".concat(X,".none"),Y="".concat(X,".isEmpty"),q="".concat(X,".isNotEmpty"),$="".concat(X,".isEqualTo"),Q="".concat(X,".isNotEqualTo"),Z="".concat(X,".beginsWith"),J="".concat(X,".endsWith"),ee="".concat(X,".contains"),te="".concat(X,".doesNotContain"),ne="".concat(X,".byValue"),re="".concat(X,".greaterThan"),oe="".concat(X,".greaterThanOrEqualTo"),ie="".concat(X,".lessThan"),ae="".concat(X,".lessThanOrEqualTo"),le="".concat(X,".isBetween"),se="".concat(X,".isNotBetween"),ce="".concat(X,".after"),ue="".concat(X,".before"),fe="".concat(X,".today"),he="".concat(X,".tomorrow"),de="".concat(X,".yesterday"),pe="".concat(G,"labels.filterByCondition"),ve="".concat(G,"labels.filterByValue"),ye="".concat(G,"labels.conjunction"),ge="".concat(G,"labels.disjunction"),me="".concat(G,"values.blankCells"),be="".concat(G,"buttons.selectAll"),we="".concat(G,"buttons.clear"),Ce="".concat(G,"buttons.ok"),Oe="".concat(G,"buttons.cancel"),Ee="".concat(G,"buttons.placeholder.search"),Se="".concat(G,"buttons.placeholder.value"),Re="".concat(G,"buttons.placeholder.secondValue")},function(e,t,n){"use strict";n.r(t),n.d(t,"setBrowserMeta",(function(){return l})),n.d(t,"setPlatformMeta",(function(){return s})),n.d(t,"isChrome",(function(){return c})),n.d(t,"isEdge",(function(){return u})),n.d(t,"isIE",(function(){return f})),n.d(t,"isIE9",(function(){return h})),n.d(t,"isMSBrowser",(function(){return d})),n.d(t,"isMobileBrowser",(function(){return p})),n.d(t,"isSafari",(function(){return v})),n.d(t,"isFirefox",(function(){return y})),n.d(t,"isWindowsOS",(function(){return g})),n.d(t,"isMacOS",(function(){return m})),n.d(t,"isLinuxOS",(function(){return b}));var r=n(155),o=function(e){var t={value:!1,test:function(n,r){t.value=e(n,r)}};return t},i={chrome:o((function(e,t){return/Chrome/.test(e)&&/Google/.test(t)})),edge:o((function(e){return/Edge/.test(e)})),firefox:o((function(e){return/Firefox/.test(e)})),ie:o((function(e){return/Trident/.test(e)})),ie9:o((function(){return!!document.documentMode})),mobile:o((function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)})),safari:o((function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)}))},a={mac:o((function(e){return/^Mac/.test(e)})),win:o((function(e){return/^Win/.test(e)})),linux:o((function(e){return/^Linux/.test(e)}))};function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=void 0===t?navigator.userAgent:t,o=e.vendor,a=void 0===o?navigator.vendor:o;Object(r.objectEach)(i,(function(e){(0,e.test)(n,a)}))}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.platform,n=void 0===t?navigator.platform:t;Object(r.objectEach)(a,(function(e){(0,e.test)(n)}))}function c(){return i.chrome.value}function u(){return i.edge.value}function f(){return i.ie.value}function h(){return i.ie9.value}function d(){return i.ie.value||i.edge.value}function p(){return i.mobile.value}function v(){return i.safari.value}function y(){return i.firefox.value}function g(){return a.win.value}function m(){return a.mac.value}function b(){return a.linux.value}l(),s()},function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(181),o=n(155),i=n(172),a=new WeakMap;function l(e,t){var n=Object(i.toUpperCaseFirst)(e);r.a.getSingleton().add("construct",(function(){a.has(this)||a.set(this,{});var e=a.get(this);e[n]||(e[n]=new t(this))})),r.a.getSingleton().add("afterDestroy",(function(){if(a.has(this)){var e=a.get(this);Object(o.objectEach)(e,(function(e){return e.destroy()})),a.delete(this)}}))}function s(e,t){if("string"!=typeof t)throw Error('Only strings can be passed as "plugin" parameter');var n=Object(i.toUpperCaseFirst)(t);if(a.has(e)&&a.get(e)[n])return a.get(e)[n]}function c(e){return a.has(e)?Object.keys(a.get(e)):[]}function u(e,t){var n=null;return a.has(e)&&Object(o.objectEach)(a.get(e),(function(e,r){e===t&&(n=r)})),n}},,function(e,t,n){"use strict";n.r(t),n.d(t,"toUpperCaseFirst",(function(){return o})),n.d(t,"equalsIgnoreCase",(function(){return i})),n.d(t,"randomString",(function(){return a})),n.d(t,"isPercentValue",(function(){return l})),n.d(t,"substitute",(function(){return s})),n.d(t,"stripTags",(function(){return u}));var r=n(163);function o(e){return e[0].toUpperCase()+e.substr(1)}function i(){for(var e=[],t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];for(var i=n.length;i;){i-=1;var a=Object(r.stringify)(n[i]).toLowerCase();-1===e.indexOf(a)&&e.push(a)}return 1===e.length}function a(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function l(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,(function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]}))}var c=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi;function u(e){return"".concat(e).replace(c,"")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),o=n.n(r),i=function(e){var t=e.description;return o.a.createElement("p",{className:"toolbar-mobile-menu-item-text"},t)}},function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return a}));var i=new Map;function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";i.has(e)||i.set(e,new Map);var t=i.get(e);function n(e,n){t.set(e,n)}function o(e){return t.get(e)}function a(e){return t.has(e)}function l(){return r(t.keys())}function s(){return r(t.values())}return{register:n,getItem:o,hasItem:a,getNames:l,getValues:s}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(156);function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=Object(r.arrayReduce)(e,(function(e,t,r){return e+t.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:"")}),"");return i.trim()}},function(e,t,n){"use strict";n.r(t),n.d(t,"requestAnimationFrame",(function(){return d})),n.d(t,"isClassListSupported",(function(){return p})),n.d(t,"isTextContentSupported",(function(){return v})),n.d(t,"isGetComputedStyleSupported",(function(){return y})),n.d(t,"cancelAnimationFrame",(function(){return g})),n.d(t,"isTouchSupported",(function(){return m})),n.d(t,"hasCaptionProblem",(function(){return b})),n.d(t,"getComparisonFunction",(function(){return w})),n.d(t,"isPassiveEventSupported",(function(){return C}));var r=n(157);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}for(var i,a,l,s=0,c=["ms","moz","webkit","o"],u=window.requestAnimationFrame,f=window.cancelAnimationFrame,h=0;h<c.length&&!u;++h)u=window["".concat(c[h],"RequestAnimationFrame")],f=window["".concat(c[h],"CancelAnimationFrame")]||window["".concat(c[h],"CancelRequestAnimationFrame")];function d(e){return u.call(window,e)}function p(){return!!document.documentElement.classList}function v(){return!!document.createTextNode("test").textContent}function y(){return!!window.getComputedStyle}function g(e){f.call(window,e)}function m(){return"ontouchstart"in window}function b(){return void 0===i&&function(){var e=document.createElement("TABLE");e.style.borderSpacing="0",e.style.borderWidth="0",e.style.padding="0";var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding="0",n.style.margin="0",e.insertBefore(n,t),document.body.appendChild(e),i=Object(r.offsetHeight)(e)<2*Object(r.offsetHeight)(e.lastChild),document.body.removeChild(e)}(),i}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a||(a="object"===("undefined"==typeof Intl?"undefined":o(Intl))?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?function(e,t){return"".concat(e).localeCompare(t)}:function(e,t){return e===t?0:e>t?-1:1})}function C(){if(void 0!==l)return l;try{var e={get passive(){l=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){l=!1}return l}u||(u=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-s)),r=window.setTimeout((function(){e(t+n)}),n);return s=t+n,r}),f||(f=function(e){clearTimeout(e)})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=1},function(e,t,n){"use strict";function r(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function o(e){return!1===e.isImmediatePropagationEnabled}function i(e){return 2===e.button}function a(e){return 0===e.button}n.r(t),n.d(t,"stopImmediatePropagation",(function(){return r})),n.d(t,"isImmediatePropagationStopped",(function(){return o})),n.d(t,"isRightClick",(function(){return i})),n.d(t,"isLeftClick",(function(){return a}))},,,function(e,t,n){"use strict";var r=n(156),o=n(155),i=n(172),a=n(182),l=n(175);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function u(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to learn about the migration path.'],['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to learn about the migration path.']);return u=function(){return e},e}var f=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand"],h=Object(l.a)(u()),d=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),p=new Map([]),v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalBucket=this.createEmptyBucket()}return c(e,null,[{key:"getSingleton",value:function(){return y}}]),c(e,[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return Object(r.arrayEach)(f,(function(t){return e[t]=[]})),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))Object(r.arrayEach)(t,(function(t){return n.add(e,t,o)}));else{d.has(e)&&Object(a.b)(Object(i.substitute)(h,{hookName:e,removedInVersion:d.get(e)})),p.has(e)&&Object(a.b)(p.get(e));var l=this.getBucket(o);if(void 0===l[e]&&(this.register(e),l[e]=[]),t.skip=!1,-1===l[e].indexOf(t)){var s=!1;t.initialHook&&Object(r.arrayEach)(l[e],(function(n,r){if(n.initialHook)return l[e][r]=t,s=!0,!1})),s||l[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?Object(r.arrayEach)(t,(function(t){return n.once(e,t,o)})):(t.runOnce=!0,this.add(e,t,o))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return void 0!==r[e]&&r[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}},{key:"run",value:function(e,t,n,r,o,i,a,l){var s=this.globalBucket[t],c=s?s.length:0,u=0;if(c)for(;u<c;)if(s[u]&&!s[u].skip){var f=s[u].call(e,n,r,o,i,a,l);void 0!==f&&(n=f),s[u]&&s[u].runOnce&&this.remove(t,s[u]),u+=1}else u+=1;var h=this.getBucket(e)[t],d=h?h.length:0,p=0;if(d)for(;p<d;)if(h[p]&&!h[p].skip){var v=h[p].call(e,n,r,o,i,a,l);void 0!==v&&(n=v),h[p]&&h[p].runOnce&&this.remove(t,h[p],e),p+=1}else p+=1;return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(o.objectEach)(this.getBucket(e),(function(e,t,n){return n[t].length=0}))}},{key:"register",value:function(e){this.isRegistered(e)||f.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&f.splice(f.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return p.has(e)||d.has(e)}},{key:"isRegistered",value:function(e){return f.indexOf(e)>=0}},{key:"getRegistered",value:function(){return f}}]),e}(),y=new v;t.a=v},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(163);function o(){var e;Object(r.isDefined)(console)&&(e=console).warn.apply(e,arguments)}function i(){var e;Object(r.isDefined)(console)&&(e=console).error.apply(e,arguments)}},function(e,t,n){"use strict";n.r(t),n.d(t,"isFunction",(function(){return o})),n.d(t,"throttle",(function(){return i})),n.d(t,"throttleAfterHits",(function(){return a})),n.d(t,"debounce",(function(){return l})),n.d(t,"pipe",(function(){return s})),n.d(t,"partial",(function(){return c})),n.d(t,"curry",(function(){return u})),n.d(t,"curryRight",(function(){return f}));var r=n(156);function o(e){return"function"==typeof e}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,r={lastCallThrottled:!0},o=null;function i(){for(var i=this,a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];var c=Date.now(),u=!1;r.lastCallThrottled=!0,n||(n=c,u=!0);var f=t-(c-n);return u?(r.lastCallThrottled=!1,e.apply(this,l)):(o&&clearTimeout(o),o=setTimeout((function(){r.lastCallThrottled=!1,e.apply(i,l),n=0,o=void 0}),f)),r}return i}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=i(e,t),o=n;function a(){o=n}function l(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return o?(o-=1,e.apply(this,n)):r.apply(this,n)}return l.clearHits=a,l}function l(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;function o(){for(var o=this,i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout((function(){t=e.apply(o,a)}),n),t}return o}function s(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=t[0],i=t.slice(1);return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(r.arrayReduce)(i,(function(e,t){return t(e)}),o.apply(this,t))}}function c(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.apply(this,n.concat(r))}}function u(e){var t=e.length;return function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=r.concat(i);return l.length>=t?e.apply(this,l):n(l)}}([])}function f(e){var t=e.length;return function n(r){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=r.concat(i.reverse());return l.length>=t?e.apply(this,l):n(l)}}([])}},function(e,t,n){"use strict";var r=n(156),o=n(155),i={_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e){for(var t=this,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this._localHooks[e]&&Object(r.arrayEach)(this._localHooks[e],(function(e){return e.apply(t,o)}))},clearLocalHooks:function(){return this._localHooks={},this}};Object(o.defineGetter)(i,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),t.a=i},function(e,t){},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),o=n.n(r),i=n(189),a=function(e){var t=e.state,n=e.close;return o.a.createElement(o.a.Fragment,null,t[i.b]&&o.a.createElement(i.a,{onClose:function(){return n(i.b)}}))};function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(r.useState)((function(){return e})),n=s(t,2),i=n[0],c=n[1],u=function(e){c((function(t){return Object.assign(Object.assign({},t),l({},e,!0))}))},f=function(e){c((function(t){return Object.assign(Object.assign({},t),l({},e,!1))}))},h=function(){return o.a.createElement(a,{state:i,close:f})};return{Modals:h,openModal:u,closeModal:f}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(1),o=n.n(r),i=n(311),a=function(e){var t=e.onClose,n=e.isMobile;return o.a.createElement("svg",Object.assign({viewBox:"0 0 16 16",className:"close-icon-modal",onClick:t,"data-cy":"close-modal"},n?{width:24,height:24}:{width:16,height:16}),o.a.createElement("path",{d:"M12.054 4.95l-.844-.844a.066.066 0 00-.093 0l-3 3a.066.066 0 01-.093 0l-3-3a.066.066 0 00-.093 0l-.838.844a.066.066 0 000 .093l3 3a.066.066 0 010 .093l-3 3a.066.066 0 000 .093l.844.844a.066.066 0 00.093 0l3-3a.066.066 0 01.093 0l3 3a.066.066 0 00.093 0l.844-.844a.066.066 0 000-.093l-3-3a.066.066 0 010-.093l3-3a.066.066 0 00-.006-.093z",fill:"#1d1d1d"}))},l=n(65),s="feedback",c=function(e){var t=e.onClose,n=Object(l.b)();return o.a.createElement(i.a,{open:!0,onClose:t,PaperComponent:function(){return o.a.createElement("div",{className:"modal modal-feedback","data-cy":"modal-feedback"},o.a.createElement(a,{onClose:t,isMobile:n}),o.a.createElement("p",{className:"modal-title"},"Feedback"),o.a.createElement("p",{className:"modal-description"},"Are you missing a feature?",o.a.createElement("br",null),"Do you think an existing function could be improved?"),o.a.createElement("a",{href:"https://handsoncode.typeform.com/to/LqlEyO8z",target:"_blank",rel:"noopener noreferrer",className:"sv-button ".concat(n?"mobile-feedback-button":"")},"Fill out the feedback form"))},classes:{root:"modal-feedback-background"}})}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=function(e){var t=o(Object(r.useState)(void 0),2),n=t[0],i=t[1];return Object(r.useEffect)((function(){if("string"==typeof e)return 0===e.indexOf("data:")||e.indexOf("blob:"),void i(e);var t=URL.createObjectURL(new Blob([e]));return i(t),function(){return URL.revokeObjectURL(t)}}),[e]),n}},,,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return o}));var o=function(){var e;return void 0===r&&(r="download"in document.createElement("a")&&!(null===(e=window.webkit)||void 0===e?void 0:e.messageHandlers)),r}},function(e,t,n){"use strict";(function(e){n(258),n(259),n(260),n(261);var r=n(210),o=n(220),i=n(211),a=n(212),l=n(263),s=n(268),c=n(166),u=n(215),f=n(181),h=n(216),d=n(213),p=n(156),v=n(169),y=n(198),g=n(269),m=n(176),b=n(183),w=n(163),C=n(167),O=n(155),E=n(172),S=n(197),R=n(157),T=n(178),k=n(271),j=n(170),M=n(244),A=n(238),N=n(247),_=n(168),H=n(202);function I(e,t){var n=new l.a(e,t||{},A.d);return n.init(),n}Object(s.a)(I),I.Core=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new l.a(e,t,A.d)},I.DefaultSettings=Object(M.c)(),I.EventManager=c.a,I._getListenersCounter=c.b,I._getRegisteredMapsCounter=u.b,I.packageName="handsontable",I.buildDate=e.env.HOT_BUILD_DATE,I.version=e.env.HOT_VERSION,I.hooks=f.a.getSingleton(),I.__GhostTable=h.a;var x=[p,v,y,g,m,b,w,C,O,E,S,d],L=[R,T];I.helper={},I.dom={},p.arrayEach(x,(function(e){p.arrayEach(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(I.helper[t]=e[t])}))})),p.arrayEach(L,(function(e){p.arrayEach(Object.getOwnPropertyNames(e),(function(t){"_"!==t.charAt(0)&&(I.dom[t]=e[t])}))})),I.cellTypes={},p.arrayEach(Object(a.b)(),(function(e){I.cellTypes[e]=Object(a.a)(e)})),I.cellTypes.registerCellType=a.c,I.cellTypes.getCellType=a.a,I.editors={},p.arrayEach(Object(r.c)(),(function(e){I.editors["".concat(E.toUpperCaseFirst(e),"Editor")]=Object(r.a)(e)})),I.editors.registerEditor=r.d,I.editors.getEditor=r.a,I.renderers={},p.arrayEach(Object(o.a)(),(function(e){var t=Object(o.b)(e);"base"===e&&(I.renderers.cellDecorator=t),I.renderers["".concat(E.toUpperCaseFirst(e),"Renderer")]=t})),I.renderers.registerRenderer=o.c,I.renderers.getRenderer=o.b,I.validators={},p.arrayEach(Object(i.a)(),(function(e){I.validators["".concat(E.toUpperCaseFirst(e),"Validator")]=Object(i.b)(e)})),I.validators.registerValidator=i.c,I.validators.getValidator=i.b,I.plugins={},p.arrayEach(Object.getOwnPropertyNames(k),(function(e){var t=k[e];"Base"===e?I.plugins["".concat(e,"Plugin")]=t:I.plugins[e]=t})),I.plugins.registerPlugin=j.d,I.languages={},I.languages.dictionaryKeys=_,I.languages.getLanguageDictionary=H.b,I.languages.getLanguagesDictionaries=H.c,I.languages.registerLanguageDictionary=H.e,I.languages.getTranslatedPhrase=function(){return N.a.apply(void 0,arguments)},t.a=I}).call(this,n(235))},function(e,t,n){"use strict";n.r(t),n.d(t,"KEY_CODES",(function(){return o})),n.d(t,"isPrintableChar",(function(){return i})),n.d(t,"isMetaKey",(function(){return a})),n.d(t,"isCtrlKey",(function(){return l})),n.d(t,"isCtrlMetaKey",(function(){return s})),n.d(t,"isKey",(function(){return c}));var r=n(156),o={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88};function i(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function a(e){return-1!==[o.ARROW_DOWN,o.ARROW_UP,o.ARROW_LEFT,o.ARROW_RIGHT,o.HOME,o.END,o.DELETE,o.BACKSPACE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.TAB,o.PAGE_DOWN,o.PAGE_UP,o.ENTER,o.ESCAPE,o.SHIFT,o.CAPS_LOCK,o.ALT].indexOf(e)}function l(e){var t=[];return navigator.platform.includes("Mac")?t.push(o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX):t.push(o.CONTROL),t.includes(e)}function s(e){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(e)}function c(e,t){var n=t.split("|"),i=!1;return Object(r.arrayEach)(n,(function(t){if(e===o[t])return i=!0,!1})),i}},function(e,t,n){"use strict";n.r(t),n.d(t,"spreadsheetColumnLabel",(function(){return a})),n.d(t,"spreadsheetColumnIndex",(function(){return l})),n.d(t,"createSpreadsheetData",(function(){return s})),n.d(t,"createSpreadsheetObjectData",(function(){return c})),n.d(t,"createEmptySpreadsheetData",(function(){return u})),n.d(t,"translateRowsToColumns",(function(){return f})),n.d(t,"cellMethodLookupFactory",(function(){return h})),n.d(t,"dataRowToChangesArray",(function(){return d})),n.d(t,"countFirstRowKeys",(function(){return p}));var r=n(212),o=n(155),i="ABCDEFGHIJKLMNOPQRSTUVWXYZ".length;function a(e){for(var t,n=e+1,r="";n>0;)t=(n-1)%i,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/i,10);return r}function l(e){var t=0;if(e)for(var n=0,r=e.length-1;n<e.length;n+=1,r-=1)t+=Math.pow(i,r)*("ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(e[n])+1);return t-=1}function s(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(e=0;e<n;e++){var i=[];for(t=0;t<r;t++)i.push(a(t)+(e+1));o.push(i)}return o}function c(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=[];for(e=0;e<n;e++){var i={};for(t=0;t<r;t++)i["prop".concat(t)]=a(t)+(e+1);o.push(i)}return o}function u(e,t){for(var n,r=[],o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function f(e){var t,n,r,o,i=[],a=0;for(t=0,n=e.length;t<n;t++)for(r=0,o=e[t].length;r<o;r++)r===a&&(i.push([]),a+=1),i[r].push(e[t][r]);return i}function h(e,t){var n=void 0===t||t;return function(t,i){return function t(i){if(i){if(Object(o.hasOwnProperty)(i,e)&&void 0!==i[e])return i[e];if(Object(o.hasOwnProperty)(i,"type")&&i.type){if("string"!=typeof i.type)throw new Error('Cell "type" must be a string');var a=Object(r.a)(i.type);if(Object(o.hasOwnProperty)(a,e))return a[e];if(n)return}return t(Object.getPrototypeOf(i))}}("number"==typeof t?this.getCellMeta(t,i):t)}}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e,r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach((function(e,n){Array.isArray(e)?e.forEach((function(e,o){r.push([n+t,o,e])})):Object.keys(e).forEach((function(o){r.push([n+t,o,e[o]])}))})),r}function p(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&Object(o.isObject)(e[0])&&(t=Object(o.deepObjectSize)(e[0]))),t}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),o=n.n(r),i=function(){return o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.a.createElement("rect",{className:"svg-icon",width:14,height:2,rx:.095,transform:"translate(5 3)"}),o.a.createElement("path",{className:"svg-icon",d:"M8.116 12h2.789a.1.1 0 01.095.1v8.809a.1.1 0 00.095.1h1.81a.1.1 0 00.095-.1V12.1a.1.1 0 01.095-.1h2.789a.1.1 0 00.067-.163l-3.884-3.874a.1.1 0 00-.134 0l-3.884 3.874a.1.1 0 00.067.163z"}))},a=n(173),l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},s=function(e){var t=e.renderWorkbook,n=e.mobile,r=function(e){return new Promise((function(t,n){e.name&&console.log("RECEIVED FILE: ".concat(e.name));var r=new FileReader;r.readAsArrayBuffer(e),r.addEventListener("load",(function(e){var r;(null===(r=e.target)||void 0===r?void 0:r.result)instanceof ArrayBuffer?t(e.target.result):n()}))}))},s=n?"toolbar-upload-input-mobile":"toolbar-upload-input";return o.a.createElement("label",{htmlFor:s},o.a.createElement("input",{type:"file",onChange:function(e){var n,o;(null===(n=e.target)||void 0===n?void 0:n.files)&&(o=e.target.files,l(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==o.length){e.next=2;break}return e.abrupt("return");case 2:if(null!==(n=o.item(0))){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,r(n);case 7:i=e.sent,t({type:"arraybuffer",arrayBuffer:i,fileName:n.name});case 9:case"end":return e.stop()}}),e)}))))},hidden:!0,"data-cy":s,id:s}),o.a.createElement("div",{className:"icon","data-cy":n?"toolbar-upload-button-mobile":"toolbar-upload-button"},o.a.createElement(i,null),n?o.a.createElement(a.a,{description:"Upload"}):o.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},o.a.createElement("span",null,"Upload"))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),o=n.n(r),i=function(){return o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{className:"svg-icon",d:"M447.46,404.216l0,3.4a2.286,2.286,0,0,1-2.279,2.279l-9.45-.007a1.089,1.089,0,0,0-.77.319l-2.33,2.1a.1.1,0,0,1-.169-.07V401.209a2.321,2.321,0,0,1,2.279-2.319h5.393a.1.1,0,0,0,.07-.029l1.781-1.8a.1.1,0,0,0-.07-.169h-7.174a4.327,4.327,0,0,0-4.279,4.319V414.89a1,1,0,0,0,.62.92.839.839,0,0,0,.38.08,1.007,1.007,0,0,0,.71-.29l3.919-3.688a.1.1,0,0,1,.07-.029l9.119.007a4.185,4.185,0,0,0,4.18-4.18l0-5.3a.1.1,0,0,0-.169-.07l-1.8,1.8A.1.1,0,0,0,447.46,404.216Z",transform:"translate(-427.46 -393.89)"}),o.a.createElement("path",{className:"svg-icon",d:"M466.282,397.81a3.005,3.005,0,0,0-4.249,0l-6.578,6.578a1,1,0,0,0-.293.707v2.835a1,1,0,0,0,1,1H459a1,1,0,0,0,.707-.293l6.578-6.578A3.005,3.005,0,0,0,466.282,397.81Zm-1.414,1.414.006.007a1,1,0,0,1-.006,1.414l0,0-1.421-1.42,0,0A1.008,1.008,0,0,1,464.868,399.224Zm-6.285,7.706h-1.421v-1.421l4.868-4.868,1.421,1.42Z",transform:"translate(-445.162 -394.93)"}))},a=n(173),l=n(189),s=o.a.forwardRef((function(e,t){var n=e.open,r=e.mobile,s=void 0!==r&&r;return o.a.createElement("button",{type:"button",className:"icon",id:"feedback-icon",onClick:function(){return n(l.b)},"data-cy":s?"toolbar-feedback-button-mobile":"toolbar-feedback-button",ref:t},o.a.createElement(i,null),s?o.a.createElement(a.a,{description:"Feedback"}):o.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},o.a.createElement("span",null,"Feedback")))}))},function(e,t,n){"use strict";n.d(t,"e",(function(){return y})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return u}));var r,o=n(155),i=n(239),a=n(174),l=n(168);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */var c=(s(r={languageCode:"en-US"},l.CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),s(r,l.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),s(r,l.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),s(r,l.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),s(r,l.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),s(r,l.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),s(r,l.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),s(r,l.CONTEXTMENU_ITEMS_UNDO,"Undo"),s(r,l.CONTEXTMENU_ITEMS_REDO,"Redo"),s(r,l.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),s(r,l.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),s(r,l.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),s(r,l.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),s(r,l.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),s(r,l.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),s(r,l.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),s(r,l.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),s(r,l.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),s(r,l.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),s(r,l.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),s(r,l.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),s(r,l.CONTEXTMENU_ITEMS_BORDERS,"Borders"),s(r,l.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),s(r,l.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),s(r,l.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),s(r,l.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),s(r,l.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),s(r,l.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),s(r,l.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),s(r,l.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),s(r,l.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),s(r,l.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),s(r,l.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),s(r,l.CONTEXTMENU_ITEMS_COPY,"Copy"),s(r,l.CONTEXTMENU_ITEMS_CUT,"Cut"),s(r,l.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),s(r,l.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),s(r,l.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),s(r,l.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),s(r,l.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),s(r,l.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),s(r,l.FILTERS_CONDITIONS_NONE,"None"),s(r,l.FILTERS_CONDITIONS_EMPTY,"Is empty"),s(r,l.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),s(r,l.FILTERS_CONDITIONS_EQUAL,"Is equal to"),s(r,l.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),s(r,l.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),s(r,l.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),s(r,l.FILTERS_CONDITIONS_CONTAINS,"Contains"),s(r,l.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),s(r,l.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),s(r,l.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),s(r,l.FILTERS_CONDITIONS_LESS_THAN,"Less than"),s(r,l.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),s(r,l.FILTERS_CONDITIONS_BETWEEN,"Is between"),s(r,l.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),s(r,l.FILTERS_CONDITIONS_AFTER,"After"),s(r,l.FILTERS_CONDITIONS_BEFORE,"Before"),s(r,l.FILTERS_CONDITIONS_TODAY,"Today"),s(r,l.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),s(r,l.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),s(r,l.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),s(r,l.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),s(r,l.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),s(r,l.FILTERS_LABELS_CONJUNCTION,"And"),s(r,l.FILTERS_LABELS_DISJUNCTION,"Or"),s(r,l.FILTERS_BUTTONS_SELECT_ALL,"Select all"),s(r,l.FILTERS_BUTTONS_CLEAR,"Clear"),s(r,l.FILTERS_BUTTONS_OK,"OK"),s(r,l.FILTERS_BUTTONS_CANCEL,"Cancel"),s(r,l.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),s(r,l.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),s(r,l.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),r),u=c.languageCode,f=Object(a.a)("languagesDictionaries"),h=f.register,d=f.getItem,p=f.hasItem,v=f.getValues;function y(e,t){var n=e,r=t;return Object(o.isObject)(e)&&(n=(r=e).languageCode),function(e,t){e!==u&&Object(i.a)(t,d(u))}(n,r),h(n,Object(o.deepClone)(r)),Object(o.deepClone)(r)}function g(e){return m(e)?Object(o.deepClone)(d(e)):null}function m(e){return p(e)}function b(){return v()}y(c)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));new Map([["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx"],["application/vnd.ms-excel","xls"],["application/vnd.openxmlformats-officedocument.spreadsheetml.template","xltx"],["application/vnd.ms-excel.sheet.macroenabled.12","xlsm"],["application/vnd.ms-excel.template.macroenabled.12","xltm"],["application/vnd.ms-excel.addin.macroenabled.12","xlam"],["application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsb"],["application/vnd.oasis.opendocument.spreadsheet","ods"],["application/x-iwork-numbers-sffnumbers","numbers"],["application/vnd.apple.numbers","numbers"]]);var r=function(e){return void 0!==e.fileName||"arraybuffer"===e.type?e.fileName:function(e){if(!e.startsWith("data:")){var t=e.split("/").pop();if(void 0!==t&&0!==t.length)return t}}(e.url)},o="Unnamed file"},function(e,t,n){"use strict";var r=n(185);n.o(r,"useModals")&&n.d(t,"useModals",(function(){return r.useModals}));var o=n(188);n.d(t,"useModals",(function(){return o.a}))},,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return u}));var r=n(174),o=n(181),i=new WeakMap,a=Object(r.a)("editors"),l=a.register,s=a.getItem,c=a.hasItem,u=a.getNames;a.getValues;function f(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},o.a.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function h(e,t){var n;if("function"==typeof e)i.get(e)||p(null,e),n=i.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=s(e)}if(!n)throw Error('No editor registered under name "'.concat(e,'"'));return n.getInstance(t)}function d(e){if(!c(e))throw Error('No registered editor found under "'.concat(e,'" name'));return s(e).getConstructor()}function p(e,t){var n=new f(t);"string"==typeof e&&l(e,n),i.set(t,n)}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(174),o=Object(r.a)("validators"),i=o.register,a=o.getItem,l=o.hasItem,s=o.getNames;o.getValues;function c(e){if("function"==typeof e)return e;if(!l(e))throw Error('No registered validator found under "'.concat(e,'" name'));return a(e)}},function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f}));var r=n(174),o=n(210),i=n(220),a=n(211),l=Object(r.a)("cellTypes"),s=l.register,c=l.getItem,u=l.hasItem,f=l.getNames;l.getValues;function h(e){if(!u(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method'));return c(e)}function d(e,t){var n=t.editor,r=t.renderer,l=t.validator;n&&Object(o.d)(e,n),r&&Object(i.c)(e,r),l&&Object(a.c)(e,l),s(e,t)}},function(e,t,n){"use strict";n.r(t),n.d(t,"instanceToHTML",(function(){return u})),n.d(t,"_dataToHTML",(function(){return f})),n.d(t,"htmlToGridSettings",(function(){return h}));var r=n(157),o=n(163);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},s=new RegExp(Object.keys(l).map((function(e){return"(".concat(e,")")})).join("|"),"gi");function c(e){return"TABLE"===(e&&e.nodeName||"")}function u(e){for(var t=e.hasColHeaders(),n=e.hasRowHeaders(),r=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData.apply(e,r),a=i.length,l=a>0?i[0].length:0,s=["<table>","</table>"],c=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],f=n?1:0,h=t?1:0,d=0;d<a;d+=1){for(var p=t&&0===d,v=[],y=0;y<l;y+=1){var g=!p&&n&&0===y,m="";if(p)m="<th>".concat(e.getColHeader(y-f),"</th>");else if(g)m="<th>".concat(e.getRowHeader(d-h),"</th>");else{var b=i[d][y],w=e.getCellMeta(d-f,y-h),C=w.hidden,O=w.rowspan,E=w.colspan;if(!C){var S=[];if(O&&S.push('rowspan="'.concat(O,'"')),E&&S.push('colspan="'.concat(E,'"')),Object(o.isEmpty)(b))m="<td ".concat(S.join(" "),"></td>");else{var R=b.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");m="<td ".concat(S.join(" "),">").concat(R,"</td>")}}}v.push(m)}var T=["<tr>"].concat(v,["</tr>"]).join("");p?c.splice(1,0,T):u.splice(-1,0,T)}return s.splice(1,0,c.join(""),u.join("")),s.join("")}function f(e){for(var t=e.length,n=["<table>"],r=0;r<t;r+=1){var i=e[r],a=i.length,l=[];0===r&&n.push("<tbody>");for(var s=0;s<a;s+=1){var c=i[s],u=Object(o.isEmpty)(c)?"":c.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");l.push("<td>".concat(u,"</td>"))}n.push.apply(n,["<tr>"].concat(l,["</tr>"])),r+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n={},o=t.createDocumentFragment(),a=t.createElement("div");o.appendChild(a);var u=e;if("string"==typeof u){var f=u.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(e){var t=e.match(/<td\b[^>]*?>/g)[0],n=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(t).concat(n).concat("</td>")}));a.insertAdjacentHTML("afterbegin","".concat(f)),u=a.querySelector("table")}if(u&&c(u)){var h=a.querySelector("style"),d=null,p=[];h&&(t.body.appendChild(h),h.disabled=!0,d=h.sheet,p=d?Array.from(d.cssRules):[],t.body.removeChild(h));var v=a.querySelector('meta[name$="enerator"]'),y=null!==u.querySelector("tbody th"),g=Array.from(u.querySelector("tr").cells).reduce((function(e,t){return e+t.colSpan}),0)-(y?1:0),m=u.tFoot&&Array.from(u.tFoot.rows)||[],b=[],w=!1,C=0,O=0;if(u.tHead){var E=Array.from(u.tHead.rows).filter((function(e){var t=null!==e.querySelector("td");return t&&b.push(e),!t}));w=(C=E.length)>0,C>1?n.nestedHeaders=Array.from(E).reduce((function(e,t){var n=Array.from(t.cells).reduce((function(e,t,n){if(y&&0===n)return e;var r=t.colSpan,o=t.innerHTML,i=r>1?{label:o,colspan:r}:o;return e.push(i),e}),[]);return e.push(n),e}),[]):w&&(n.colHeaders=Array.from(E[0].children).reduce((function(e,t,n){return y&&0===n||e.push(t.innerHTML),e}),[]))}b.length&&(n.fixedRowsTop=b.length),m.length&&(n.fixedRowsBottom=m.length);var S=[].concat(b,i(Array.from(u.tBodies).reduce((function(e,t){return e.push.apply(e,i(Array.from(t.rows))),e}),[])),i(m));O=S.length;for(var R=new Array(O),T=0;T<O;T++)R[T]=new Array(g);for(var k=[],j=[],M=0;M<O;M++)for(var A=S[M],N=Array.from(A.cells),_=N.length,H=function(e){var t=N[e],n=t.nodeName,o=t.innerHTML,i=t.rowSpan,a=t.colSpan,c=R[M].findIndex((function(e){return void 0===e}));if("TD"===n){if(i>1||a>1){for(var u=M;u<M+i;u++)if(u<O)for(var f=c;f<c+a;f++)R[u][f]=null;var h=t.getAttribute("style");h&&h.includes("mso-ignore:colspan")||k.push({col:c,row:M,rowspan:i,colspan:a})}var d="";d="nowrap"===p.reduce((function(e,n){if(Object(r.matchesCSSRules)(t,n)){var o=n.style.whiteSpace;o&&(e.whiteSpace=o)}return e}),{}).whiteSpace?o.replace(/[\r\n][\x20]{0,2}/gim," ").replace(/<br(\s*|\/)>/gim,"\r\n"):v&&/excel/gi.test(v.content)?o.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):o.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),R[M][c]=d.replace(s,(function(e){return l[e]}))}else j.push(o)},I=0;I<_;I++)H(I);return k.length&&(n.mergeCells=k),j.length&&(n.rowHeaders=j),R.length&&(n.data=R),n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(178),o=n(161);function i(e){var t=e.isShiftKey,n=e.isLeftClick,r=e.isRightClick,i=e.coords,a=e.selection,l=e.controller,s=a.isSelected()?a.getSelectedRange().current():null,c=a.isSelectedByCorner(),u=a.isSelectedByRowHeader();if(t&&s)i.row>=0&&i.col>=0&&!l.cells?a.setRangeEnd(i):(c||u)&&i.row>=0&&i.col>=0&&!l.cells?a.setRangeEnd(new o.a(i.row,i.col)):c&&i.row<0&&!l.column?a.setRangeEnd(new o.a(s.to.row,i.col)):u&&i.col<0&&!l.row?a.setRangeEnd(new o.a(i.row,s.to.col)):(!c&&!u&&i.col<0||c&&i.col<0)&&!l.row?a.selectRows(s.from.row,i.row):(!c&&!u&&i.row<0||u&&i.row<0)&&!l.column&&a.selectColumns(s.from.col,i.col);else{var f=new o.a(i.row,i.col);f.row<0&&(f.row=0),f.col<0&&(f.col=0);var h=!a.inInSelection(f),d=n||r&&h;i.row<0&&i.col>=0&&!l.column?d&&a.selectColumns(i.col):i.col<0&&i.row>=0&&!l.row?d&&a.selectRows(i.row):i.col>=0&&i.row>=0&&!l.cells?d&&a.setRangeStart(i):i.col<0&&i.row<0&&a.selectAll()}}var a=new Map([["mousedown",i],["mouseover",function(e){var t=e.isLeftClick,n=e.coords,r=e.selection,i=e.controller;if(t){var a=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),s=r.tableProps.countCols(),c=r.tableProps.countRows();l&&!i.column?r.setRangeEnd(new o.a(c-1,n.col)):a&&!i.row?r.setRangeEnd(new o.a(n.row,s-1)):i.cell||r.setRangeEnd(n)}}],["touchstart",i]]);function l(e,t){var n=t.coords,o=t.selection,i=t.controller;a.get(e.type)({coords:n,selection:o,controller:i,isShiftKey:e.shiftKey,isLeftClick:Object(r.isLeftClick)(e)||"touchstart"===e.type,isRightClick:Object(r.isRightClick)(e)})}},function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(163),o=n(155),i=n(184);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=0,s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.collection=new Map}var t,n,o;return t=e,(n=[{key:"register",value:function(e,t){var n=this;!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(function(){return n.runLocalHooks("change",t)})),l+=1)}},{key:"unregister",value:function(e){var t=this.collection.get(e);Object(r.isDefined)(t)&&(t.clearLocalHooks(),this.collection.delete(e),this.runLocalHooks("change",t),l-=1)}},{key:"get",value:function(e){return Object(r.isUndefined)(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach((function(t){t.remove(e)}))}},{key:"insertToEvery",value:function(e,t){this.collection.forEach((function(n){n.insert(e,t)}))}},{key:"initEvery",value:function(e){this.collection.forEach((function(t){t.init(e)}))}}])&&a(t.prototype,n),o&&a(t,o),e}();function c(){return l}Object(o.mixin)(s,i.a),t.a=s},function(e,t,n){"use strict";var r=n(157),o=n(156),i=n(177);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}var t,n,l;return t=e,(n=[{key:"addRow",value:function(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){var t=this.hot.getColHeader(0);if(null!=t){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),n.table=this.table.table,Object(r.removeClass)(this.table.tBody,"afterEmptyThead")}else Object(r.addClass)(this.table.tBody,"afterEmptyThead")}},{key:"addColumn",value:function(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),Object(o.arrayEach)(this.rows,(function(t){e(t.row,Object(r.outerHeight)(t.table)-i.a)}))}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),Object(o.arrayEach)(this.columns,(function(t){var n=t.table.getBoundingClientRect().width,r=Math.ceil(n);e(t.col,r)}))}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,t){this.settings||(this.settings={}),this.settings[e]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1)),this.samples.forEach((function(n){Object(o.arrayEach)(n.strings,(function(n){t.appendChild(e.createColElement(n.col))}))})),t}},{key:"createRow",value:function(e){var t=this,n=this.hot.rootDocument,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach((function(i){Object(o.arrayEach)(i.strings,(function(o){var i=o.col,a=t.hot.getCellMeta(e,i);a.col=i,a.row=e;var l=t.hot.getCellRenderer(a),s=n.createElement("td");s.setAttribute("ghost-table",1),l(t.hot,s,e,i,t.hot.colToProp(i),o.value,a),r.appendChild(s)}))})),r}},{key:"createColumnHeadersRow",value:function(){var e=this,t=this.hot.rootDocument,n=t.createDocumentFragment();if(this.hot.hasRowHeaders()){var r=t.createElement("th");this.hot.view.appendColHeader(-1,r),n.appendChild(r)}return this.samples.forEach((function(r){Object(o.arrayEach)(r.strings,(function(r){var o=r.col,i=t.createElement("th");e.hot.view.appendColHeader(o,i),n.appendChild(i)}))})),n}},{key:"createCol",value:function(e){var t=this,n=this.hot.rootDocument,r=n.createDocumentFragment();return this.samples.forEach((function(i){Object(o.arrayEach)(i.strings,(function(o){var i=o.row,a=t.hot.getCellMeta(i,e);a.col=e,a.row=i;var l=t.hot.getCellRenderer(a),s=n.createElement("td"),c=n.createElement("tr");s.setAttribute("ghost-table",1),l(t.hot,s,i,e,t.hot.colToProp(e),o.value,a),c.appendChild(s),r.appendChild(c)}))})),r}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var t=this.hot.rootDocument.createElement("col");return t.style.width="".concat(this.hot.view.wt.columnUtils.getStretchedColumnWidth(e),"px"),t}},{key:"createTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),o=t.createElement("table"),i=t.createElement("thead"),a=t.createElement("tbody"),l=t.createElement("colgroup"),s=t.createElement("tr"),c=t.createElement("th");return this.isVertical()&&o.appendChild(l),this.isHorizontal()&&(s.appendChild(c),i.appendChild(s),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&a.appendChild(s),Object(r.addClass)(a,"afterEmptyThead"),o.appendChild(a),Object(r.addClass)(o,e),n.appendChild(o),{fragment:n,table:o,tHead:i,tBody:a,colGroup:l,tr:s,th:c}}},{key:"createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.hot.rootDocument,n=t.createDocumentFragment(),o=t.createElement("div"),i="htGhostTable htAutoSize ".concat(e.trim());return Object(r.addClass)(o,i),n.appendChild(o),{fragment:n,container:o}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}])&&a(t.prototype,n),l&&a(t,l),e}();t.a=l},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return l}));var r=0,o=function(){1===(r+=1)&&delete document.body.dataset.embedsLoaded},i=function(){0===(r=Math.max(r-1,0))&&setTimeout((function(){document.body.dataset.embedsLoaded=""}),0)},a=function(){r=0,o()},l=function(){i()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return he})),n.d(t,"b",(function(){return L}));var r=n(156);function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n){return[].concat(o(e.slice(0,t)),o(n),o(e.slice(t)))}function l(e,t){return Object(r.arrayFilter)(e,(function(e){return!1===t.includes(e)}))}var s=n(167),c=n(155),u=n(183),f=n(184);function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;h(this,e),this.indexedValues=[],this.initValueOrFn=t}var t,n,r;return t=e,(n=[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var t=this.getValues();if(e<t.length)return t[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,t){return e<this.getLength()&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Object(u.isFunction)(this.initValueOrFn)?Object(s.rangeEach)(t-1,(function(t){return e.indexedValues.push(e.initValueOrFn(t))})):Object(s.rangeEach)(t-1,(function(){return e.indexedValues.push(e.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}}])&&d(t.prototype,n),r&&d(t,r),e}();Object(c.mixin)(p,f.a);var v=p;function y(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t,n,r){var o=n[0];return[].concat(y(e.slice(0,o)),y(n.map((function(e,t){return Object(u.isFunction)(r)?r(e,t):r}))),y(e.slice(o)))}function b(e,t){return Object(r.arrayFilter)(e,(function(e,n){return!1===t.includes(n)}))}new Map([["indexesSequence",{getListWithInsertedItems:a,getListWithRemovedItems:l}],["physicallyIndexed",{getListWithInsertedItems:m,getListWithRemovedItems:b}]]);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t,n){return(O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=T(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=T(e);if(t){var o=T(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R(this,n)}}function R(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(s,e);var t,n,o,i=S(s);function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),i.call(this,(function(e){return e}))}return t=s,(n=[{key:"insert",value:function(e,t){var n=function(e,t,n){var o=n[0],i=n.length;return Object(r.arrayMap)(e,(function(e){return e>=o?e+i:e}))}(this.indexedValues,0,t);this.indexedValues=a(n,e,t),O(T(s.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=l(this.indexedValues,e);this.indexedValues=function(e,t){return Object(r.arrayMap)(e,(function(e){return e-t.filter((function(t){return t<e})).length}))}(t,e),O(T(s.prototype),"remove",this).call(this,e)}}])&&C(t.prototype,n),o&&C(t,o),s}(v);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t,n){return(N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=x(e);if(t){var o=x(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return I(this,n)}}function I(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(i,e);var t,n,r,o=H(i);function i(){return M(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"insert",value:function(e,t){this.indexedValues=m(this.indexedValues,0,t,this.initValueOrFn),N(x(i.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=b(this.indexedValues,e),N(x(i.prototype),"remove",this).call(this,e)}}])&&A(t.prototype,n),r&&A(t,r),i}(v);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=U(e);if(t){var o=U(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return W(this,n)}}function W(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(a,e);var t,n,o,i=V(a);function a(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return D(this,a),i.call(this,e)}return t=a,(n=[{key:"getTrimmedIndexes",value:function(){return Object(r.arrayReduce)(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}])&&B(t.prototype,n),o&&B(t,o),a}(L);function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Q(e);if(t){var o=Q(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $(this,n)}}function $(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(a,e);var t,n,o,i=q(a);function a(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return X(this,a),i.call(this,e)}return t=a,(n=[{key:"getHiddenIndexes",value:function(){return Object(r.arrayReduce)(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}])&&K(t.prototype,n),o&&K(t,o),a}(L),J=n(215),ee=n(163);function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ae(e);if(t){var o=ae(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ie(this,n)}}function ie(e,t){return!t||"object"!==te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(a,e);var t,n,o,i=oe(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this)).mergedValuesCache=[],n.aggregationFunction=e,n.fallbackValue=t,n}return t=a,(n=[{key:"getMergedValues",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.mergedValuesCache;if(0===this.getLength())return[];for(var t=Object(r.arrayMap)(this.get(),(function(e){return e.getValues()})),n=[],o=Object(ee.isDefined)(t[0])&&t[0].length||0,i=0;i<o;i+=1){for(var a=[],l=0;l<this.getLength();l+=1)a.push(t[l][i]);n.push(a)}return Object(r.arrayMap)(n,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(e,t){var n=this.getMergedValues(t)[e];return Object(ee.isDefined)(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}])&&ne(t.prototype,n),o&&ne(t,o),a}(J.a);function se(e){return function(e){if(Array.isArray(e))return ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ce(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fe=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexesSequence=new k,this.trimmingMapsCollection=new le((function(e){return e.some((function(e){return!0===e}))}),!1),this.hidingMapsCollection=new le((function(e){return e.some((function(e){return!0===e}))}),!1),this.variousMapsCollection=new J.a,this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("change",t.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(e){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(e){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(e){t.runLocalHooks("change",e,t.variousMapsCollection)}))}var t,n,o;return t=e,(n=[{key:"executeBatchOperations",value:function(e){var t=this.isBatched;this.isBatched=!0,e(),this.isBatched=t,this.updateCache()}},{key:"registerMap",value:function(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof z?this.trimmingMapsCollection.register(e,t):t instanceof Z?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);var n=this.getNumberOfIndexes();return n>0&&t.init(n),t}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"getPhysicalFromVisualIndex",value:function(e){var t=this.notTrimmedIndexesCache[e];return Object(ee.isDefined)(t)?t:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var t=this.renderablePhysicalIndexesCache[e];return Object(ee.isDefined)(t)?t:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var t=this.fromPhysicalToVisualIndexesCache.get(e);return Object(ee.isDefined)(t)?t:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var t=this.fromVisualToRenderableIndexesCache.get(e);return Object(ee.isDefined)(t)?t:null}},{key:"getFirstNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e-t,o=this.getPhysicalFromVisualIndex(e);return null===o?!0===n&&r!==e-t?this.getFirstNotHiddenIndex(r,-t,!1,r):null:!1===this.isHidden(o)?e:this.getFirstNotHiddenIndex(e+t,t,n,r)}},{key:"initToLength",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=se(new Array(t).keys()),this.notHiddenIndexesCache=se(new Array(t).keys()),this.executeBatchOperations((function(){e.indexesSequence.init(t),e.trimmingMapsCollection.initEvery(t)})),this.executeBatchOperations((function(){e.hidingMapsCollection.initEvery(t),e.variousMapsCollection.initEvery(t)})),this.runLocalHooks("init")}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesSequence.setValues(e)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return!0===t?this.notTrimmedIndexesCache:Object(r.arrayFilter)(this.getIndexesSequence(),(function(t){return!1===e.isTrimmed(t)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return!0===t?this.notHiddenIndexesCache:Object(r.arrayFilter)(this.getIndexesSequence(),(function(t){return!1===e.isHidden(t)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e)return this.renderablePhysicalIndexesCache;var t=this.getNotTrimmedIndexes(),n=this.getNotHiddenIndexes();return t.filter((function(e){return n.includes(e)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,t){var n=this;"number"==typeof e&&(e=[e]);var o=Object(r.arrayMap)(e,(function(e){return n.getPhysicalFromVisualIndex(e)})),i=this.getNotTrimmedIndexesLength(),s=e.length,c=l(this.getIndexesSequence(),o),u=i-s;if(t+s<i){var f=c.filter((function(e){return!1===n.isTrimmed(e)}))[t];u=c.indexOf(f)}this.setIndexesSequence(a(c,u,o))}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,t){var n=this,o=this.getNotTrimmedIndexes()[e],i=Object(ee.isDefined)(o)?o:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(o)?this.getIndexesSequence().indexOf(o):this.getNumberOfIndexes(),l=Object(r.arrayMap)(new Array(t).fill(i),(function(e,t){return e+t}));this.executeBatchOperations((function(){n.indexesSequence.insert(a,l),n.trimmingMapsCollection.insertToEvery(a,l),n.hidingMapsCollection.insertToEvery(a,l),n.variousMapsCollection.insertToEvery(a,l)}))}},{key:"removeIndexes",value:function(e){var t=this;this.executeBatchOperations((function(){t.indexesSequence.remove(e),t.trimmingMapsCollection.removeFromEvery(e),t.hidingMapsCollection.removeFromEvery(e),t.variousMapsCollection.removeFromEvery(e)}))}},{key:"updateCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderabIendexes(),this.runLocalHooks("cacheUpdated",this.indexesSequenceChanged,this.trimmedIndexesChanged,this.hiddenIndexesChanged),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.notTrimmedIndexesCache,t=this.getIndexesSequence(),n=t.length;this.fromPhysicalToVisualIndexesCache.clear();for(var r=0;r<n;r+=1){var o=t[r],i=e.indexOf(o);-1!==i&&this.fromPhysicalToVisualIndexesCache.set(o,i)}}},{key:"cacheFromVisualToRenderabIendexes",value:function(){var e=this,t=this.notTrimmedIndexesCache,n=t.length,r=t.map((function(t){return e.isHidden(t)}));this.fromVisualToRenderableIndexesCache.clear();for(var o=0,i=0;i<n;i+=1)if(r[i])o+=1;else{var a=i-o;this.fromVisualToRenderableIndexesCache.set(i,a)}}}])&&ue(t.prototype,n),o&&ue(t,o),e}();Object(c.mixin)(fe,f.a);var he=fe},function(e,t,n){"use strict";n.d(t,"c",(function(){return w})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return E}));var r=n(1),o=n.n(r),i=function(){return o.a.createElement("svg",{viewBox:"0 0 18 18"},o.a.createElement("defs",null,o.a.createElement("linearGradient",{id:"sv_svg__b",x1:"1",x2:"0",y2:"1",gradientUnits:"objectBoundingBox"},o.a.createElement("stop",{offset:"0",stopColor:"#0443c1"}),o.a.createElement("stop",{offset:"1",stopColor:"#c2c8f0"})),o.a.createElement("clipPath",{id:"sv_svg__a"}," ",o.a.createElement("path",{d:"M2 0h14a2 2 0 012 2v14a2 2 0 01-2 2H2a2 2 0 01-2-2V2a2 2 0 012-2z",fill:"#0f9d58"}))),o.a.createElement("g",{clipPath:"url(#sv_svg__a)"},o.a.createElement("path",{transform:"rotate(90 9 9)",fill:"url(#sv_svg__b)",d:"M0 0h18v18H0z"}),o.a.createElement("path",{d:"M0 0l9-9 6 6-9 9z",fill:"#c2c8f0"}),o.a.createElement("path",{d:"M-9 9l9-9 6 6-9 9z",fill:"#98a5e6"}),o.a.createElement("path",{d:"M6 6l9-9 6 6-9 9z",fill:"#6c82dc"}),o.a.createElement("path",{d:"M-3 15l9-9 6 6-9 9z",fill:"#4767d4"}),o.a.createElement("path",{d:"M12 12l9-9 6 6-9 9z",fill:"#104acc"}),o.a.createElement("path",{d:"M3 21l9-9 6 6-9 9z",fill:"#0443c1"})))},a=n(200),l=function(){return o.a.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 24 24"},o.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.a.createElement("rect",{className:"svg-icon",width:14,height:2,rx:.099,transform:"translate(5 19)"}),o.a.createElement("path",{className:"svg-icon",d:"M8.124 12h2.777a.1.1 0 00.1-.1V3.1a.1.1 0 01.1-.1h1.8a.1.1 0 01.1.1v8.8a.1.1 0 00.1.1h2.778a.1.1 0 01.069.168l-3.876 3.866a.1.1 0 01-.139 0l-3.876-3.866A.1.1 0 018.124 12z"}))},s=n(191),c=n(173),u=n(195),f=function(e){var t=e.workbookLocation,n=e.fileName,r=e.mobile,i=Object(s.a)(t);if(!Object(u.a)())return null;var a=i?"download-anchor":void 0,f=a&&r?"download-anchor-mobile":a;return o.a.createElement("button",{type:"button",className:"icon",id:"download-icon"},o.a.createElement("a",{href:i,download:n,"data-cy":f},o.a.createElement(l,null),r&&o.a.createElement(c.a,{description:"Download"})),!r&&o.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},o.a.createElement("span",null,"Download")))},h=n(201),d=function(e){return o.a.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 24 24"},e),o.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.a.createElement("path",{d:"M14.25 6.007a2.007 2.007 0 10-2.007 2.007 2.007 2.007 0 002.007-2.007zm0 6.074a2.007 2.007 0 10-2.007 2.007 2.007 2.007 0 002.007-2.007zm0 6.074a2.007 2.007 0 10-2.007 2.007 2.007 2.007 0 002.007-2.007z",fill:"#fff"}))},p=n(309),v=function(e){var t=e.children;return o.a.createElement(p.a,Object.assign({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},PaperProps:{style:{maxHeight:192,width:200}},classes:{paper:"toolbar-mobile-menu-wrapper",list:"toolbar-mobile-menu-list"}},e),t)};function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){var t=e.children,n=y(o.a.useState(void 0),2),r=n[0],i=n[1];return o.a.createElement("button",{type:"button",className:"icon icon-mobile","data-cy":"mobile-menu-icon"},o.a.createElement(d,{onClick:function(e){i(e.currentTarget)}}),o.a.createElement(v,{anchorEl:r,keepMounted:!0,open:Boolean(r),onClose:function(){i(void 0)}},t))},b=n(65),w=function(e){var t=e.children;return o.a.createElement("div",{className:"toolbar"},t)},C=function(e){var t=e.children,n=e.fileName;return o.a.createElement("div",{className:"toolbar-left-pane"},o.a.createElement("div",{className:"icon",id:"sv-icon"},t),o.a.createElement("p",{className:"file-title"},n))},O=function(e){var t=e.children;return o.a.createElement("div",{className:"toolbar-right-pane"},o.a.createElement("div",{className:"icons-wrapper"},t))},E=function(e){var t=e.fileName,n=e.workbookLocation,r=e.renderWorkbook,l=e.openModal,s=Object(b.b)();return o.a.createElement(w,null,o.a.createElement(C,{fileName:t},o.a.createElement(i,null)),o.a.createElement(O,null,s?o.a.createElement(m,null,o.a.createElement(h.a,{open:l,mobile:!0}),o.a.createElement(a.a,{renderWorkbook:r,mobile:!0}),o.a.createElement(f,{workbookLocation:n,fileName:t,mobile:!0})):o.a.createElement(o.a.Fragment,null,o.a.createElement(a.a,{renderWorkbook:r}),o.a.createElement(f,{workbookLocation:n,fileName:t}),o.a.createElement(h.a,{open:l}))))}},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return h}));var r=n(174),o=n(157);var i=function(e,t,n,r,i,a,l){var s=[],c=[];l.className&&Object(o.addClass)(t,l.className),l.readOnly&&s.push(l.readOnlyCellClassName),!1===l.valid&&l.invalidCellClassName?s.push(l.invalidCellClassName):c.push(l.invalidCellClassName),!1===l.wordWrap&&l.noWordWrapClassName&&s.push(l.noWordWrapClassName),!a&&l.placeholder&&s.push(l.placeholderCellClassName),Object(o.removeClass)(t,c),Object(o.addClass)(t,s)},a=n(163);var l=function(e,t,n,r,i,l,s){d("base").apply(this,[e,t,n,r,i,l,s]);var c=l;if(!c&&s.placeholder&&(c=s.placeholder),c=Object(a.stringify)(c),e.getSettings().trimWhitespace||e.getSettings().wordWrap||(c=c.replace(/ /g,String.fromCharCode(160))),s.rendererTemplate){Object(o.empty)(t);var u=e.rootDocument.createElement("TEMPLATE");u.setAttribute("bind","{{}}"),u.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(u),u.model=e.getSourceDataAtRow(n),t.appendChild(u)}else Object(o.fastInnerText)(t,c)},s=Object(r.a)("renderers"),c=s.register,u=s.getItem,f=s.hasItem,h=s.getNames;s.getValues;function d(e){if("function"==typeof e)return e;if(!f(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return u(e)}c("base",i),c("text",l)},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return l}));var r=new WeakMap,o=Symbol("rootInstance");function i(e){r.set(e,!0)}function a(e){return e===o}function l(e){return r.has(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return h}));var r=n(163),o=n(155),i=n(182),a=n(175),l=n(202);function s(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.']);return s=function(){return e},e}function c(e,t){return Object(o.objectEach)(t,(function(t,n){Object(r.isUndefined)(e[n])&&(e[n]=t)})),e}function u(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?"".concat(t[1].toLowerCase(),"-").concat(t[2].toUpperCase()):e}function f(e){var t=u(e);return Object(l.d)(t)||(t=l.a,h(e)),t}function h(e){Object(r.isDefined)(e)&&Object(i.a)(Object(a.a)(s(),e))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(166),o=n(197),i=new r.a,a=new Set,l=0;function s(e){0===l&&(i.addEventListener(e,"keydown",(function(e){a.has(e.keyCode)||a.add(e.keyCode)})),i.addEventListener(e,"keyup",(function(e){a.has(e.keyCode)&&a.delete(e.keyCode)})),i.addEventListener(e,"visibilitychange",(function(){e.hidden&&a.clear()})),i.addEventListener(e.defaultView,"blur",(function(){a.clear()}))),l+=1}function c(){l>0&&(l-=1),0===l&&(i.clearEvents(),a.clear(),l=0)}function u(){return Array.from(a.values()).some((function(e){return Object(o.isCtrlMetaKey)(e)}))}},function(e,t,n){var r,o,i,a,l;window,r=/^(\r\n|\n\r|\r|\n)/,o=/^[^\t\r\n]+/,i=/^\t/,a=function(e){var t=[[""]];if(0===e.length)return t;for(var n,a=0,l=0;e.length>0&&n!==e.length;)if(n=e.length,e.match(i))e=e.replace(i,""),a+=1,t[l][a]="";else if(e.match(r))e=e.replace(r,""),a=0,t[l+=1]=[""];else{var s="";if(e.startsWith('"')){for(var c=0,u=!0;u;){var f=e.slice(0,1);'"'===f&&(c+=1),s+=f,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&c%2==0)&&(u=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(e){return new Array(Math.floor(e.length/2)).fill('"').join("")}))}else{var h=e.match(o);s=h?h[0]:"",e=e.slice(s.length)}t[l][a]=s}return t},l=function(e){var t,n,r,o,i,a="";for(t=0,n=e.length;t<n;t+=1){for(o=e[t].length,r=0;r<o;r+=1)r>0&&(a+="\t"),"string"==typeof(i=e[t][r])?i.indexOf("\n")>-1?a+='"'.concat(i.replace(/"/g,'""'),'"'):a+=i:a+=null==i?"":i;t!==n-1&&(a+="\n")}return a},t.parse=a,t.stringify=l},,function(e,t,n){"use strict";n.d(t,"a",(function(){return he})),n.d(t,"b",(function(){return re})),n.d(t,"c",(function(){return oe}));var r=n(174),o=n(161);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f(this,n)}}function f(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(f,e);var t,n,r,i=u(f);function f(){var e;a(this,f);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=i.call.apply(i,[this].concat(n))).visualCellRange=null,e}return t=f,(n=[{key:"add",value:function(e){return null===this.visualCellRange?this.visualCellRange=new o.b(e):this.visualCellRange.expand(e),this}},{key:"clear",value:function(){return this.visualCellRange=null,s(h(f.prototype),"clear",this).call(this)}},{key:"findVisibleCoordsInRange",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n,i=e.row,a=e.col,l=t.row,s=t.col,c=this.settings.visualToRenderableCoords(e),u=c.row,f=c.col;return l===i&&null===u||s===a&&null===f?null:null===u&&null===f?this.findVisibleCoordsInRange(new o.a(i+n,a+r),t,n,r):null===u?this.findVisibleCoordsInRange(new o.a(i+n,a),t,n,r):null===f?this.findVisibleCoordsInRange(new o.a(i,a+r),t,n,r):e}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var e=this.getRowSearchDirection(this.visualCellRange),t=this.getColumnSearchDirection(this.visualCellRange),n=this.findVisibleCoordsInRange(this.visualCellRange.from,this.visualCellRange.to,e,t),r=this.findVisibleCoordsInRange(this.visualCellRange.to,this.visualCellRange.from,-e,-t);if(null===n)return this.cellRange=null,this;var i=this.settings.visualToRenderableCoords(n),a=this.settings.visualToRenderableCoords(r);return this.cellRange=new o.b(i,i,a),this}},{key:"adjustCoordinates",value:function(e){if(null===this.cellRange&&e){var t=this.getRowSearchDirection(e),n=this.getColumnSearchDirection(e),r=this.findVisibleCoordsInRange(e.from,e.to,t,n);if(null!==r){var i=this.settings.visualToRenderableCoords(r);return this.cellRange=new o.b(i),e.setHighlight(r),this}}return e.setHighlight(e.from),this}},{key:"getVisualCorners",value:function(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopLeftCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomRightCorner());return[e.row,e.col,t.row,t.col]}},{key:"getRowSearchDirection",value:function(e){return e.from.row<e.to.row?1:-1}},{key:"getColumnSearchDirection",value:function(e){return e.from.col<e.to.col?1:-1}}])&&l(t.prototype,n),r&&l(t,r),f}(o.c);var p=function(e){var t=e.visualToRenderableCoords,n=e.renderableToVisualCoords,r=e.activeHeaderClassName;return new d({visualToRenderableCoords:t,renderableToVisualCoords:n,highlightHeaderClassName:r})};var v=function(e){var t=e.BorderStyle,n=e.visualToRenderableCoords,r=e.renderableToVisualCoords,o=e.layerLevel,i=e.areaCornerVisible,a=new t;return a.cornerVisible=i,new d({visualToRenderableCoords:n,renderableToVisualCoords:r,className:"area",markIntersections:!0,layerLevel:Math.min(o,7),border:a})};var y=function(e){var t=e.BorderStyle,n=e.visualToRenderableCoords,r=e.renderableToVisualCoords,o=e.cellCornerVisible,i=new t;return i.cornerVisible=o,new d({visualToRenderableCoords:n,renderableToVisualCoords:r,className:"current",border:i})};function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b=function(e){var t=e.visualToRenderableCoords,n=e.renderableToVisualCoords,r=e.border,o=e.cellRange;return new d(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({visualToRenderableCoords:t,renderableToVisualCoords:n},r),o)};var w=function(e){var t=e.BorderStyle,n=e.visualToRenderableCoords,r=e.renderableToVisualCoords,o=new t;return new d({visualToRenderableCoords:n,renderableToVisualCoords:r,className:"fill",border:o})};var C=function(e){var t=e.visualToRenderableCoords,n=e.renderableToVisualCoords,r=e.headerClassName,o=e.rowClassName,i=e.columnClassName;return new d({visualToRenderableCoords:t,renderableToVisualCoords:n,className:"highlight",highlightHeaderClassName:r,highlightRowClassName:o,highlightColumnClassName:i})},O=new Map,E=Object(r.a)("highlight/types"),S=E.register,R=E.getItem;function T(e,t,n){n&&O.set(e,n),S(e,t)}function k(e,t){return R(e)(t)}T("active-header",p),T("area",v,{width:1,color:"#4b89ff",strokeAlignment:"inside"}),T("cell",y,{width:2,color:"#4b89ff",strokeAlignment:"inside"}),T("custom-selection",b),T("fill",w,{width:1,color:"#ff0000",strokeAlignment:"inside"}),T("header",C);var j=n(156),M=n(155);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I(e);if(t){var o=I(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return H(this,n)}}function H(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e){var t=function e(){x(this,e)};return Object(M.extend)(t.prototype,e),function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(n,e);var t=_(n);function n(){return x(this,n),t.apply(this,arguments)}return n}(t)}function P(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.layerLevel=0,this.borderStyles=new Map([["cell",this._createBorderStyleClass("cell")],["fill",this._createBorderStyleClass("fill")],["area",this._createBorderStyleClass("area")]]),this.cell=k("cell",F({BorderStyle:this.borderStyles.get("cell")},t)),this.fill=k("fill",F({BorderStyle:this.borderStyles.get("fill")},t)),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=new Map}var t,n,r;return t=e,(n=[{key:"isEnabledFor",value:function(e){var t="current"===e?"cell":e,n=this.options.disableHighlight;return"string"==typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(t)}},{key:"useLayerLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var e,t=this.layerLevel;return this.areas.has(t)?e=this.areas.get(t):(e=k("area",F({BorderStyle:this.borderStyles.get("area"),layerLevel:t},this.options)),this.areas.set(t,e)),e}},{key:"getAreas",value:function(){return P(this.areas.values())}},{key:"createOrGetHeader",value:function(){var e,t=this.layerLevel;return this.headers.has(t)?e=this.headers.get(t):(e=k("header",F({},this.options)),this.headers.set(t,e)),e}},{key:"getHeaders",value:function(){return P(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var e,t=this.layerLevel;return this.activeHeaders.has(t)?e=this.activeHeaders.get(t):(e=k("active-header",F({},this.options)),this.activeHeaders.set(t,e)),e}},{key:"getCommonBorderStyle",value:function(e){var t;return null===(t=this.borderStyles.get(e))||void 0===t?void 0:t.prototype}},{key:"getActiveHeaders",value:function(){return P(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return P(this.customSelections.values())}},{key:"addCustomSelection",value:function(e,t){this.customSelections.set(e,k("custom-selection",F(F({},this.options),t)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),Object(j.arrayEach)(this.areas.values(),(function(e){e.clear()})),Object(j.arrayEach)(this.headers.values(),(function(e){e.clear()})),Object(j.arrayEach)(this.activeHeaders.values(),(function(e){e.clear()}))}},{key:"getAll",value:function(){return[this.cell,this.fill].concat(P(this.areas.values()),P(this.headers.values()),P(this.activeHeaders.values()),P(this.customSelections.values()))}},{key:"_createBorderStyleClass",value:function(e){var t=function(e){return O.get(e)||{}}(e);if(t)return L(t)}}])&&W(t.prototype,n),r&&W(t,r),e}();function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var G=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ranges=[]}var t,n,r;return t=e,(n=[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(e){return this.clear(),this.ranges.push(new o.b(e)),this}},{key:"add",value:function(e){return this.ranges.push(new o.b(e)),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some((function(t){return t.includes(e)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+t-1;return n>=0&&(e=this.ranges[n]),e}},{key:Symbol.iterator,value:function(){return this.ranges[Symbol.iterator]()}}])&&z(t.prototype,n),r&&z(t,r),e}(),X=n(240),K=n(163),Y=n(184);function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=t,this.options=n}var t,n,r;return t=e,(n=[{key:"transformStart",value:function(e,t,n){var r=new o.a(e,t),i=this.range.current().highlight,a=this.options.visualToRenderableCoords(i),l=a.row,s=a.col,c=i,u=0,f=0;if(this.runLocalHooks("beforeTransformStart",r),null!==l&&null!==s){var h=this.options.countRows(),d=this.options.countCols(),p=this.options.fixedRowsBottom(),v=this.options.minSpareRows(),y=this.options.minSpareCols(),g=this.options.autoWrapRow(),m=this.options.autoWrapCol();l+e>h-1?n&&v>0&&!(p&&l>=h-p-1)?(this.runLocalHooks("insertRowRequire",h),h=this.options.countRows()):m&&(r.row=1-h,r.col=s+r.col===d-1?1-d:1):m&&l+r.row<0&&s+r.col>=0&&(r.row=h-1,r.col=s+r.col===0?d-1:-1),s+r.col>d-1?n&&y>0?(this.runLocalHooks("insertColRequire",d),d=this.options.countCols()):g&&(r.row=l+r.row===h-1?1-h:1,r.col=1-d):g&&s+r.col<0&&l+r.row>=0&&(r.row=l+r.row===0?h-1:-1,r.col=d-1);var b=new o.a(l+r.row,s+r.col);u=0,f=0,b.row<0?(u=-1,b.row=0):b.row>0&&b.row>=h&&(u=1,b.row=h-1),b.col<0?(f=-1,b.col=0):b.col>0&&b.col>=d&&(f=1,b.col=d-1),c=this.options.renderableToVisualCoords(b)}return this.runLocalHooks("afterTransformStart",c,u,f),c}},{key:"transformEnd",value:function(e,t){var n=new o.a(e,t),r=this.range.current(),i=r.to,a=0,l=0;this.runLocalHooks("beforeTransformEnd",n);var s=this.options.visualToRenderableCoords(r.highlight),c=s.row,u=s.col;if(null!==c&&null!==u){var f=this.options.countRows(),h=this.options.countCols(),d=this.options.visualToRenderableCoords(r.to),p=d.row,v=d.col,y=new o.a(p+n.row,v+n.col);a=0,l=0,y.row<0?(a=-1,y.row=0):y.row>0&&y.row>=f&&(a=1,y.row=f-1),y.col<0?(l=-1,y.col=0):y.col>0&&y.col>=h&&(l=1,y.col=h-1),i=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformEnd",i,a,l),i}}])&&q(t.prototype,n),r&&q(t,r),e}();Object(M.mixin)($,Y.a);var Q=$;function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var J=[3,2],ee=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],te=Symbol("root"),ne=Symbol("child");function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:te;if(t!==te&&t!==ne)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(e),r=t===te,i=0;if(n){var a=e[0];if(0===e.length)i=1;else if(r&&a instanceof o.b)i=3;else if(r&&Array.isArray(a))i=re(a,ne);else if(e.length>=2&&e.length<=4){var l=!e.some((function(e,t){return!ee[t].includes(Z(e))}));l&&(i=2)}}return i}function oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.keepDirection,r=void 0!==n&&n,o=t.propToCol;if(!J.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(t){var n=3===e,i=n?t.from.row:t[0],a=n?t.from.col:t[1],l=n?t.to.row:t[2],s=n?t.to.col:t[3];if("function"==typeof o&&("string"==typeof a&&(a=o(a)),"string"==typeof s&&(s=o(s))),Object(K.isUndefined)(l)&&(l=i),Object(K.isUndefined)(s)&&(s=a),!r){var c=i,u=a,f=l,h=s;i=Math.min(c,f),a=Math.min(u,h),l=Math.max(c,f),s=Math.max(u,h)}return[i,a,l,s]}}function ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return"number"==typeof e&&e>=0&&e<t}var ae=n(175);function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ce(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) \n        or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]])\\x20\n        or as an array of CellRange objects."]);return ce=function(){return e},e}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fe=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings=t,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new G,this.highlight=new U({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disableHighlight:t.disableVisualSelection,cellCornerVisible:function(){return r.isCellCornerVisible.apply(r,arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible.apply(r,arguments)},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)}}),this.transformation=new Q(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["beforeModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["afterModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertRowRequire"].concat(t))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks.apply(r,["insertColRequire"].concat(t))}))}var t,n,r;return t=e,(n=[{key:"updateBorderStyle",value:function(e){var t=this;Object(j.arrayEach)(["cell","area","fill"],(function(n){var r,o,i=Object(M.isObject)(e[n])?e[n]:{};r=t.highlight.getCommonBorderStyle(n),(o=i).borderWidth?r.width=o.borderWidth:r.hasOwnProperty("width")&&delete r.width,o.borderColor?r.color=o.borderColor:r.hasOwnProperty("color")&&delete r.color}))}},{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,o=Object(K.isUndefined)(t)?Object(X.a)():t,i=e.row<0,a=e.col<0,l=i&&a;i&&(e.row=0),a&&(e.col=0),this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),e),(!r||r&&!o&&Object(K.isUndefined)(t))&&this.selectedRange.clear(),this.selectedRange.add(e),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&i&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,t){this.setRangeStart(e,t,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){this.runLocalHooks("beforeSetRangeEnd",e),this.begin();var t=this.selectedRange.current();if("single"!==this.settings.selectionMode&&t.setTo(new o.a(e.row,e.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor("cell")){var n=this.tableProps.expandCoordsToRangeIncludingSpans(this.selectedRange.current().highlight);this.highlight.getCell().add(n.from).add(n.to).commit().adjustCoordinates(t)}var r=this.getLayerLevel();r<this.highlight.layerLevel&&(Object(j.arrayEach)(this.highlight.getAreas(),(function(e){e.clear()})),Object(j.arrayEach)(this.highlight.getHeaders(),(function(e){e.clear()})),Object(j.arrayEach)(this.highlight.getActiveHeaders(),(function(e){e.clear()}))),this.highlight.useLayerLevel(r);var i=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();i.clear(),a.clear(),l.clear(),this.highlight.isEnabledFor("area")&&(this.isMultiple()||r>=1)&&(i.add(t.from).add(t.to).commit(),1===r&&(this.highlight.useLayerLevel(r-1).createOrGetArea().add(this.selectedRange.previous().from).commit(),this.highlight.useLayerLevel(r))),this.highlight.isEnabledFor("header")&&("single"===this.settings.selectionMode?a.add(t.highlight).commit():a.add(t.from).add(t.to).commit()),this.isSelectedByRowHeader()&&this.tableProps.countCols()===t.getWidth()&&l.add(new o.a(t.from.row,-1)).add(new o.a(t.to.row,-1)).commit(),this.isSelectedByColumnHeader()&&this.tableProps.countRows()===t.getHeight()&&l.add(new o.a(-1,t.from.col)).add(new o.a(-1,t.to.col)).commit(),this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=Object(M.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,t,n){var r=this.transformation.transformStart(e,t,n);this.getSelectedRange().current().highlight!==r&&this.setRangeStart(r)}},{key:"transformEnd",value:function(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=this.tableProps.countRows(),t=this.tableProps.countCols();0!==e&&0!==t&&(this.clear(),this.setRangeStartOnly(new o.a(-1,-1)),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(new o.a(e-1,t-1)),this.finish())}},{key:"selectCells",value:function(e){var t=this,n=re(e);if(1===n)return!1;if(0===n)throw new Error(Object(ae.a)(ce()));var r=oe(n,{propToCol:function(e){return t.tableProps.propToCol(e)},keepDirection:!0}),i=this.tableProps.countRows(),a=this.tableProps.countCols(),l=!e.some((function(e){var t=le(r(e),4),n=t[0],o=t[1],l=t[2],s=t[3];return!(ie(n,i)&&ie(o,a)&&ie(l,i)&&ie(s,a))}));return l&&(this.clear(),Object(j.arrayEach)(e,(function(e){var n=le(r(e),4),i=n[0],a=n[1],l=n[2],s=n[3];t.setRangeStartOnly(new o.a(i,a),!1),t.setRangeEnd(new o.a(l,s)),t.finish()}))),l}},{key:"selectColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n="string"==typeof e?this.tableProps.propToCol(e):e,r="string"==typeof t?this.tableProps.propToCol(t):t,i=this.tableProps.countCols(),a=this.tableProps.countRows(),l=a>0&&ie(n,i)&&ie(r,i);return l&&(this.setRangeStartOnly(new o.a(-1,n)),this.setRangeEnd(new o.a(a-1,r)),this.finish()),l}},{key:"selectRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=this.tableProps.countRows(),r=this.tableProps.countCols(),i=ie(e,n)&&ie(t,n);return i&&(this.setRangeStartOnly(new o.a(e,-1)),this.setRangeEnd(new o.a(t,r>0?r-1:0)),this.finish()),i}},{key:"refresh",value:function(){if(this.isSelected()){var e=this.highlight.getCell(),t=this.getLayerLevel();e.commit().adjustCoordinates(this.selectedRange.current());for(var n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),i=this.highlight.createOrGetActiveHeader();r.commit(),o.commit(),i.commit()}this.highlight.useLayerLevel(t)}}}])&&ue(t.prototype,n),r&&ue(t,r),e}();Object(M.mixin)(fe,Y.a);var he=fe;n(214)},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return G})),n.d(t,"c",(function(){return j}));var r=n(241),o=n.n(r),i=n(198),a=n(155),l=n(156),s=n(167),c=n(163);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}var d=Object(i.cellMethodLookupFactory)("copyable",!1),p=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.tableMeta=r,this.dataSource=n,this.duckSchema=this.dataSource&&this.dataSource[0]?Object(a.duckSchema)(this.dataSource[0]):{},this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return h(e,null,[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),h(e,[{key:"createMap",value:function(){var e=this.getSchema();if(void 0===e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var t,n=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,n){var r=0,o=0,i=!1;if("function"==typeof n){var l=Object(a.deepObjectSize)(e);r=l>0?l:this.countFirstRowKeys(),i=!0}else{var s=this.tableMeta.maxCols;r=Math.min(s,n.length)}for(t=0;t<r;t++){var c=i?n(t):n[t];if(Object(a.isObject)(c)){if(void 0!==c.data){var u=i?o:t;this.colToPropCache[u]=c.data,this.propToColCache.set(c.data,u)}o+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return Object(i.countFirstRowKeys)(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,t,n){var r,o=this,i=t,l=n;return void 0===i&&(i=0,l=""),"object"!==u(e)||Array.isArray(e)||Object(a.objectEach)(e,(function(e,t){null===e?(r=l+t,o.colToPropCache.push(r),o.propToColCache.set(r,i),i+=1):i=o.recursiveDuckColumns(e,i,"".concat(t,"."))})),i}},{key:"colToProp",value:function(e){if(!1===Number.isInteger(e))return e;var t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&Object(c.isDefined)(this.colToPropCache[t])?this.colToPropCache[t]:t}},{key:"propToCol",value:function(e){var t=this.propToColCache.get(e);if(Object(c.isDefined)(t))return this.instance.toVisualColumn(t);var n=this.instance.toVisualColumn(e);return null===n?e:n}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:this.duckSchema}},{key:"createRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,o=this.instance.countSourceRows(),i=o,l=0,c=e;("number"!=typeof c||c>=o)&&(c=o),c<this.instance.countRows()&&(i=this.instance.toPhysicalRow(c));var u=this.instance.runHooks("beforeCreateRow",c,n,r);if(!1===u||null===i)return 0;for(var f=this.tableMeta.maxRows,h=this.instance.countCols(),d=[],p=function(){var e=null;"array"===t.instance.dataType?t.tableMeta.dataSchema?e=Object(a.deepClone)(t.getSchema()):(e=[],Object(s.rangeEach)(h-1,(function(){return e.push(null)}))):"function"===t.instance.dataType?e=t.tableMeta.dataSchema(c):(e={},Object(a.deepExtend)(e,t.getSchema())),d.push(e),l+=1};l<n&&o+l<f;)p();return this.instance.rowIndexMapper.insertIndexes(c,l),this.spliceData.apply(this,[i,0].concat(d)),this.instance.runHooks("afterCreateRow",c,l,r),this.instance.forceFullRender=!0,l}},{key:"createCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var r=this.dataSource,o=this.tableMeta.maxCols,i=e;("number"!=typeof i||i>=this.instance.countSourceCols())&&(i=this.instance.countSourceCols());var a=this.instance.runHooks("beforeCreateCol",i,t,n);if(!1===a)return 0;var l=this.instance.countSourceCols();i<this.instance.countCols()&&(l=this.instance.toPhysicalColumn(i));for(var s=this.instance.countSourceRows(),c=this.instance.countCols(),u=0,f=l;u<t&&c<o;){if("number"!=typeof i||i>=c)if(s>0)for(var h=0;h<s;h+=1)void 0===r[h]&&(r[h]=[]),r[h].push(null);else r.push([null]);else for(var d=0;d<s;d++)r[d].splice(f,0,null);u+=1,f+=1,c+=1}return this.instance.columnIndexMapper.insertIndexes(i,u),this.instance.runHooks("afterCreateCol",i,u,n),this.instance.forceFullRender=!0,u}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r="number"!=typeof e?-t:e,o=this.instance.runHooks("modifyRemovedAmount",t,r),i=this.instance.countSourceRows();r=(i+r)%i;var a=this.visualRowsToPhysical(r,o),l=this.instance.runHooks("beforeRemoveRow",r,o,a,n);if(!1===l)return!1;var s=this.dataSource,u=this.filterData(r,o);if(u&&(s.length=0,Array.prototype.push.apply(s,u)),r<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(a);var f=Object(c.isDefined)(this.tableMeta.columns)||Object(c.isDefined)(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===f&&this.instance.columnIndexMapper.setIndexesSequence([])}return this.instance.runHooks("afterRemoveRow",r,o,a,n),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var r="number"!=typeof e?-t:e;r=(this.instance.countCols()+r)%this.instance.countCols();var o=this.visualColumnsToPhysical(r,t),i=o.slice(0).sort((function(e,t){return t-e})),a=this.instance.runHooks("beforeRemoveCol",r,t,o,n);if(!1===a)return!1;for(var l=!0,s=i.length,c=this.dataSource,u=0;u<s;u++)l&&o[0]!==o[u]-u&&(l=!1);if(l)for(var f=0,h=this.instance.countSourceRows();f<h;f++)c[f].splice(o[0],t);else for(var d=0,p=this.instance.countSourceRows();d<p;d++)for(var v=0;v<s;v++)c[d].splice(i[v],1);return r<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(o),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",r,t,o,n),this.instance.forceFullRender=!0,!0}},{key:"spliceCol",value:function(e,t,n){for(var r=this.instance.getDataAtCol(e),o=r.slice(t,t+n),i=r.slice(t+n),a=arguments.length,s=new Array(a>3?a-3:0),c=3;c<a;c++)s[c-3]=arguments[c];Object(l.extendArray)(s,i);for(var u=0;u<n;)s.push(null),u+=1;return Object(l.to2dArray)(s),this.instance.populateFromArray(t,e,s,null,null,"spliceCol"),o}},{key:"spliceRow",value:function(e,t,n){for(var r=this.instance.getSourceDataAtRow(e),o=r.slice(t,t+n),i=r.slice(t+n),a=arguments.length,s=new Array(a>3?a-3:0),c=3;c<a;c++)s[c-3]=arguments[c];Object(l.extendArray)(s,i);for(var u=0;u<n;)s.push(null),u+=1;return this.instance.populateFromArray(e,t,[s],null,null,"spliceRow"),o}},{key:"spliceData",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i,a=this.instance.runHooks("beforeDataSplice",e,t,r);!1!==a&&(i=this.dataSource).splice.apply(i,[e,t].concat(r))}},{key:"filterData",value:function(e,t){var n=this.visualRowsToPhysical(e,t);if(!1!==this.instance.runHooks("beforeDataFilter",e,t,n))return this.dataSource.filter((function(e,t){return-1===n.indexOf(t)}))}},{key:"get",value:function(e,t){var n=this.instance.toPhysicalRow(e),r=this.dataSource[n],o=this.instance.runHooks("modifyRowData",n),i=null;if((r=isNaN(o)?o:r)&&r.hasOwnProperty&&Object(a.hasOwnProperty)(r,t))i=r[t];else if("string"==typeof t&&t.indexOf(".")>-1){var l=t.split("."),s=r;if(!s)return null;for(var c=0,u=l.length;c<u;c++)if(void 0===(s=s[l[c]]))return null;i=s}else"function"==typeof t&&(i=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var f=Object(a.createObjectPropListener)(i);this.instance.runHooks("modifyData",n,this.propToCol(t),f,"get"),f.isTouched()&&(i=f.value)}return i}},{key:"getCopyable",value:function(e,t){return d.call(this.instance,e,this.propToCol(t))?this.get(e,t):""}},{key:"set",value:function(e,t,n){var r=this.instance.toPhysicalRow(e),o=n,i=this.dataSource[r],l=this.instance.runHooks("modifyRowData",r);if(i=isNaN(l)?l:i,this.instance.hasHook("modifyData")){var s=Object(a.createObjectPropListener)(o);this.instance.runHooks("modifyData",r,this.propToCol(t),s,"set"),s.isTouched()&&(o=s.value)}if(i&&i.hasOwnProperty&&Object(a.hasOwnProperty)(i,t))i[t]=o;else if("string"==typeof t&&t.indexOf(".")>-1){var c,u=t.split("."),f=i,h=0;for(h=0,c=u.length-1;h<c;h++)void 0===f[u[h]]&&(f[u[h]]={}),f=f[u[h]];f[u[h]]=o}else"function"==typeof t?t(this.dataSource.slice(r,r+1)[0],o):i[t]=o}},{key:"visualRowsToPhysical",value:function(e,t){for(var n,r=this.instance.countSourceRows(),o=[],i=(r+e)%r,a=t;i<r&&a;)n=this.instance.toPhysicalRow(i),o.push(n),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(e,t){for(var n=this.instance.countCols(),r=[],o=(n+e)%n,i=t;o<n&&i;){var a=this.instance.toPhysicalColumn(o);r.push(a),i-=1,o+=1}return r}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}},{key:"getLength",value:function(){var e,t=this.tableMeta.maxRows;e=t<0||0===t?0:t||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}},{key:"getAll",value:function(){var t={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-n.row!=0||this.instance.countSourceRows()?this.getRange(t,n,e.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,n,r){var o,i,a,l=[],s=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(0===s||0===c)return[];var u=r===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(s-1,0),Math.max(t.row,n.row)),h=Math.min(Math.max(c-1,0),Math.max(t.col,n.col));for(o=Math.min(t.row,n.row);o<=f;o++){a=[];var d=o>=0?this.instance.toPhysicalRow(o):o;for(i=Math.min(t.col,n.col);i<=h&&null!==d;i++)a.push(u.call(this,o,this.colToProp(i)));null!==d&&l.push(a)}return l}},{key:"getText",value:function(t,n){return o.a.stringify(this.getRange(t,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,n){return o.a.stringify(this.getRange(t,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.tableMeta=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}]),e}(),v=n(212);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O(e);if(t){var o=O(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return C(this,n)}}function C(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){var n="string"==typeof e?Object(v.a)(e):e;if(Object(a.isObject)(n)){var r=Object(a.isObject)(t),o={};return Object(a.objectEach)(n,(function(e,n){(!r||r&&!Object(a.hasOwnProperty)(t,n))&&(o[n]=e)})),o}}function S(e){return Number.isInteger(e)&&e>=0}function R(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function T(e){return null==e}function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var j=function(){return{licenseKey:void 0,data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,selectionMode:"multiple",fillHandle:{autoInsertRow:!1},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!0,autoWrapCol:!0,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",activeHeaderClassName:"ht__active_highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(e){var t,n,r,o;for(t=0,n=this.countCols();t<n;t++)if(""!==(r=this.getDataAtCell(e,t))&&null!==r&&Object(c.isDefined)(r))return"object"===k(r)&&(o=this.getCellMeta(e,t),Object(a.isObjectEqual)(this.getSchema()[o.prop],r));return!0},isEmptyCol:function(e){var t,n,r;for(t=0,n=this.countRows();t<n;t++)if(""!==(r=this.getDataAtCell(t,e))&&null!==r&&Object(c.isDefined)(r))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:void 0,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,skipRowOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,visibleRows:10,trimDropdown:!0,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,multiColumnSorting:void 0,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,manualColumnFreeze:void 0,trimWhitespace:!0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:"en-US",selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:"DD/MM/YYYY",correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,preventWheel:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1,dragToScroll:!0,nestedRows:void 0,selectionStyle:void 0}};function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var N=function(){function e(){A(this,e),this.metaCtor=function e(){A(this,e)},this.meta=this.metaCtor.prototype,Object(a.extend)(this.meta,j())}var t,n,r;return t=e,(n=[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){Object(a.extend)(this.meta,e),Object(a.extend)(this.meta,E(e.type,e))}}])&&M(t.prototype,n),r&&M(t,r),e}();function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var H=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.getMetaConstructor();this.meta=new n}var t,n,r;return t=e,(n=[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){Object(a.extend)(this.meta,e),Object(a.extend)(this.meta,E(e.type,e))}}])&&_(t.prototype,n),r&&_(t,r),e}();function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var x=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.valueFactory=t,this.data=[],this.index=[],this.holes=new Set}var t,n,r;return t=e,(n=[{key:"obtain",value:function(e){R((function(){return S(e)}),"Expecting an unsigned number.");var t,n=this._getStorageIndexByKey(e);if(n>=0)void 0===(t=this.data[n])&&(t=this.valueFactory(e),this.data[n]=t);else if(t=this.valueFactory(e),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=t,this.index[e]=r}else this.data.push(t),this.index[e]=this.data.length-1;return t}},{key:"insert",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;R((function(){return S(e)||T(e)}),"Expecting an unsigned number or null/undefined argument.");for(var r=[],o=this.data.length,i=0;i<n;i++)r.push(o+i),this.data.push(void 0);(t=this.index).splice.apply(t,[T(e)?this.index.length:e,0].concat(r))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;R((function(){return S(e)||T(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(T(e)?this.index.length-t:e,t),r=0;r<n.length;r++){var o=n[r];"number"==typeof o&&this.holes.add(o)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var e=this;return Object(l.arrayFilter)(this.data,(function(t,n){return!e.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var e=[],t=0;t<this.data.length;t++){var n=this._getKeyByStorageIndex(t);-1!==n&&e.push([n,this.data[t]])}var r=0;return{next:function(){if(r<e.length){var t=e[r];return r+=1,{value:t,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(e){return this.index.length>e?this.index[e]:-1}},{key:"_getKeyByStorageIndex",value:function(e){return this.index.indexOf(e)}},{key:Symbol.iterator,value:function(){return this.entries()}}])&&I(t.prototype,n),r&&I(t,r),e}();function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P=["data","width"],D=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalMeta=t,this.metas=new x((function(){return n._createMeta()}))}var t,n,r;return t=e,(n=[{key:"updateMeta",value:function(e,t){var n=this.getMeta(e);Object(a.extend)(n,t),Object(a.extend)(n,E(t.type,n))}},{key:"createColumn",value:function(e,t){this.metas.insert(e,t)}},{key:"removeColumn",value:function(e,t){this.metas.remove(e,t)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=function(e){m(n,e);var t=w(n);function n(){return g(this,n),t.apply(this,arguments)}return n}(e),r=0;r<t.length;r++)n.prototype[t[r]]=void 0;return n}(this.globalMeta.getMetaConstructor(),P).prototype}}])&&L(t.prototype,n),r&&L(t,r),e}();function B(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var W=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.columnMeta=t,this.metas=new x((function(){return n._createRow()}))}var t,n,r;return t=e,(n=[{key:"updateMeta",value:function(e,t,n){var r=this.getMeta(e,t);Object(a.extend)(r,n),Object(a.extend)(r,E(n.type,r))}},{key:"createRow",value:function(e,t){this.metas.insert(e,t)}},{key:"createColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}},{key:"removeRow",value:function(e,t){this.metas.remove(e,t)}},{key:"removeColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}},{key:"getMeta",value:function(e,t,n){var r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}},{key:"setMeta",value:function(e,t,n,r){this.metas.obtain(e).obtain(t)[n]=r}},{key:"removeMeta",value:function(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}},{key:"getMetas",value:function(){for(var e=[],t=Array.from(this.metas.values()),n=0;n<t.length;n++)e.push.apply(e,B(t[n].values()));return e}},{key:"getMetasAtRow",value:function(e){R((function(){return S(e)}),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new x((function(t){return e._createMeta(t)}))}},{key:"_createMeta",value:function(e){return new(this.columnMeta.getMetaConstructor(e))}}])&&V(t.prototype,n),r&&V(t,r),e}();function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var G=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};U(this,e),this.globalMeta=new N,this.globalMeta.updateMeta(t),this.tableMeta=new H(this.globalMeta),this.columnMeta=new D(this.globalMeta),this.cellMeta=new W(this.columnMeta)}var t,n,r;return t=e,(n=[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,t){this.columnMeta.updateMeta(e,t)}},{key:"getCellMeta",value:function(e,t,n){return this.cellMeta.getMeta(e,t,n)}},{key:"setCellMeta",value:function(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}},{key:"updateCellMeta",value:function(e,t,n){this.cellMeta.updateMeta(e,t,n)}},{key:"removeCellMeta",value:function(e,t,n){this.cellMeta.removeMeta(e,t,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}},{key:"createColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}},{key:"removeColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}])&&z(t.prototype,n),r&&z(t,r),e}()},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(156),o=n(202),i=n(174);var a=Object(i.a)("phraseFormatters"),l=a.register,s=a.getValues;l("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));var c=n(163);function u(e,t,n){var i=Object(o.b)(e);if(null===i)return null;var a=i[t];if(Object(c.isUndefined)(a))return null;var l=function(e,t){var n=e;return Object(r.arrayEach)(function(){return s()}(),(function(r){n=r(e,t)})),n}(a,n);return Array.isArray(l)?l[0]:l}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),o=n.n(r),i=function(){return o.a.createElement("div",{className:"sv-chart-image-wrapper"},o.a.createElement("div",{className:"sv-chart-image-placeholder"},o.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{fill:"#f5f5f5",d:"M11.094,13.019h7.735c0.057,0,0.105,0.049,0.104,0.106c-0.068,4.946-5.015,\n          7.789-9.648,6.554c-2.773-0.739-4.59-2.882-5.139-5.665c-0.433-2.197,0.142-4.497,1.572-6.223c1.379-1.665,\n          2.977-2.684,5.142-2.723c0.057-0.001,0.106,0.047,0.106,0.104l0.028,7.748C10.994,12.975,11.039,13.019,\n          11.094,13.019z"}),o.a.createElement("path",{fill:"#f5f5f5",d:"M13.009,10.878V3.294c0-0.057,0.048-0.105,0.105-0.104C17.163,3.247,21,6.917,21,\n          10.978c0,0.002,0,0.004,0,0.006l-7.891-0.006C13.054,10.978,13.009,10.934,13.009,10.878z"}))))}},,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){"use strict";(function(e,r){n.d(t,"a",(function(){return D}));var o=n(157),i=n(183),a=n(163),l=n(169),s=n(272),c=n(166),u=n(155),f=n(156),h=n(213),d=n(170),p=n(220),v=n(211),y=n(172),g=n(167),m=n(265),b=n(266),w=n(198),C=n(218),O=n(238),E=n(161),S=n(181),R=n(247),T=n(202),k=n(239),j=n(240),M=n(243),A=n(244),N=n(267);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=null;function D(t,n){var x,L,D,B,F=this,V=arguments.length>2&&void 0!==arguments[2]&&arguments[2],W=!1,U=this,z=new c.a(U),G=!0;n.language=Object(k.b)(n.language);var X=new A.b(n),K=X.getTableMeta(),Y=X.getGlobalMeta();Object(O.a)(V)&&Object(O.c)(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Object(j.b)(this.rootDocument),this.isDestroyed=!1,this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Object(O.b)(this)&&Object(a._injectProductInfo)(n.licenseKey,t),this.guid="ht_".concat(Object(y.randomString)()),this.columnIndexMapper=new C.a,this.rowIndexMapper=new C.a,L=new b.a(U),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var q=function(e){var t=e.row,n=e.col;return new E.a(t>=0?U.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?U.columnIndexMapper.getRenderableFromVisualIndex(n):n)},$=function(e){var t=e.row,n=e.col;return new E.a(t>=0?U.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?U.columnIndexMapper.getVisualFromRenderableIndex(n):n)},Q=new M.a(K,{countCols:function(){return U.countCols()},countRows:function(){return U.countRows()},propToCol:function(e){return x.propToCol(e)},isEditorOpened:function(){return!!U.getActiveEditor()&&U.getActiveEditor().isOpened()},countColsTranslated:function(){return F.view.countRenderableColumns()},countRowsTranslated:function(){return F.view.countRenderableRows()},visualToRenderableCoords:q,renderableToVisualCoords:$,expandCoordsToRangeIncludingSpans:function(e){return Object(N.a)(U,e)}});this.selection=Q;var Z=function(e,t,n){n&&F.selection.refresh()};function J(e){var t=Object(k.c)(e);Object(T.d)(t)?(U.runHooks("beforeLanguageChange",t),Y.language=t,U.runHooks("afterLanguageChange",t)):Object(k.d)(e)}function ee(e,t){var n="className"===e?U.rootElement:U.table;if(G)Object(o.addClass)(n,t);else{var r=[],i=[];Y[e]&&(r=Array.isArray(Y[e])?Y[e]:Object(f.stringToArray)(Y[e])),t&&(i=Array.isArray(t)?t:Object(f.stringToArray)(t));var a=Object(f.getDifferenceOfArrays)(r,i),l=Object(f.getDifferenceOfArrays)(i,r);a.length&&Object(o.removeClass)(n,a),l.length&&Object(o.addClass)(n,l)}Y[e]=t}function te(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function ne(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function re(e,t,n){if(e.length){var r=U.getActiveEditor(),i=U.runHooks("beforeChange",e,t||"edit"),a=!0;if(!1!==i){var l,s=new te;s.onQueueEmpty=function(e){r&&a&&r.cancelChanges(),n(e)};for(var c=e.length-1;c>=0;c--)if(null===e[c])e.splice(c,1);else{var u=H(e[c],4),f=u[0],h=u[1],d=u[3],p=x.propToCol(h),v=U.getCellMeta(f,p);"numeric"===v.type&&"string"==typeof d&&((l=d).length>0&&/^\s*[+-.]?\s*(?:(?:\d+(?:(\.|,)\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/.test(l))&&(e[c][3]=ne(d)),U.getCellValidator(v)&&(s.addValidatorToQueue(),U.validateCell(e[c][3],v,function(t,n){return function(r){if("boolean"!=typeof r)throw new Error("Validation error: result is not boolean");if(!1===r&&!1===n.allowInvalid){a=!1,e.splice(t,1),n.valid=!0;var i=U.getCell(n.visualRow,n.visualCol);null!==i&&Object(o.removeClass)(i,K.invalidCellClassName)}s.removeValidatorFormQueue()}}(c,v),t))}s.checkIfQueueIsEmpty()}else r&&r.cancelChanges()}}function oe(e,t){var n=e.length-1;if(!(n<0)){for(;n>=0;n--){var r=!1;if(null!==e[n]){if(null!==e[n][2]&&void 0!==e[n][2]||null!==e[n][3]&&void 0!==e[n][3]){if(K.allowInsertRow)for(;e[n][0]>U.countRows()-1;){var o=x.createRow(void 0,void 0,t);if(!(o>=1)){r=!0;break}X.createRow(null,o)}if("array"===U.dataType&&(!K.columns||0===K.columns.length)&&K.allowInsertColumn)for(;x.propToCol(e[n][1])>U.countCols()-1;){var i=x.createCol(void 0,void 0,t);if(!(i>=1)){r=!0;break}X.createColumn(null,i)}r||x.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1)}U.forceFullRender=!0,D.adjustRowsAndCols(),U.runHooks("beforeChangeRender",e,t),B.lockEditor(),U._refreshBorders(null),B.unlockEditor(),U.view.wt.wtOverlays.adjustElementsSizes(),U.runHooks("afterChange",e,t||"edit");var l=U.getActiveEditor();l&&Object(a.isDefined)(l.refreshValue)&&l.refreshValue()}}function ie(e,t,n){return"object"===_(e)?e:[[e,t,n]]}this.columnIndexMapper.addLocalHook("cacheUpdated",Z),this.rowIndexMapper.addLocalHook("cacheUpdated",Z),this.selection.addLocalHook("beforeSetRangeStart",(function(e){F.runHooks("beforeSetRangeStart",e)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(e){F.runHooks("beforeSetRangeStartOnly",e)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(e){F.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=F.view.wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=F.view.wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(e){var t=Object(u.createObjectPropListener)(!1),n=F.selection.getSelectedRange(),r=n.current(),i=r.from,a=r.to,l=n.size()-1;F.runHooks("afterSelection",i.row,i.col,a.row,a.col,t,l),F.runHooks("afterSelectionByProp",i.row,U.colToProp(i.col),a.row,U.colToProp(a.col),t,l);var s=F.selection.isSelectedByAnyHeader(),c=F.selection.selectedRange.current(),f=!0;W&&(f=!1),t.isTouched()&&(f=!t.value);var h=F.selection.isSelectedByRowHeader(),d=F.selection.isSelectedByColumnHeader();!1!==f&&(s?h?F.view.scrollViewportVertically(U.rowIndexMapper.getRenderableFromVisualIndex(e.row)):d&&F.view.scrollViewportHorizontally(U.columnIndexMapper.getRenderableFromVisualIndex(e.col)):c&&!F.selection.isMultiple()?F.view.scrollViewport(q(c.from)):F.view.scrollViewport(q(e))),h&&d?Object(o.addClass)(F.rootElement,["ht__selection--rows","ht__selection--columns"]):h?(Object(o.removeClass)(F.rootElement,"ht__selection--columns"),Object(o.addClass)(F.rootElement,"ht__selection--rows")):d?(Object(o.removeClass)(F.rootElement,"ht__selection--rows"),Object(o.addClass)(F.rootElement,"ht__selection--columns")):Object(o.removeClass)(F.rootElement,["ht__selection--rows","ht__selection--columns"]),F._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(e){var t=e.length-1,n=e[t],r=n.from,o=n.to;F.runHooks("afterSelectionEnd",r.row,r.col,o.row,o.col,t),F.runHooks("afterSelectionEndByProp",r.row,U.colToProp(r.col),o.row,U.colToProp(o.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(e){var t=F.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(e){F.runHooks("modifyTransformStart",e)})),this.selection.addLocalHook("afterModifyTransformStart",(function(e,t,n){F.runHooks("afterModifyTransformStart",e,t,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(e){F.runHooks("modifyTransformEnd",e)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(e,t,n){F.runHooks("afterModifyTransformEnd",e,t,n)})),this.selection.addLocalHook("afterDeselect",(function(){B.destroyEditor(),F._refreshBorders(),Object(o.removeClass)(F.rootElement,["ht__selection--rows","ht__selection--columns"]),F.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(e){F.alter("insert_row",e,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(e){F.alter("insert_col",e,1,"auto")})),D={alter:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,l=function(e){if(0===e.length)return[];var t=I(e);return t.sort((function(e,t){var n=H(e,1)[0],r=H(t,1)[0];return n===r?0:n>r?1:-1})),Object(f.arrayReduce)(t,(function(e,t){var n=H(t,2),r=n[0],o=n[1],i=e[e.length-1],a=H(i,2),l=a[0]+a[1];if(r<=l){var s=Math.max(o-(l-r),0);i[1]+=s}else e.push([r,o]);return e}),[t[0]])};switch(e){case"insert_row":var s=U.countSourceRows();if(K.maxRows===s)return;if(t=Object(a.isDefined)(t)?t:s,n=x.createRow(t,r,o)){X.createRow(U.toPhysicalRow(t),r);var c=Q.selectedRange.current(),u=null==c?void 0:c.from,h=null==u?void 0:u.row;if(Object(a.isDefined)(h)&&h>=t){var d=c.to,p=d.row,v=d.col,y=u.col;Q.isSelectedByRowHeader()&&(y=-1),Q.setRangeStartOnly(new E.a(h+n,y)),Q.setRangeEnd(new E.a(p+n,v))}else U._refreshBorders()}break;case"insert_col":if(n=x.createCol(t,r,o)){if(X.createColumn(U.toPhysicalColumn(t),r),Array.isArray(K.colHeaders)){var g=[t,0];g.length+=n,Array.prototype.splice.apply(K.colHeaders,g)}var m=Q.selectedRange.current(),b=null==m?void 0:m.from,w=null==b?void 0:b.col;if(Object(a.isDefined)(w)&&w>=t){var C=m.to,O=C.row,S=C.col,R=b.row;Q.isSelectedByColumnHeader()&&(R=-1),Q.setRangeStartOnly(new E.a(R,w+n)),Q.setRangeEnd(new E.a(O,S+n))}else U._refreshBorders()}break;case"remove_row":var T=function(e){var t=0;Object(f.arrayEach)(e,(function(e){var n=H(e,2),r=n[0],i=n[1],l=Object(a.isEmpty)(r)?U.countRows()-1:Math.max(r-t,0);if(Number.isInteger(r)&&(r=Math.max(r-t,0)),x.removeRow(r,i,o)){X.removeRow(U.toPhysicalRow(l),i);var s=U.countRows(),c=K.fixedRowsTop;c>=l+1&&(K.fixedRowsTop-=Math.min(i,c-l));var u=K.fixedRowsBottom;u&&l>=s-u&&(K.fixedRowsBottom-=Math.min(i,u)),t+=i}}))};Array.isArray(t)?T(l(t)):T([[t,r]]),D.adjustRowsAndCols(),U._refreshBorders();break;case"remove_col":var k=function(e){var t=0;Object(f.arrayEach)(e,(function(e){var n=H(e,2),r=n[0],i=n[1],l=Object(a.isEmpty)(r)?U.countCols()-1:Math.max(r-t,0),s=U.toPhysicalColumn(l);if(Number.isInteger(r)&&(r=Math.max(r-t,0)),x.removeCol(r,i,o)){X.removeColumn(s,i);var c=K.fixedColumnsLeft;c>=l+1&&(K.fixedColumnsLeft-=Math.min(i,c-l)),Array.isArray(K.colHeaders)&&(void 0===s&&(s=-1),K.colHeaders.splice(s,i)),t+=i}}))};Array.isArray(t)?k(l(t)):k([[t,r]]),D.adjustRowsAndCols(),U._refreshBorders();break;default:throw new Error('There is no such action "'.concat(e,'"'))}i||D.adjustRowsAndCols()},adjustRowsAndCols:function(){if(K.minRows){var e=U.countRows();if(e<K.minRows)for(var t=0,n=K.minRows;t<n-e;t++)x.createRow(U.countRows(),1,"auto")}if(K.minSpareRows){var r=U.countEmptyRows(!0);if(r<K.minSpareRows)for(;r<K.minSpareRows&&U.countSourceRows()<K.maxRows;r++)x.createRow(U.countRows(),1,"auto")}var o;if((K.minCols||K.minSpareCols)&&(o=U.countEmptyCols(!0)),K.minCols&&!K.columns&&U.countCols()<K.minCols)for(;U.countCols()<K.minCols;o++)x.createCol(U.countCols(),1,"auto");if(K.minSpareCols&&!K.columns&&"array"===U.dataType&&o<K.minSpareCols)for(;o<K.minSpareCols&&U.countCols()<K.maxCols;o++)x.createCol(U.countCols(),1,"auto");var i=U.countRows(),a=U.countCols();0!==i&&0!==a||Q.deselect(),Q.isSelected()&&Object(f.arrayEach)(Q.selectedRange,(function(e){var t=!1,n=e.from.row,r=e.from.col,o=e.to.row,l=e.to.col;n>i-1?(t=!0,o>(n=i-1)&&(o=n)):o>i-1&&(t=!0,n>(o=i-1)&&(n=o)),r>a-1?(t=!0,l>(r=a-1)&&(l=r)):l>a-1&&(t=!0,r>(l=a-1)&&(r=l)),t&&U.selectCell(n,r,o,l)})),U.view&&U.view.wt.wtOverlays.adjustElementsSizes()},populateFromArray:function(e,t,n,r,o,i,l){var s,c,f,h,d,p,v,y,g=[],m={};if(0===(c=t.length))return!1;switch(o){case"shift_down":for(d=n?n.col-e.col+1:0,p=n?n.row-e.row+1:0,f=0,h=(t=Object(w.translateRowsToColumns)(t)).length,v=Math.max(h,d);f<v;f++)if(f<h){var b;for(s=0,c=t[f].length;s<p-c;s++)t[f].push(t[f][s%c]);t[f].unshift(e.col+f,e.row,0),(b=U).spliceCol.apply(b,I(t[f]))}else{var C;t[f%h][0]=e.col+f,(C=U).spliceCol.apply(C,I(t[f%h]))}break;case"shift_right":for(d=n?n.col-e.col+1:0,p=n?n.row-e.row+1:0,s=0,c=t.length,y=Math.max(c,p);s<y;s++)if(s<c){var O;for(f=0,h=t[s].length;f<d-h;f++)t[s].push(t[s][f%h]);t[s].unshift(e.row+s,e.col,0),(O=U).spliceRow.apply(O,I(t[s]))}else{var E;t[s%c][0]=e.row+s,(E=U).spliceRow.apply(E,I(t[s%c]))}break;case"overwrite":default:m.row=e.row,m.col=e.col;var S,R={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1},T=0,k=0,j=!0,M=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==n?r[n%r.length]:r},A=t.length,N=n?n.row-e.row+1:0;for(c=n?N:Math.max(A,N),s=0;s<c&&!(n&&m.row>n.row&&N>A||!K.allowInsertRow&&m.row>U.countRows()-1||m.row>=K.maxRows);s++){var H=s-T,x=M(H).length,L=n?n.col-e.col+1:0;if(h=n?L:Math.max(x,L),m.col=e.col,S=U.getCellMeta(m.row,m.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!S.skipRowOnPaste){for(k=0,f=0;f<h&&!(n&&m.col>n.col&&L>x||!K.allowInsertColumn&&m.col>U.countCols()-1||m.col>=K.maxCols);f++)if(S=U.getCellMeta(m.row,m.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!S.skipColumnOnPaste)if(S.readOnly)m.col+=1;else{var P=f-k,D=M(H,P),B=U.getDataAtCell(m.row,m.col),F={row:H,col:P};if("Autofill.fill"===r){var V=U.runHooks("beforeAutofillInsidePopulate",F,i,t,l,{},R);V&&(D=Object(a.isUndefined)(V.value)?D:V.value)}if(null!==D&&"object"===_(D))if(Array.isArray(D)&&null===B&&(B=[]),null===B||"object"!==_(B))j=!1;else{var W=Object(u.duckSchema)(Array.isArray(B)?B:B[0]||B),z=Object(u.duckSchema)(Array.isArray(D)?D:D[0]||D);Object(u.isObjectEqual)(W,z)?D=Object(u.deepClone)(D):j=!1}else null!==B&&"object"===_(B)&&(j=!1);j&&g.push([m.row,m.col,D]),j=!0,m.col+=1}else k+=1,m.col+=1,h+=1;m.row+=1}else T+=1,m.row+=1,c+=1}U.setDataAtCell(g,null,null,r||"populateFromArray")}}},this.executeBatchOperations=function(e){var t=this;this.columnIndexMapper.executeBatchOperations((function(){t.rowIndexMapper.executeBatchOperations((function(){e()}))}))},this.init=function(){L.setData(K.data),U.runHooks("beforeInit"),Object(l.isMobileBrowser)()&&Object(o.addClass)(U.rootElement,"mobile"),this.updateSettings(K,!0),this.view=new m.a(this),B=s.a.getInstance(U,K,Q),U.runHooks("init"),this.forceFullRender=!0,this.view.render(),"object"===_(G)&&(U.runHooks("afterChange",G[0],G[1]),G=!1),U.runHooks("afterInit")},this.validateCell=function(e,t,n,r){var o,l=U.getCellValidator(t);function s(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r&&!0!==t.hidden){var o=t.visualCol,i=t.visualRow,a=U.getCell(i,o,!0);a&&"TH"!==a.nodeName&&U.view.wt.wtSettings.settings.cellRenderer(i,o,a),n(e)}else n(e)}Object(a.isRegExp)(l)&&(o=l,l=function(e,t){t(o.test(e))}),Object(i.isFunction)(l)?(e=U.runHooks("beforeValidate",e,t.visualRow,t.prop,r),U._registerImmediate((function(){l.call(t,e,(function(n){U&&(n=U.runHooks("afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,s(n),U.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,r))}))}))):U._registerImmediate((function(){t.valid=!0,s(t.valid,!1)}))},this.setDataAtCell=function(e,t,n,r){var o,i,a,l=ie(e,t,n),s=[],c=r;for(o=0,i=l.length;o<i;o++){if("object"!==_(l[o]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof l[o][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");a=l[o][1]>=this.countCols()?l[o][1]:x.colToProp(l[o][1]),s.push([l[o][0],a,L.getAtCell(this.toPhysicalRow(l[o][0]),l[o][1]),l[o][2]])}c||"object"!==_(e)||(c=t),U.runHooks("afterSetDataAtCell",s,c),re(s,c,(function(){oe(s,c)}))},this.setDataAtRowProp=function(e,t,n,r){var o,i,a=ie(e,t,n),l=[],s=r;for(o=0,i=a.length;o<i;o++)l.push([a[o][0],a[o][1],L.getAtCell(this.toPhysicalRow(a[o][0]),a[o][1]),a[o][2]]);s||"object"!==_(e)||(s=t),U.runHooks("afterSetDataAtRowProp",l,s),re(l,s,(function(){oe(l,s)}))},this.listen=function(){U&&!U.isListening()&&(P=U.guid,U.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(P=null,U.runHooks("afterUnlisten"))},this.isListening=function(){return P===U.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];U._refreshBorders(e,t)},this.populateFromArray=function(e,t,n,r,o,i,a,l,s){if("object"!==_(n)||"object"!==_(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");var c="number"==typeof r?new E.a(r,o):null;return D.populateFromArray(new E.a(e,t),n,c,i,a,l,s)},this.spliceCol=function(e,t,n){for(var r,o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return(r=x).spliceCol.apply(r,[e,t,n].concat(i))},this.spliceRow=function(e,t,n){for(var r,o=arguments.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=arguments[a];return(r=x).spliceRow.apply(r,[e,t,n].concat(i))},this.getSelected=function(){if(Q.isSelected())return Object(f.arrayMap)(Q.getSelectedRange(),(function(e){var t=e.from,n=e.to;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(Q.isSelected())return Array.from(Q.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){var t=this;if(Q.isSelected()){var n=[];Object(f.arrayEach)(Q.getSelectedRange(),(function(e){var r=e.getTopLeftCorner(),o=e.getBottomRightCorner();Object(g.rangeEach)(r.row,o.row,(function(e){Object(g.rangeEach)(r.col,o.col,(function(r){t.getCellMeta(e,r).readOnly||n.push([e,r,null])}))}))})),n.length>0&&this.setDataAtCell(n,e)}},this.render=function(){U.view&&(U.renderCall=!0,U.forceFullRender=!0,B.lockEditor(),U._refreshBorders(null),B.unlockEditor())},this.refreshDimensions=function(){if(U.view){var e=U.view.getLastSize(),t=e.width,n=e.height,r=Object(o.getBoundingClientRect)(U.rootElement),i=r.width,a=r.height,l=i!==t||a!==n;!1===U.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:i,height:a},l)||((l||U.view.wt.wtOverlays.scrollableElement===U.rootWindow)&&(U.view.setLastSize(i,a),U.render()),U.runHooks("afterRefreshDimensions",{width:t,height:n},{width:i,height:a},l))}},this.loadData=function(e){if(Array.isArray(K.dataSchema)?U.dataType="array":Object(i.isFunction)(K.dataSchema)?U.dataType="function":U.dataType="object",x&&x.destroy(),x=new A.a(U,e,K),"object"===_(e)&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays (".concat(_(e)," given)"));var t,n=x.getSchema();e=[];var r,o=0;for(o=0,r=K.startRows;o<r;o++)if("object"!==U.dataType&&"function"!==U.dataType||!K.dataSchema)if("array"===U.dataType)t=Object(u.deepClone)(n[0]),e.push(t);else{t=[];for(var a=0,l=K.startCols;a<l;a++)t.push(null);e.push(t)}else t=Object(u.deepClone)(n),e.push(t)}Array.isArray(e[0])&&(U.dataType="array"),K.data=e,U.runHooks("beforeLoadData",e,G),x.dataSource=e,L.data=e,L.dataType=U.dataType,L.colToProp=x.colToProp.bind(x),L.propToCol=x.propToCol.bind(x),L.countCachedColumns=x.countCachedColumns.bind(x),X.clearCellsCache(),U.initIndexMappers(),D.adjustRowsAndCols(),U.runHooks("afterLoadData",e,G),G?G=[null,"loadData"]:(U.runHooks("afterChange",null,"loadData"),U.render())},this.initIndexMappers=function(){var e=K.columns,t=0;if(Array.isArray(e))t=e.length;else if(Object(i.isFunction)(e))if("array"===U.dataType)for(var n=this.countSourceCols(),r=0;r<n;r+=1)e(r)&&(t+=1);else"object"!==U.dataType&&"function"!==U.dataType||(t=x.colToPropCache.length);else if(Object(a.isDefined)(K.dataSchema)){var o=x.getSchema();t=Array.isArray(o)?o.length:Object(u.deepObjectSize)(o)}else t=this.countSourceCols();this.columnIndexMapper.initToLength(t),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,r){return Object(a.isUndefined)(e)?x.getAll():x.getRange(new E.a(e,t),new E.a(n,r),x.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,r){return x.getCopyableText(new E.a(e,t),new E.a(n,r))},this.getCopyableData=function(e,t){return x.getCopyable(e,x.colToProp(t))},this.getSchema=function(){return x.getSchema()},this.updateSettings=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=!1;if(Object(a.isDefined)(e.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(Object(a.isDefined)(e.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(t in e)"data"!==t&&("language"!==t?"className"===t?ee("className",e.className):"tableClassName"===t&&U.table?(ee("tableClassName",e.tableClassName),U.view.wt.wtOverlays.syncOverlayTableClassNames()):S.a.getSingleton().isRegistered(t)||S.a.getSingleton().isDeprecated(t)?(Object(i.isFunction)(e[t])||Array.isArray(e[t]))&&(e[t].initialHook=!0,U.addHook(t,e[t])):!r&&Object(u.hasOwnProperty)(e,t)&&(Y[t]=e[t]):J(e.language));void 0===e.data&&void 0===K.data?U.loadData(null):void 0!==e.data?U.loadData(e.data):void 0!==e.columns&&(x.createMap(),U.initIndexMappers());var l=U.countCols(),s=K.columns;if(s&&Object(i.isFunction)(s)&&(o=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||X.clearCache(),l>0)for(t=0,n=0;t<l;t++){if(s){var c=o?s(t):s[n];c&&X.updateColumnMeta(n,c)}n+=1}Object(a.isDefined)(e.cell)&&Object(u.objectEach)(e.cell,(function(e){U.setCellMetaObject(e.row,e.col,e)})),U.runHooks("afterCellMetaReset");var f=U.rootElement.style.height;""!==f&&(f=parseInt(U.rootElement.style.height,10));var h=e.height;if(Object(i.isFunction)(h)&&(h=h()),r){var d=U.rootElement.getAttribute("style");d&&U.rootElement.setAttribute("data-initialstyle",U.rootElement.getAttribute("style"))}if(null===h){var p=U.rootElement.getAttribute("data-initialstyle");p&&(p.indexOf("height")>-1||p.indexOf("overflow")>-1)?U.rootElement.setAttribute("style",p):(U.rootElement.style.height="",U.rootElement.style.overflow="")}else void 0!==h&&(U.rootElement.style.height=isNaN(h)?"".concat(h):"".concat(h,"px"),U.rootElement.style.overflow="hidden");if(void 0!==e.width){var v=e.width;Object(i.isFunction)(v)&&(v=v()),U.rootElement.style.width=isNaN(v)?"".concat(v):"".concat(v,"px")}if(void 0!==e.selectionStyle){if(!Object(u.isObject)(e.selectionStyle))throw new Error("The value of the option `selectionStyle` must be an object. To reset `selectionStyle` to the defaults, provide an empty object as the value.");this.selection.updateBorderStyle(e.selectionStyle)}r||(U.view&&U.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),U.runHooks("afterUpdateSettings",e)),D.adjustRowsAndCols(),U.view&&!G&&(U.forceFullRender=!0,B.lockEditor(),U._refreshBorders(null),B.unlockEditor()),r||!U.view||""!==f&&""!==h&&void 0!==h||f===h||U.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=U.getSelectedLast();if(K.getValue){if(Object(i.isFunction)(K.getValue))return K.getValue.call(U);if(e)return U.getData()[e[0][0]][K.getValue]}else if(e)return U.getDataAtCell(e[0],e[1])},this.getSettings=function(){return K},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,r,o){D.alter(e,t,n,r,o)},this.getCell=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,o=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;o=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===o||null===r?null:U.view.getCellAtCoords(new E.a(o,r),n)},this.getCoords=function(e){var t=this.view.wt.wtTable.getCoords(e);if(null===t)return null;var n=t.row,r=t.col,o=n,i=r;return n>=0&&(o=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(i=this.columnIndexMapper.getVisualFromRenderableIndex(r)),new E.a(o,i)},this.colToProp=function(e){return x.colToProp(e)},this.propToCol=function(e){return x.propToCol(e)},this.toVisualRow=function(e){return F.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return F.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return F.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return F.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return x.get(e,x.colToProp(t))},this.getDataAtRowProp=function(e,t){return x.get(e,t)},this.getDataAtCol=function(e){var t;return(t=[]).concat.apply(t,I(x.getRange(new E.a(0,e),new E.a(K.data.length-1,e),x.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,n=x.getRange(new E.a(0,x.propToCol(e)),new E.a(K.data.length-1,x.propToCol(e)),x.DESTINATION_RENDERER);return(t=[]).concat.apply(t,I(n))},this.getSourceData=function(e,t,n,r){return void 0===e?L.getData():L.getByRange(new E.a(e,t),new E.a(n,r))},this.getSourceDataArray=function(e,t,n,r){return void 0===e?L.getData(!0):L.getByRange(new E.a(e,t),new E.a(n,r),!0)},this.getSourceDataAtCol=function(e){return L.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,r){var o=ie(e,t,n),i=[];o.forEach((function(e,t){var n=H(e,3),r=n[0],a=n[1],l=n[2];i.push([o[t][0],o[t][1],L.getAtCell(o[t][0],o[t][1]),o[t][2]]),L.setAtCell(r,a,l)})),this.runHooks("afterSetSourceDataAtCell",i,r),this.render()},this.getSourceDataAtRow=function(e){return L.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return L.getAtCell(e,t)},this.getDataAtRow=function(e){return x.getRange(new E.a(e,0),new E.a(e,this.countCols()-1),x.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){var o=this,i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],a=i[0],l=i[1],s=i[2],c=i[3],u=null,f=null;void 0===s&&(s=a),void 0===c&&(c=l);var h="mixed";return Object(g.rangeEach)(Math.max(Math.min(a,s),0),Math.max(a,s),(function(e){var t=!0;return Object(g.rangeEach)(Math.max(Math.min(l,c),0),Math.max(l,c),(function(n){var r=o.getCellMeta(e,n);return f=r.type,u?t=u===f:u=f,t})),h=t?f:"mixed",t})),h},this.removeCellMeta=function(e,t,n){var r=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],o=r[0],i=r[1],a=X.getCellMeta(o,i,n);!1!==U.runHooks("beforeRemoveCellMeta",e,t,n,a)&&(X.removeCellMeta(o,i,n),U.runHooks("afterRemoveCellMeta",e,t,n,a)),a=null},this.spliceCellsMeta=function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];if(o.length>0&&!Array.isArray(o[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&X.removeRow(this.toPhysicalRow(e),n),o.length>0&&Object(f.arrayEach)(o.reverse(),(function(n){X.createRow(t.toPhysicalRow(e)),Object(f.arrayEach)(n,(function(n,r){return t.setCellMetaObject(e,r,n)}))}))},this.setCellMetaObject=function(e,t,n){var r=this;"object"===_(n)&&Object(u.objectEach)(n,(function(n,o){r.setCellMeta(e,t,o,n)}))},this.setCellMeta=function(e,t,n,r){if(!1!==U.runHooks("beforeSetCellMeta",e,t,n,r)){var o=e,i=t;e<this.countRows()&&(o=this.toPhysicalRow(e)),t<this.countCols()&&(i=this.toPhysicalColumn(t)),X.setCellMeta(o,i,n,r),U.runHooks("afterSetCellMeta",e,t,n,r)}},this.getCellsMeta=function(){return X.getCellsMeta()},this.getCellMeta=function(e,t){var n=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);null===n&&(n=e),null===r&&(r=t);var o=x.colToProp(t),i=X.getCellMeta(n,r);if(i.row=n,i.col=r,i.visualRow=e,i.visualCol=t,i.prop=o,i.instance=U,U.runHooks("beforeGetCellMeta",e,t,i),U.hasHook("beforeGetCellMeta")&&Object(u.hasOwnProperty)(i,"type")&&X.updateCellMeta(n,r,{type:i.type}),i.cells){var a=i.cells(n,r,o);a&&X.updateCellMeta(n,r,a)}return U.runHooks("afterGetCellMeta",e,t,i),i},this.getCellMetaAtRow=function(e){return X.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===U.dataType||K.columns)};var ae=Object(w.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(e,t){return Object(p.b)(ae.call(this,e,t))},this.getCellEditor=Object(w.cellMethodLookupFactory)("editor");var le=Object(w.cellMethodLookupFactory)("validator");this.getCellValidator=function(e,t){var n=le.call(this,e,t);return"string"==typeof n&&(n=Object(v.b)(n)),n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){var r=new te;e&&(r.onQueueEmpty=e);for(var o=U.countRows()-1;o>=0;)if(void 0===t||-1!==t.indexOf(o)){for(var i=U.countCols()-1;i>=0;)void 0===n||-1!==n.indexOf(i)?(r.addValidatorToQueue(),U.validateCell(U.getDataAtCell(o,i),U.getCellMeta(o,i),(function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),i-=1):i-=1;o-=1}else o-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=K.rowHeaders,n=e;return void 0!==n&&(n=U.runHooks("modifyRowHeader",n)),void 0===n?(t=[],Object(g.rangeEach)(U.countRows()-1,(function(e){t.push(U.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:Object(i.isFunction)(t)?t=t(n):t&&"string"!=typeof t&&"number"!=typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!K.rowHeaders},this.hasColHeaders=function(){if(void 0!==K.colHeaders&&null!==K.colHeaders)return!!K.colHeaders;for(var e=0,t=U.countCols();e<t;e++)if(U.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=U.runHooks("modifyColHeader",e),n=K.colHeaders;if(void 0===t){for(var r=[],o=U.countCols(),a=0;a<o;a++)r.push(U.getColHeader(a));n=r}else{var l=U.toPhysicalColumn(t),s=function(e){for(var t=[],n=U.countCols(),r=0;r<n;r++)Object(i.isFunction)(K.columns)&&K.columns(r)&&t.push(r);return t[e]}(l);!1===K.colHeaders?n=null:K.columns&&Object(i.isFunction)(K.columns)&&K.columns(s)&&K.columns(s).title?n=K.columns(s).title:K.columns&&K.columns[l]&&K.columns[l].title?n=K.columns[l].title:Array.isArray(K.colHeaders)&&void 0!==K.colHeaders[l]?n=K.colHeaders[l]:Object(i.isFunction)(K.colHeaders)?n=K.colHeaders(l):K.colHeaders&&"string"!=typeof K.colHeaders&&"number"!=typeof K.colHeaders&&(n=Object(w.spreadsheetColumnLabel)(t))}return n},this._getColWidthFromSettings=function(e){var t;e>=0&&(t=U.getCellMeta(0,e).width);if(void 0!==t&&t!==K.width||(t=K.colWidths),null!=t){switch(_(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){var t=U._getColWidthFromSettings(e);return void 0===(t=U.runHooks("modifyColWidth",t,e))&&(t=E.d.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=K.rowHeights;if(null!=t){switch(_(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=U._getRowHeightFromSettings(e);return t=U.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return L.countRows()},this.countSourceCols=function(){return L.countFirstRowKeys()},this.countRows=function(){return x.getLength()},this.countCols=function(){var e=K.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return U.view.wt.drawn?U.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return U.view.wt.drawn?U.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return U.view.wt.drawn?U.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return U.view.wt.drawn?U.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return Object(g.rangeEachReverse)(U.countRows()-1,(function(n){if(U.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(U.countRows()<1)return 0;var t=0;return Object(g.rangeEachReverse)(U.countCols()-1,(function(n){if(U.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return K.isEmptyRow.call(U,e)},this.isEmptyCol=function(e){return K.isEmptyCol.call(U,e)},this.selectCell=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Object(a.isUndefined)(e)&&!Object(a.isUndefined)(t)&&this.selectCells([[e,t,n,r]],o,i)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===t&&(W=!0);var r=Q.selectCells(e);return r&&n&&U.listen(),W=!1,r},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return Q.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return Q.selectRows(e,t)},this.deselectCell=function(){Q.deselect()},this.selectAll=function(){W=!0,Q.selectAll(),W=!1};var se=function(e,t){return e.getFirstNotHiddenIndex(t,1,!0)};function ce(e){return function(){throw new Error('The "'.concat(e,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.scrollViewportTo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!n,a=!r,l=e,s=t;if(o){var c=Number.isInteger(e),u=Number.isInteger(t),f=c?se(this.rowIndexMapper,e):void 0,h=u?se(this.columnIndexMapper,t):void 0;if(null===f||null===h)return!1;l=c?U.rowIndexMapper.getRenderableFromVisualIndex(f):void 0,s=u?U.columnIndexMapper.getRenderableFromVisualIndex(h):void 0}var d=Number.isInteger(l),p=Number.isInteger(s);return d&&p?U.view.scrollViewport(new E.a(l,s),i,r,n,a):d&&!1===p?U.view.scrollViewportVertically(l,i,n):!(!p||!1!==d)&&U.view.scrollViewportHorizontally(s,r,a)},this.destroy=function(){if(U._clearTimeouts(),U._clearImmediates(),U.view&&U.view.destroy(),L&&L.destroy(),L=null,X.clearCache(),Object(j.c)(),Object(O.b)(U)){var e=this.rootDocument.querySelector("#hot-display-license-info");e&&e.parentNode.removeChild(e)}Object(o.empty)(U.rootElement),z.destroy(),B&&B.destroy(),U.executeBatchOperations((function(){U.runHooks("afterDestroy")})),S.a.getSingleton().destroy(U),Object(u.objectEach)(U,(function(e,t,n){Object(i.isFunction)(e)?n[t]=ce(t):"guid"!==t&&(n[t]=null)})),U.isDestroyed=!0,x&&x.destroy(),U.rowIndexMapper=null,U.columnIndexMapper=null,x=null,D=null,Q=null,B=null,U=null},this.getActiveEditor=function(){return B.getActiveEditor()},this.getPlugin=function(e){return Object(d.a)(this,e)},this.getInstance=function(){return U},this.addHook=function(e,t){S.a.getSingleton().add(e,t,U)},this.hasHook=function(e){return S.a.getSingleton().has(e,U)},this.addHookOnce=function(e,t){S.a.getSingleton().once(e,t,U)},this.removeHook=function(e,t){S.a.getSingleton().remove(e,t,U)},this.runHooks=function(e,t,n,r,o,i,a){return S.a.getSingleton().run(U,e,t,n,r,o,i,a)},this.getTranslatedPhrase=function(e,t){return Object(R.a)(K.language,e,t)},this.toHTML=function(){return Object(h.instanceToHTML)(F)},this.toTableElement=function(){var e=F.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",Object(h.instanceToHTML)(F)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;"function"==typeof n&&(n=setTimeout(n,t)),this.timeouts.push(n)},this._clearTimeouts=function(){Object(f.arrayEach)(this.timeouts,(function(e){clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(t){this.immediates.push(e(t))},this._clearImmediates=function(){Object(f.arrayEach)(this.immediates,(function(e){r(e)}))},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];B.destroyEditor(e),U.view.render(),t&&Q.isSelected()&&B.prepareEditor()},S.a.getSingleton().run(U,"construct")}}).call(this,n(236).setImmediate,n(236).clearImmediate)},,function(e,t,n){"use strict";var r=n(157),o=n(166),i=n(178),a=n(161),l=n(214);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t,n){return(c=u()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&f(o,n.prototype),o}).apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var y=new WeakMap,g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.eventManager=new o.a(t),this.settings=t.getSettings(),this.THEAD=void 0,this.TBODY=void 0,this.wt=void 0,this.activeWt=void 0,y.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}var t,n,u;return t=e,(n=[{key:"render",value:function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1}},{key:"getCellAtCoords",value:function(e,t){var n=this.wt.getCell(e,t);return n<0?null:n}},{key:"scrollViewport",value:function(e,t,n,r,o){return this.wt.scrollViewport(e,t,n,r,o)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this.wt.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this.wt.scrollViewportVertically(e,t,n)}},{key:"createElements",value:function(){var e=y.get(this),t=this.instance,n=t.rootElement,o=t.rootDocument,i=n.getAttribute("style");i&&n.setAttribute("data-originalstyle",i),Object(r.addClass)(n,"handsontable"),e.table=o.createElement("TABLE"),Object(r.addClass)(e.table,"htCore"),this.instance.getSettings().tableClassName&&Object(r.addClass)(e.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,t=y.get(this),n=this.instance,o=n.rootElement,a=n.rootDocument,l=a.documentElement;this.eventManager.addEventListener(o,"mousedown",(function(n){if(t.selectionMouseDown=!0,!e.isTextSelectionAllowed(n.target)){var o=e.instance.rootWindow;Object(r.clearTextSelection)(o),n.preventDefault(),o.focus()}})),this.eventManager.addEventListener(o,"mouseup",(function(){t.selectionMouseDown=!1})),this.eventManager.addEventListener(o,"mousemove",(function(n){t.selectionMouseDown&&!e.isTextSelectionAllowed(n.target)&&(e.settings.fragmentSelection&&Object(r.clearTextSelection)(e.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(l,"keyup",(function(t){e.instance.selection.isInProgress()&&!t.shiftKey&&e.instance.selection.finish()})),this.eventManager.addEventListener(l,"mouseup",(function(n){e.instance.selection.isInProgress()&&Object(i.isLeftClick)(n)&&e.instance.selection.finish(),t.mouseDown=!1,(Object(r.isOutsideInput)(a.activeElement)||!e.instance.selection.isSelected()&&!Object(i.isRightClick)(n))&&e.instance.unlisten()})),this.eventManager.addEventListener(l,"contextmenu",(function(n){e.instance.selection.isInProgress()&&Object(i.isRightClick)(n)&&(e.instance.selection.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(l,"touchend",(function(){e.instance.selection.isInProgress()&&e.instance.selection.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(l,"mousedown",(function(n){var i=n.target,s=n.x||n.clientX,c=n.y||n.clientY,u=n.target;if(!t.mouseDown&&o&&e.instance.view){var f=e.instance.view.wt.wtTable.holder;if(u===f){var h=Object(r.getScrollbarWidth)(a);if(a.elementFromPoint(s+h,c)!==f||a.elementFromPoint(s,c+h)!==f)return}else for(;u!==l;){if(null===u){if(n.isTargetWebComponent)break;return}if(u===o)return;u=u.parentNode}("function"==typeof e.settings.outsideClickDeselects?e.settings.outsideClickDeselects(i):e.settings.outsideClickDeselects)?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(t.table,"selectstart",(function(t){e.settings.fragmentSelection||Object(r.isInput)(t.target)||t.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(e){var t=e.row,n=e.col;return c(a.a,h(this.translateFromRenderableToVisualIndex(t,n)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,t){var n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}},{key:"countRenderableColumns",value:function(){return Math.min(this.instance.columnIndexMapper.getRenderableIndexesLength(),this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return Math.min(this.instance.rowIndexMapper.getRenderableIndexesLength(),this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,t,n,r){if(isNaN(e)||e<0)return 0;var o=n.getFirstNotHiddenIndex(e,t),i=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(i))return 0;var a=0;return t<0?a=i+1:t>0&&(a=r-i),a}},{key:"initializeWalkontable",value:function(){var e=this,t=y.get(this),n={externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(t,n){var r;return(r=e.instance).getDataAtCell.apply(r,h(e.translateFromRenderableToVisualIndex(t,n)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsLeft:function(){var t=parseInt(e.settings.fixedColumnsLeft,10);return e.countNotHiddenColumnIndexes(t-1,-1)},fixedRowsTop:function(){var t=parseInt(e.settings.fixedRowsTop,10);return e.countNotHiddenRowIndexes(t-1,-1)},fixedRowsBottom:function(){var t=parseInt(e.settings.fixedRowsBottom,10);return e.countNotHiddenRowIndexes(e.instance.countRows()-t,1)},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var t=[];return e.instance.hasRowHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;e.appendRowHeader(r,n)})),e.instance.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.instance.hasColHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;e.appendColHeader(r,n)})),e.instance.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:function(t){var n=e.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getColWidth(null===n?t:n)},rowHeight:function(t){var n=e.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getRowHeight(null===n?t:n)},cellRenderer:function(t,n,r){var o=s(e.translateFromRenderableToVisualIndex(t,n),2),i=o[0],a=o[1],l=e.instance.getCellMeta(i,a),c=e.instance.colToProp(a),u=e.instance.getDataAtRowProp(i,c);e.instance.hasHook("beforeValueRender")&&(u=e.instance.runHooks("beforeValueRender",u,l)),e.instance.runHooks("beforeRenderer",r,i,a,c,u,l),e.instance.getCellRenderer(l)(e.instance,r,i,a,c,u,l),e.instance.runHooks("afterRenderer",r,i,a,c,u,l)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(n,r,o,a){var s=e.translateFromRenderableToVisualCoords(r),c={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=a,t.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",n,s,o,c),Object(i.isImmediatePropagationStopped)(n)||(Object(l.a)(n,{coords:s,selection:e.instance.selection,controller:c}),e.instance.runHooks("afterOnCellMouseDown",n,s,o),e.activeWt=e.wt)},onCellContextMenu:function(n,r,o,a){var l=e.translateFromRenderableToVisualCoords(r);e.activeWt=a,t.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",n,l,o),Object(i.isImmediatePropagationStopped)(n)||(e.instance.runHooks("afterOnCellContextMenu",n,l,o),e.activeWt=e.wt)},onCellMouseOut:function(t,n,r,o){var a=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseOut",t,a,r),Object(i.isImmediatePropagationStopped)(t)||(e.instance.runHooks("afterOnCellMouseOut",t,a,r),e.activeWt=e.wt)},onCellMouseOver:function(n,r,o,a){var s=e.translateFromRenderableToVisualCoords(r),c={row:!1,column:!1,cell:!1};e.activeWt=a,e.instance.runHooks("beforeOnCellMouseOver",n,s,o,c),Object(i.isImmediatePropagationStopped)(n)||(t.mouseDown&&Object(l.a)(n,{coords:s,selection:e.instance.selection,controller:c}),e.instance.runHooks("afterOnCellMouseOver",n,s,o),e.activeWt=e.wt)},onCellMouseUp:function(t,n,r,o){var a=e.translateFromRenderableToVisualCoords(n);e.activeWt=o,e.instance.runHooks("beforeOnCellMouseUp",t,a,r),Object(i.isImmediatePropagationStopped)(t)||(e.instance.runHooks("afterOnCellMouseUp",t,a,r),e.activeWt=e.wt)},onCellCornerMouseDown:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,n){return e.beforeRender(t,n)},onDraw:function(t){return e.onDraw(t)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onAfterDrawSelection:function(t,n,r,o){var i=s(e.translateFromRenderableToVisualIndex(t,n),2),a=i[0],l=i[1];return e.instance.runHooks("afterDrawSelection",a,l,r,o)},onBeforeDrawBorders:function(t,n){var r=s(t,4),o=r[0],i=r[1],a=r[2],l=r[3],c=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(o),e.instance.columnIndexMapper.getVisualFromRenderableIndex(i),e.instance.rowIndexMapper.getVisualFromRenderableIndex(a),e.instance.columnIndexMapper.getVisualFromRenderableIndex(l)];return e.instance.runHooks("beforeDrawBorders",c,n)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){var r=e.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return e.instance.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:function(t){return e.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,n,r){var o=n>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(n):n,i=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;return e.instance.runHooks("modifyGetCellCoords",i,o,r)},viewportRowCalculatorOverride:function(t){var n=e.settings.viewportRowRenderingOffset;if("auto"===n&&e.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=e.countRenderableRows();if("number"==typeof n)t.startRow=Math.max(t.startRow-n,0),t.endRow=Math.min(t.endRow+n,r-1);else if("auto"===n){var o=t.startRow+t.endRow-t.startRow,i=Math.ceil(o/r*12);t.startRow=Math.max(t.startRow-i,0),t.endRow=Math.min(t.endRow+i,r-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var n=e.settings.viewportColumnRenderingOffset;if("auto"===n&&e.settings.fixedColumnsLeft&&(n=10),n>0||"auto"===n){var r=e.countRenderableColumns();if("number"==typeof n&&(t.startColumn=Math.max(t.startColumn-n,0),t.endColumn=Math.min(t.endColumn+n,r-1)),"auto"===n){var o=t.startColumn+t.endColumn-t.startColumn,i=Math.ceil(o/r*12);t.startRow=Math.max(t.startColumn-i,0),t.endColumn=Math.min(t.endColumn+i,r-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",n),this.wt=new a.e(n),this.activeWt=this.wt;var o=this.wt.wtTable.spreader,c=Object(r.getBoundingClientRect)(this.instance.rootElement),u=c.width,f=c.height;this.setLastSize(u,f),this.eventManager.addEventListener(o,"mousedown",(function(e){e.target===o&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(o,"contextmenu",(function(e){e.target===o&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){e.settings.observeDOMVisibility&&e.wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())}))}},{key:"isTextSelectionAllowed",value:function(e){if(Object(r.isInput)(e))return!0;var t=Object(r.isChildOf)(e,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return y.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e=s(this.instance.getSelectedLast()||[],4),t=e[0],n=e[1],r=e[2],o=e[3];return void 0!==t&&t===r&&n===o}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,t){e&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,t)}},{key:"onDraw",value:function(e){e&&this.instance.runHooks("afterRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;if(!Object(r.hasClass)(n,"relative"))return Object(r.empty)(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var o=this.instance,i=o.rootDocument,a=o.getRowHeader,l=i.createElement("div"),s=i.createElement("span");l.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,a),l.appendChild(s),t.appendChild(l)}this.instance.runHooks("afterGetRowHeader",e,t)}},{key:"appendColHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;Object(r.hasClass)(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),e,this.instance.getColHeader):(Object(r.empty)(t),this.appendColHeader(e,t))}else{var o=this.instance.rootDocument,i=o.createElement("div"),a=o.createElement("span");i.className="relative",a.className="colHeader",this.updateCellHeader(a,e,this.instance.getColHeader),i.appendChild(a),t.appendChild(i)}this.instance.runHooks("afterGetColHeader",e,t)}},{key:"updateCellHeader",value:function(e,t,n){var o=t,i=this.wt.wtOverlays.getParentOverlay(e)||this.wt;e.parentNode&&(Object(r.hasClass)(e,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(t):Object(r.hasClass)(e,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(t))),o>-1?Object(r.fastInnerHTML)(e,n(t)):(Object(r.fastInnerText)(e,String.fromCharCode(160)),Object(r.addClass)(e,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var t=this.wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}},{key:"maximumVisibleElementHeight",value:function(e){var t=this.wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}},{key:"setLastSize",value:function(e,t){var n=y.get(this),r=[e,t];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var e=y.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"mainViewIsActive",value:function(){return this.wt===this.activeWt}},{key:"destroy",value:function(){this.wt.destroy(),this.eventManager.destroy()}}])&&v(t.prototype,n),u&&v(t,u),e}();t.a=g},function(e,t,n){"use strict";var r=n(155),o=n(198),i=n(156),a=n(167),l=n(183);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];s(this,e),this.hot=t,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}var t,n,u;return t=e,(n=[{key:"modifyRowData",value:function(e){var t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var t=this,n=[];return Object(i.arrayEach)(this.data,(function(r,o){var i=t.getAtCell(o,e);n.push(i)})),n}},{key:"getAtRow",value:function(e,t,n){var o=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=void 0===t&&void 0===n,c=null,u=null;if(c=this.modifyRowData(e),Array.isArray(c))u=[],s?c.forEach((function(t,n){u[n]=o.getAtPhysicalCell(e,n,c)})):Object(a.rangeEach)(t,n,(function(n){u[n-t]=o.getAtPhysicalCell(e,n,c)}));else if(Object(r.isObject)(c)||Object(l.isFunction)(c))if(u=i?[]:{},!s||i){var f=0,h=this.countFirstRowKeys()-1;Object(a.rangeEach)(f,h,(function(a){var l=o.colToProp(a);if(a>=(t||f)&&a<=(n||h)&&!Number.isInteger(l)){var s=o.getAtPhysicalCell(e,l,c);i?u.push(s):Object(r.setProperty)(u,l,s)}}))}else Object(r.objectEach)(c,(function(t,n){Object(r.setProperty)(u,n,o.getAtPhysicalCell(e,n,c))}));return u}},{key:"setAtCell",value:function(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=Object(r.createObjectPropListener)(n);this.hot.runHooks("modifySourceData",e,this.propToCol(t),o,"set"),o.isTouched()&&(n=o.value)}Number.isInteger(t)?this.data[e][t]=n:Object(r.setProperty)(this.data[e],t,n)}}},{key:"getAtPhysicalCell",value:function(e,t,n){var o=null;if(n&&(o="string"==typeof t?Object(r.getProperty)(n,t):"function"==typeof t?t(n):n[t]),this.hot.hasHook("modifySourceData")){var i=Object(r.createObjectPropListener)(o);this.hot.runHooks("modifySourceData",e,this.colToProp(t),i,"get"),i.isTouched()&&(o=i.value)}return o}},{key:"getAtCell",value:function(e,t){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}},{key:"getByRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!1,i=null,l=null,s=null,c=null;null===t||null===n?(o=!0,i=0,s=this.countRows()-1):(i=Math.min(t.row,n.row),l=Math.min(t.col,n.col),s=Math.max(t.row,n.row),c=Math.max(t.col,n.col));var u=[];return Object(a.rangeEach)(i,s,(function(t){u.push(o?e.getAtRow(t,void 0,void 0,r):e.getAtRow(t,l,c,r))})),u}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return Object(o.countFirstRowKeys)(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}])&&c(t.prototype,n),u&&c(t,u),e}();t.a=u},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(161);function o(e,t){var n=new r.b(t),o=e.getCellMeta(t.row,t.col);if(o.rowspan||o.colspan){var i=o.rowspan||1,a=o.colspan||1;n.to=new r.a(t.row+i-1,t.col+a-1)}return n}},function(e,t,n){"use strict";function r(e){var t="undefined"!=typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){var n,r=this.first(),o=r.data("handsontable");if("string"!=typeof t){var i=t||{};return o?o.updateSettings(i):(o=new e.Core(r[0],i),r.data("handsontable",o),o.init()),r}if(o){if(void 0===o[t])throw new Error("Handsontable do not provide action: ".concat(t));for(var a,l=arguments.length,s=new Array(l>1?l-1:0),c=1;c<l;c++)s[c-1]=arguments[c];n=(a=o[t]).call.apply(a,[o].concat(s)),"destroy"===t&&r.removeData()}return n})}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}n.r(t),n.d(t,"getNormalizedDate",(function(){return r}))},,function(e,t,n){"use strict";n.r(t),n.d(t,"AutoColumnSize",(function(){return H})),n.d(t,"AutoRowSize",(function(){return X})),n.d(t,"Base",(function(){return c})),n.d(t,"CopyPaste",(function(){return Se})),n.d(t,"CustomBorders",(function(){return ze})),n.d(t,"MergeCells",(function(){return Mt})),n.d(t,"TouchScroll",(function(){return Dt}));var r=n(155),o=n(156),i=n(170);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=new WeakMap,s=null,c=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object(r.defineGetter)(this,"hot",t,{writable:!1}),l.set(this,{hooks:{}}),s=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(e){return n.onUpdateSettings(e)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}var t,n,c;return t=e,(n=[{key:"init",value:function(){this.pluginName=Object(i.b)(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),s||(s=Object(i.c)(this.hot)),s.indexOf(this.pluginName)>=0&&s.splice(s.indexOf(this.pluginName),1),s.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){l.get(this).hooks[e]=l.get(this).hooks[e]||[];var n=l.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),l.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var t=this;Object(o.arrayEach)(l.get(this).hooks[e]||[],(function(n){t.hot.removeHook(e,n)}))}},{key:"clearHooks",value:function(){var e=this,t=l.get(this).hooks;Object(r.objectEach)(t,(function(t,n){return e.removeHooks(n)})),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){Object(o.arrayEach)(this.pluginsInitializedCallbacks,(function(e){return e()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Object(r.objectEach)(this,(function(t,n){"hot"!==n&&(e[n]=null)})),delete this.t,delete this.hot}}])&&a(t.prototype,n),c&&a(t,c),e}(),u=n(176),f=n(216),h=n(167),d=n(163);function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}var y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.samples=null,this.dataFactory=t,this.customSampleCount=null,this.allowDuplicates=!1}return v(e,null,[{key:"SAMPLE_COUNT",get:function(){return 3}}]),v(e,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:e.SAMPLE_COUNT}},{key:"setSampleCount",value:function(e){this.customSampleCount=e}},{key:"setAllowDuplicates",value:function(e){this.allowDuplicates=e}},{key:"generateRowSamples",value:function(e,t){return this.generateSamples("row",t,e)}},{key:"generateColumnSamples",value:function(e,t){return this.generateSamples("col",t,e)}},{key:"generateSamples",value:function(e,t,n){var r=this,o=new Map,i="number"==typeof n?{from:n,to:n}:n,a=i.from,l=i.to;return Object(h.rangeEach)(a,l,(function(n){var i=r.generateSample(e,t,n);o.set(n,i)})),o}},{key:"generateSample",value:function(e,t,n){var o=this;if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");var i=new Map,a="row"===e?"col":"row",l=[];return Object(h.rangeEach)(t.from,t.to,(function(t){var s,c="row"===e?o.dataFactory(n,t):o.dataFactory(t,n),u=c.value,f=c.bundleCountSeed,h=f>0;s=Object(r.isObject)(u)?Object.keys(u).length:Array.isArray(u)?u.length:Object(d.stringify)(u).length,h&&(s+=f),i.has(s)||i.set(s,{needed:o.getSampleCount(),strings:[]});var p=i.get(s);p.needed&&((!(l.indexOf(u)>-1)||o.allowDuplicates||h)&&(p.strings.push(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({value:u},a,t)),l.push(u),p.needed-=1))})),i}}]),e}(),g=n(172),m=n(161),b=n(218);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t,n){return(E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t,n){return t&&S(e.prototype,t),n&&S(e,n),e}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A(e);if(t){var o=A(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return j(this,n)}}function j(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?M(e):t}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var N=new WeakMap,_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(n,e);var t=k(n);function n(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),r=t.call(this,e),N.set(M(r),{cachedColumnHeaders:[]}),r.ghostTable=new f.a(r.hot),r.samplesGenerator=new y((function(e,t){var n=r.hot.getCellMeta(e,t),o="";n.spanned||(o=r.hot.getDataAtCell(e,t));var i=0;if(n.label){var a=n.label,l=a.value,s=a.property,c="";if(l)c="function"==typeof l?l(e,t,r.hot.colToProp(t),o):l;else if(s){var u=r.hot.getDataAtRowProp(e,s);c=null!==u?u:""}i=c.length}return{value:o,bundleCountSeed:i}})),r.firstCalculation=!0,r.inProgress=!1,r.measuredColumns=0,r.columnWidthsMap=new b.b,r.addHook("beforeColumnResize",(function(e,t,n){return r.onBeforeColumnResize(e,t,n)})),r.hot.columnIndexMapper.registerMap("autoColumnSize",r.columnWidthsMap),r}return R(n,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),R(n,[{key:"isEnabled",value:function(){return!1!==this.hot.getSettings().autoColumnSize&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().autoColumnSize;t&&null!==t.useHeaders&&void 0!==t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.addHook("beforeChange",(function(t){return e.onBeforeChange(t)})),this.addHook("beforeRender",(function(t){return e.onBeforeRender(t)})),this.addHook("modifyColWidth",(function(t,n){return e.getColumnWidth(n,t)})),this.addHook("afterInit",(function(){return e.onAfterInit()})),E(A(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var e=this.findColumnsWhereHeaderWasChanged();e.length&&this.clearCache(e),E(A(n.prototype),"updatePlugin",this).call(this)}},{key:"calculateColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="number"==typeof t?{from:t,to:t}:t,a="number"==typeof n?{from:n,to:n}:n;Object(h.rangeEach)(i.from,i.to,(function(t){var n=e.hot.toPhysicalColumn(t);if(null===n&&(n=t),r||null===e.columnWidthsMap.getValueAtIndex(n)&&!e.hot._getColWidthFromSettings(n)){var i=e.samplesGenerator.generateColumnSamples(t,a);Object(o.arrayEach)(i,(function(t){var n=C(t,2),r=n[0],o=n[1];return e.ghostTable.addColumn(r,o)}))}})),this.ghostTable.columns.length&&(this.hot.executeBatchOperations((function(){e.ghostTable.getWidths((function(t,n){var r=e.hot.toPhysicalColumn(t);e.columnWidthsMap.setValueAtIndex(r,n)}))})),this.measuredColumns=i.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},r=0,o=this.hot.countCols()-1,i=null;this.inProgress=!0;var a=function a(){if(!e.hot)return Object(u.cancelAnimationFrame)(i),void(e.inProgress=!1);e.calculateColumnsWidth({from:r,to:Math.min(r+n.CALCULATION_STEP,o)},t),(r=r+n.CALCULATION_STEP+1)<o?i=Object(u.requestAnimationFrame)(a):(Object(u.cancelAnimationFrame)(i),e.inProgress=!1,e.hot.view.wt.wtOverlays.adjustElementsSizes())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateColumnsWidth({from:0,to:l},t),this.firstCalculation=!1,r=l+1),r<o?a():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoColumnSize,t=e&&Object(r.hasOwnProperty)(e,"samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,n=e&&Object(r.hasOwnProperty)(e,"allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view.wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var e=n.SYNC_CALCULATION_LIMIT,t=this.hot.countCols()-1;return Object(r.isObject)(this.hot.getSettings().autoColumnSize)&&(e=this.hot.getSettings().autoColumnSize.syncLimit,Object(g.isPercentValue)(e)?e=Object(h.valueAccordingPercent)(t,e):e>>=0),Math.min(e,t)}},{key:"getColumnWidth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&"number"==typeof r&&(r=Math.max(r,m.d.DEFAULT_WIDTH))),r}},{key:"getFirstVisibleColumn",value:function(){var e=this.hot.view.wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getFirstVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getFirstRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"getLastVisibleColumn",value:function(){var e=this.hot.view.wt;if(e.wtViewport.columnsVisibleCalculator){var t=e.wtTable.getLastVisibleColumn();if(-1!==t)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){var n=e.wtTable.getLastRenderedColumn();if(-1!==n)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var e=this.hot.getColHeader(),t=N.get(this).cachedColumnHeaders;return Object(o.arrayReduce)(e,(function(e,n,r){var o=t.length;return(o-1<r||t[r]!==n)&&e.push(r),o-1<r?t.push(n):t[r]=n,e}),[])}},{key:"clearCache",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.executeBatchOperations((function(){Object(o.arrayEach)(t,(function(t){e.columnWidthsMap.setValueAtIndex(t,null)}))})):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Object(o.arrayFilter)(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),(function(e){return null===e})).length}},{key:"onBeforeRender",value:function(){var e=this.hot.renderCall,t=this.hot.countRows(),n=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();-1!==n&&-1!==r&&t&&(this.calculateColumnsWidth({from:n,to:r},void 0,e),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout((function(){e.hot&&e.recalculateAllColumnsWidth()}),0)}},{key:"onBeforeChange",value:function(e){var t=this,n=Object(o.arrayMap)(e,(function(e){var n=C(e,2)[1];return t.hot.toPhysicalColumn(t.hot.propToCol(n))}));this.clearCache(Array.from(new Set(n)))}},{key:"onBeforeColumnResize",value:function(e,t,n){var r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}},{key:"onAfterInit",value:function(){N.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"disablePlugin",value:function(){E(A(n.prototype),"disablePlugin",this).call(this)}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap("autoColumnSize"),this.ghostTable.clean(),E(A(n.prototype),"destroy",this).call(this)}}]),n}(c);Object(i.d)("autoColumnSize",_);var H=_,I=n(157);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function D(e,t,n){return(D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=z(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t,n){return t&&B(e.prototype,t),n&&B(e,n),e}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z(e);if(t){var o=z(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return U(this,n)}}function U(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(n,e);var t=W(n);function n(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=t.call(this,e)).rowHeightsMap=void 0,r.headerHeight=null,r.ghostTable=new f.a(r.hot),r.samplesGenerator=new y((function(e,t){var n;return e>=0?n=r.hot.getDataAtCell(e,t):-1===e&&(n=r.hot.getColHeader(t)),{value:n}})),r.firstCalculation=!0,r.inProgress=!1,r.measuredRows=0,r.addHook("beforeRowResize",(function(e,t,n){return r.onBeforeRowResize(e,t,n)})),r.rowHeightsMap=new b.b,r.hot.rowIndexMapper.registerMap("autoRowSize",r.rowHeightsMap),r}return F(n,null,[{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),F(n,[{key:"isEnabled",value:function(){return!0===this.hot.getSettings().autoRowSize||Object(r.isObject)(this.hot.getSettings().autoRowSize)}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){return e.onAfterLoadData()})),this.addHook("beforeChange",(function(t){return e.onBeforeChange(t)})),this.addHook("beforeColumnResize",(function(){return e.recalculateAllRowsHeight()})),this.addHook("beforeRender",(function(t){return e.onBeforeRender(t)})),this.addHook("modifyRowHeight",(function(t,n){return e.getRowHeight(n,t)})),this.addHook("modifyColumnHeaderHeight",(function(){return e.getColumnHeaderHeight()})),D(z(n.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.headerHeight=null,D(z(n.prototype),"disablePlugin",this).call(this)}},{key:"calculateRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="number"==typeof t?{from:t,to:t}:t,a="number"==typeof n?{from:n,to:n}:n;if(null!==this.hot.getColHeader(0)){var l=this.samplesGenerator.generateRowSamples(-1,a);this.ghostTable.addColumnHeadersRow(l.get(-1))}Object(h.rangeEach)(i.from,i.to,(function(t){if(r||null===e.rowHeightsMap.getValueAtIndex(t)){var n=e.samplesGenerator.generateRowSamples(t,a);Object(o.arrayEach)(n,(function(t){var n=L(t,2),r=n[0],o=n[1];return e.ghostTable.addRow(r,o)}))}})),this.ghostTable.rows.length&&(this.hot.executeBatchOperations((function(){e.ghostTable.getHeights((function(t,n){t<0?e.headerHeight=n:e.rowHeightsMap.setValueAtIndex(e.hot.toPhysicalRow(t),n)}))})),this.measuredRows=i.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},r=0,o=this.hot.countRows()-1,i=null;this.inProgress=!0;var a=function a(){if(!e.hot)return Object(u.cancelAnimationFrame)(i),void(e.inProgress=!1);e.calculateRowsHeight({from:r,to:Math.min(r+n.CALCULATION_STEP,o)},t),(r=r+n.CALCULATION_STEP+1)<o?i=Object(u.requestAnimationFrame)(a):(Object(u.cancelAnimationFrame)(i),e.inProgress=!1,e.hot.view.wt.wtOverlays.adjustElementsSizes(!0),e.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&e.hot.view.wt.wtOverlays.leftOverlay.clone.drawClone())},l=this.getSyncCalculationLimit();this.firstCalculation&&l>=0&&(this.calculateRowsHeight({from:0,to:l},t),this.firstCalculation=!1,r=l+1),r<o?a():(this.inProgress=!1,this.hot.view.wt.wtOverlays.adjustElementsSizes(!1))}},{key:"setSamplingOptions",value:function(){var e=this.hot.getSettings().autoRowSize,t=e&&Object(r.hasOwnProperty)(e,"samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,n=e&&Object(r.hasOwnProperty)(e,"allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}},{key:"recalculateAllRowsHeight",value:function(){Object(I.isVisible)(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var e=n.SYNC_CALCULATION_LIMIT,t=this.hot.countRows()-1;return Object(r.isObject)(this.hot.getSettings().autoRowSize)&&(e=this.hot.getSettings().autoRowSize.syncLimit,Object(g.isPercentValue)(e)?e=Object(h.valueAccordingPercent)(t,e):e>>=0),Math.min(e,t)}},{key:"getRowHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),r=t;return null!==n&&n>(t||0)&&(r=n),r}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(e){var t=this,n="number"==typeof e?{from:e,to:e}:e,r=n.from,o=n.to;this.hot.executeBatchOperations((function(){Object(h.rangeEach)(Math.min(r,o),Math.max(r,o),(function(e){t.rowHeightsMap.setValueAtIndex(e,null)}))}))}},{key:"isNeedRecalculate",value:function(){return!!Object(o.arrayFilter)(this.rowHeightsMap.getValues().slice(0,this.measuredRows),(function(e){return null===e})).length}},{key:"onBeforeRender",value:function(){var e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==n&&-1!==r){if(this.calculateRowsHeight({from:n,to:r},void 0,e),t){var o=this.hot.countRows()-1;this.calculateRowsHeight({from:o-t,to:o})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(e,t,n){var r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}},{key:"onAfterLoadData",value:function(){var e=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout((function(){e.hot&&e.recalculateAllRowsHeight()}),0)}},{key:"onBeforeChange",value:function(e){var t=null;1===e.length?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)}},{key:"destroy",value:function(){this.hot.rowIndexMapper.unregisterMap("autoRowSize"),this.ghostTable.clean(),D(z(n.prototype),"destroy",this).call(this)}}]),n}(c);Object(i.d)("autoRowSize",G);var X=G,K=n(181),Y=n(241),q=n.n(Y),$=n(168);function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Z=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={}}var t,n,r;return t=e,(n=[{key:"setData",value:function(e,t){this.data[e]=t}},{key:"getData",value:function(e){return this.data[e]||void 0}}])&&Q(t.prototype,n),r&&Q(t,r),e}();var J=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clipboardData=new Z},ee=n(166),te=n(184),ne=n(169);function re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new ee.a(this),this.listenersCount=new WeakSet,this.container=t}var t,n,r;return t=e,(n=[{key:"useSecondaryElement",value:function(){var e=function(e){var t=se.get(e);if(t)return t.parentElement||e.appendChild(t),t;var n=(e.defaultView?e:e.ownerDocument).createElement("textarea");return se.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),le(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(e){this.listenersCount.has(e)||(this.listenersCount.add(e),le(this.eventManager,e,this)),this.mainElement=e}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Object(ne.isMobileBrowser)()||Object(I.selectElementIfAllowed)(this.mainElement)}}])&&re(t.prototype,n),r&&re(t,r),e}();Object(r.mixin)(oe,te.a);var ie=new WeakMap;var ae=function(e,t){return function(n){return t.runLocalHooks(e,n)}};function le(e,t,n){e.addEventListener(t,"copy",ae("copy",n)),e.addEventListener(t,"cut",ae("cut",n)),e.addEventListener(t,"paste",ae("paste",n))}var se=new WeakMap;function ce(e){if(e instanceof oe){var t=ie.get(e.container);if((t=isNaN(t)?0:t)>0&&(t-=1),function(e){e.eventManager.clear()}(e),t<=0){t=0;var n=se.get(e.container);n&&n.parentNode&&(n.parentNode.removeChild(n),se.delete(e.container)),e.mainElement=null}ie.set(e.container,t)}}var ue=n(213);function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return he(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ve(e,t,n){return(ve="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=we(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=we(e);if(t){var o=we(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return me(this,n)}}function me(e,t){return!t||"object"!==de(t)&&"function"!=typeof t?be(e):t}function be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}K.a.getSingleton().register("afterCopyLimit"),K.a.getSingleton().register("modifyCopyableRange"),K.a.getSingleton().register("beforeCut"),K.a.getSingleton().register("afterCut"),K.a.getSingleton().register("beforePaste"),K.a.getSingleton().register("afterPaste"),K.a.getSingleton().register("beforeCopy"),K.a.getSingleton().register("afterCopy");var Ce=new WeakMap,Oe=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(a,e);var t,n,r,i=ge(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).columnsLimit=1e3,t.copyableRanges=[],t.focusableElement=void 0,t.pasteMode="overwrite",t.rowsLimit=1e3,t.uiContainer=t.hot.rootDocument.body,Ce.set(be(t),{isTriggeredByCopy:!1,isTriggeredByCut:!1,isBeginEditing:!1,isFragmentSelectionEnabled:!1}),t}return t=a,(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().copyPaste}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t,n,r,o=this.hot.getSettings(),i=o.copyPaste,l=o.fragmentSelection;Ce.get(this).isFragmentSelectionEnabled=!!l,"object"===de(i)&&(this.pasteMode=i.pasteMode||this.pasteMode,this.rowsLimit=isNaN(i.rowsLimit)?this.rowsLimit:i.rowsLimit,this.columnsLimit=isNaN(i.columnsLimit)?this.columnsLimit:i.columnsLimit,this.uiContainer=i.uiContainer||this.uiContainer),this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("afterOnCellMouseUp",(function(){return e.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return e.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()})),this.focusableElement=(t=this.uiContainer,n=new oe(t),r=ie.get(t),r=isNaN(r)?0:r,ie.set(t,r+1),n),this.focusableElement.addLocalHook("copy",(function(t){return e.onCopy(t)})).addLocalHook("cut",(function(t){return e.onCut(t)})).addLocalHook("paste",(function(t){return e.onPaste(t)})),ve(we(a.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),ve(we(a.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&ce(this.focusableElement),ve(we(a.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){Ce.get(this).isTriggeredByCopy=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"cut",value:function(){Ce.get(this).isTriggeredByCut=!0,this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(e){var t=this,n=[],r=[],i=[];return Object(o.arrayEach)(e,(function(e){Object(h.rangeEach)(e.startRow,e.endRow,(function(e){-1===r.indexOf(e)&&r.push(e)})),Object(h.rangeEach)(e.startCol,e.endCol,(function(e){-1===i.indexOf(e)&&i.push(e)}))})),Object(o.arrayEach)(r,(function(e){var r=[];Object(o.arrayEach)(i,(function(n){r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),q.a.stringify(n)}},{key:"getRangedData",value:function(e){var t=this,n=[],r=[],i=[];return Object(o.arrayEach)(e,(function(e){Object(h.rangeEach)(e.startRow,e.endRow,(function(e){-1===r.indexOf(e)&&r.push(e)})),Object(h.rangeEach)(e.startCol,e.endCol,(function(e){-1===i.indexOf(e)&&i.push(e)}))})),Object(o.arrayEach)(r,(function(e){var r=[];Object(o.arrayEach)(i,(function(n){r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),n}},{key:"paste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e||t){var n=new J;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var e=this.hot.getSelectedRangeLast();if(e){var t=e.getTopLeftCorner(),n=e.getBottomRightCorner(),r=t.row,o=t.col,i=n.row,a=n.col,l=Math.min(i,r+this.rowsLimit-1),s=Math.min(a,o+this.columnsLimit-1);this.copyableRanges.length=0,this.copyableRanges.push({startRow:r,startCol:o,endRow:l,endCol:s}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges),i===l&&a===s||this.hot.runHooks("afterCopyLimit",i-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}},{key:"getOrCreateFocusableElement",value:function(){var e=this.hot.getActiveEditor(),t=e?e.TEXTAREA:void 0;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var e=this.hot.getActiveEditor();return e&&e.isOpened()}},{key:"populateValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedLast();if(e.length){for(var n=e.length-1,r=e[0].length-1,o=Math.min(t[0],t[2]),i=Math.max(t[0],t[2],n+o),a=Math.min(t[1],t[3]),l=Math.max(t[1],t[3],r+a),s=[],c=o,u=0;c<=i;c+=1){for(var f=[],h=a,d=0;h<=l;h+=1)f.push(e[u][d]),d=d===r?0:d+=1;s.push(f),u=u===n?0:u+=1}return this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,i,l]}}},{key:"onCopy",value:function(e){var t=Ce.get(this);if((this.hot.isListening()||t.isTriggeredByCopy)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCopy=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCopy",n,this.copyableRanges)){var r=q.a.stringify(n);if(e&&e.clipboardData){var o=Object(ue._dataToHTML)(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[Oe,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",n,this.copyableRanges)}e.preventDefault()}}},{key:"onCut",value:function(e){var t=Ce.get(this);if((this.hot.isListening()||t.isTriggeredByCut)&&!this.isEditorOpened()){this.setCopyableText(),t.isTriggeredByCut=!1;var n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",n,this.copyableRanges)){var r=q.a.stringify(n);if(e&&e.clipboardData){var o=Object(ue._dataToHTML)(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[Oe,o].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}}},{key:"onPaste",value:function(e){if(this.hot.isListening()&&!this.isEditorOpened()){var t;if(e&&e.preventDefault&&e.preventDefault(),e&&void 0!==e.clipboardData){var n=e.clipboardData.getData("text/html");t=n&&/(<table)|(<TABLE)/g.test(n)?Object(ue.htmlToGridSettings)(n,this.hot.rootDocument).data:e.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof t&&(t=q.a.parse(t)),(!t||0!==t.length)&&!1!==this.hot.runHooks("beforePaste",t,this.copyableRanges)){var r=fe(this.populateValues(t),4),o=r[0],i=r[1],a=r[2],l=r[3];this.hot.selectCell(o,i,Math.min(this.hot.countRows()-1,a),Math.min(this.hot.countCols()-1,l)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name:function(){return this.getTranslatedPhrase($.CONTEXTMENU_ITEMS_COPY)},callback:function(){t.copy()},disabled:function(){var e=this.getSelected();return!e||e.length>1},hidden:!1}),function(e){return{key:"cut",name:function(){return this.getTranslatedPhrase($.CONTEXTMENU_ITEMS_CUT)},callback:function(){e.cut()},disabled:function(){var e=this.getSelected();return!e||e.length>1},hidden:!1}}(this))}},{key:"onAfterOnCellMouseUp",value:function(){this.hot.isListening()&&!this.isEditorOpened()&&(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){var e=Ce.get(this).isFragmentSelectionEnabled;this.isEditorOpened()||(this.getOrCreateFocusableElement(),e&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&Object(I.getSelectionText)()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(ce(this.focusableElement),this.focusableElement=null),ve(we(a.prototype),"destroy",this).call(this)}}])&&pe(t.prototype,n),r&&pe(t,r),a}(c);Object(i.d)("CopyPaste",Ee);var Se=Ee;function Re(e,t){return"border_row".concat(e,"col").concat(t)}function Te(e,t){return{id:Re(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}}function ke(e,t){var n=!1;return Object(o.arrayEach)(e.getSelectedRange(),(function(o){o.forAll((function(o,i){var a=e.getCellMeta(o,i).borders;if(a){if(!t)return n=!0,!1;if(!Object(r.hasOwnProperty)(a[t],"hide")||!1===a[t].hide)return n=!0,!1}}))})),n}function je(e){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(e)}function Me(e){return{key:"borders:bottom",name:function(){var e=this.getTranslatedPhrase($.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return ke(this,"bottom")&&(e=je(e)),e},callback:function(t,n){var r=ke(this,"bottom");e.prepareBorder(n,"bottom",r),e.render()}}}function Ae(e){return{key:"borders:left",name:function(){var e=this.getTranslatedPhrase($.CONTEXTMENU_ITEMS_BORDERS_LEFT);return ke(this,"left")&&(e=je(e)),e},callback:function(t,n){var r=ke(this,"left");e.prepareBorder(n,"left",r),e.render()}}}function Ne(e){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase($.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback:function(t,n){e.prepareBorder(n,"noBorders"),e.render()},disabled:function(){return!ke(this)}}}function _e(e){return{key:"borders:right",name:function(){var e=this.getTranslatedPhrase($.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return ke(this,"right")&&(e=je(e)),e},callback:function(t,n){var r=ke(this,"right");e.prepareBorder(n,"right",r),e.render()}}}var He=n(243);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Le(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function De(e,t,n){return(De="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=We(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=We(e);if(t){var o=We(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ve(this,n)}}function Ve(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(l,e);var t,n,i,a=Fe(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).savedBorders=[],t.savedBordersById=new Map,t}return t=l,(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().customBorders}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("init",(function(){return e.onAfterInit()})),De(We(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),this.render(),De(We(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),De(We(l.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(e,t){var n=this,r=t?Object.keys(t):["top","right","bottom","left"],i=Object(He.b)(e),a=Object(He.c)(i);Object(o.arrayEach)(e,(function(e){for(var i=xe(a(e),4),l=i[0],s=i[1],c=i[2],u=i[3],f=function(e){for(var i=function(i){Object(o.arrayEach)(r,(function(r){n.prepareBorderFromCustomAdded(e,i,t,r)}))},a=s;a<=u;a+=1)i(a)},h=l;h<=c;h+=1)f(h)})),this.render()}},{key:"render",value:function(){this.hot.view.render()}},{key:"getBorders",value:function(e){var t=this;if(!Array.isArray(e))return this.savedBorders;var n=Object(He.b)(e),r=Object(He.c)(n),i=[];return Object(o.arrayEach)(e,(function(e){for(var n=xe(r(e),4),a=n[0],l=n[1],s=n[2],c=n[3],u=function(e){for(var n=function(n){Object(o.arrayEach)(t.savedBorders,(function(t){t.row===e&&t.col===n&&i.push(t)}))},r=l;r<=c;r+=1)n(r)},f=a;f<=s;f+=1)u(f)})),i}},{key:"clearBorders",value:function(e){var t=this;e?this.setBorders(e):(Object(o.arrayEach)(this.savedBorders,(function(e){t.clearBordersFromSelectionSettings(e.id),t.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0,this.savedBordersById.clear()),this.render()}},{key:"insertBorderIntoSettings",value:function(e){var t=this.savedBordersById.get(e.id);if(t){var n=this.savedBorders.indexOf(t);this.savedBorders[n]=e}else this.savedBorders.push(e);this.savedBordersById.set(e.id,e);var r={row:e.row,col:e.col},o=new m.b(r,r,r);this.checkCustomSelections(e,o)||this.hot.selection.highlight.addCustomSelection(e.id,{border:e,cellRange:o})}},{key:"prepareBorderFromCustomAdded",value:function(e,t,n,o){var i,a,l=Te(e,t);if(n){i=l,a=n,Object(r.hasOwnProperty)(a,"border")&&(i.border=a.border),Object(r.hasOwnProperty)(a,"top")&&(a.top?(Object(r.isObject)(a.top)||(a.top={width:1,color:"#000"}),i.top=a.top):(a.top={hide:!0},i.top=a.top)),Object(r.hasOwnProperty)(a,"right")&&(a.right?(Object(r.isObject)(a.right)||(a.right={width:1,color:"#000"}),i.right=a.right):(a.right={hide:!0},i.right=a.right)),Object(r.hasOwnProperty)(a,"bottom")&&(a.bottom?(Object(r.isObject)(a.bottom)||(a.bottom={width:1,color:"#000"}),i.bottom=a.bottom):(a.bottom={hide:!0},i.bottom=a.bottom)),Object(r.hasOwnProperty)(a,"left")&&(a.left?(Object(r.isObject)(a.left)||(a.left={width:1,color:"#000"}),i.left=a.left):(a.left={hide:!0},i.left=a.left)),l=i;var s=this.hot.selection.highlight.customSelections.get(l.id);s&&(Object.assign(s.settings,n),l=s.settings)}this.hot.setCellMeta(e,t,"borders",l),this.insertBorderIntoSettings(l,o)}},{key:"prepareBorderFromCustomAddedRange",value:function(e){var t=this,n=e.range;Object(h.rangeEach)(n.from.row,n.to.row,(function(o){Object(h.rangeEach)(n.from.col,n.to.col,(function(i){var a=Te(o,i),l=0;o===n.from.row&&Object(r.hasOwnProperty)(e,"top")&&(l+=1,a.top=e.top),o===n.to.row&&Object(r.hasOwnProperty)(e,"bottom")&&(l+=1,a.bottom=e.bottom),i===n.from.col&&Object(r.hasOwnProperty)(e,"left")&&(l+=1,a.left=e.left),i===n.to.col&&Object(r.hasOwnProperty)(e,"right")&&(l+=1,a.right=e.right),l>0&&(t.hot.setCellMeta(o,i,"borders",a),t.insertBorderIntoSettings(a))}))}))}},{key:"removeAllBorders",value:function(e,t){var n=Re(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.hot.removeCellMeta(e,t,"borders")}},{key:"setBorder",value:function(e,t,n,r){var o=this.hot.getCellMeta(e,t).borders;o&&void 0!==o.border||(o=Te(e,t)),r?(o[n]={hide:!0},this.areAllEdgesDisabled(o)?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",o))):(o[n]={width:1,color:"#000"},this.checkCustomSelectionsFromContextMenu(o,n,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,t,"borders",o))}},{key:"prepareBorder",value:function(e,t,n){var r=this;Object(o.arrayEach)(e,(function(e){var o=e.start,i=e.end;if(o.row===i.row&&o.col===i.col)"noBorders"===t?r.removeAllBorders(o.row,o.col):r.setBorder(o.row,o.col,t,n);else switch(t){case"noBorders":Object(h.rangeEach)(o.col,i.col,(function(e){Object(h.rangeEach)(o.row,i.row,(function(t){r.removeAllBorders(t,e)}))}));break;case"top":Object(h.rangeEach)(o.col,i.col,(function(e){r.setBorder(o.row,e,t,n)}));break;case"right":Object(h.rangeEach)(o.row,i.row,(function(e){r.setBorder(e,i.col,t,n)}));break;case"bottom":Object(h.rangeEach)(o.col,i.col,(function(e){r.setBorder(i.row,e,t,n)}));break;case"left":Object(h.rangeEach)(o.row,i.row,(function(e){r.setBorder(e,o.col,t,n)}))}}))}},{key:"createCustomBorders",value:function(e){var t=this;Object(o.arrayEach)(e,(function(e){e.range?t.prepareBorderFromCustomAddedRange(e):t.prepareBorderFromCustomAdded(e.row,e.col,e)}))}},{key:"areAllEdgesDisabled",value:function(e){return!(this.isEdgeEnabled(e.left)||this.isEdgeEnabled(e.right)||this.isEdgeEnabled(e.top)||this.isEdgeEnabled(e.bottom))}},{key:"isEdgeEnabled",value:function(e){return void 0===e||void 0===e.hide||!e.hide}},{key:"clearBordersFromSelectionSettings",value:function(e){var t=this.hot.selection.highlight.customSelections.get(e);t&&(t.clear(),this.hot.selection.highlight.customSelections.delete(t.settings.id))}},{key:"hideBorders",value:function(){var e=this;Object(o.arrayEach)(this.savedBorders,(function(t){e.clearBordersFromSelectionSettings(t.id)}))}},{key:"spliceBorder",value:function(e){var t=this.savedBordersById.get(e);if(t){var n=this.savedBorders.indexOf(t);this.savedBorders.splice(n,1),this.savedBordersById.delete(e)}}},{key:"checkCustomSelectionsFromContextMenu",value:function(e){return this.hot.selection.highlight.customSelections.has(e.id)}},{key:"checkCustomSelections",value:function(e,t){if(this.areAllEdgesDisabled(e))return this.removeAllBorders(e.row,e.col),!0;var n=this.hot.selection.highlight.customSelections.get(e.id);return!!n&&(n.cellRange=t,!0)}},{key:"changeBorderSettings",value:function(){var e=this.hot.getSettings().customBorders;Array.isArray(e)?(e.length||(this.savedBorders=e),this.createCustomBorders(e)):void 0!==e&&this.createCustomBorders(this.savedBorders)}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;this.hot.getSettings().customBorders&&e.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase($.CONTEXTMENU_ITEMS_BORDERS)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[(t=this,{key:"borders:top",name:function(){var e=this.getTranslatedPhrase($.CONTEXTMENU_ITEMS_BORDERS_TOP);return ke(this,"top")&&(e=je(e)),e},callback:function(e,n){var r=ke(this,"top");t.prepareBorder(n,"top",r),t.render()}}),_e(this),Me(this),Ae(this),Ne(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){De(We(l.prototype),"destroy",this).call(this)}}])&&Pe(t.prototype,n),i&&Pe(t,i),l}(c);Object(i.d)("customBorders",Ue);var ze=Ue,Ge=n(178),Xe=n(175);function Ke(){var e=Qe(["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as \n      "0", which is not supported. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has "rowspan" or "colspan" declared as\\x20\n      "0", which is not supported. It cannot be added to the collection.']);return Ke=function(){return e},e}function Ye(){var e=Qe(["The merged cell declared at [",", ",'] has both "rowspan" \n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.'],["The merged cell declared at [",", ",'] has both "rowspan"\\x20\n     and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.']);return Ye=function(){return e},e}function qe(){var e=Qe(["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."],["The merged cell declared at [",", ","] is positioned (or positioned partially)\\x20\n       outside of the table range. It was not added to the table, please fix your setup."]);return qe=function(){return e},e}function $e(){var e=Qe(["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."],["The merged cell declared with {row: ",", col: ",", rowspan:\\x20\n    ",", colspan: ","} contains negative values, which is not supported. It\\x20\n    will not be added to the collection."]);return $e=function(){return e},e}function Qe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Je=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.row=t,this.col=n,this.rowspan=r,this.colspan=o,this.removed=!1}var t,n,r;return t=e,r=[{key:"NEGATIVE_VALUES_WARNING",value:function(e){return Object(Xe.a)($e(),e.row,e.col,e.rowspan,e.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(e){return Object(Xe.a)(qe(),e.row,e.col)}},{key:"IS_SINGLE_CELL",value:function(e){return Object(Xe.a)(Ye(),e.row,e.col)}},{key:"ZERO_SPAN_WARNING",value:function(e){return Object(Xe.a)(Ke(),e.row,e.col)}},{key:"containsNegativeValues",value:function(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}},{key:"isSingleCell",value:function(e){return 1===e.colspan&&1===e.rowspan}},{key:"containsZeroSpan",value:function(e){return 0===e.colspan||0===e.rowspan}},{key:"isOutOfBounds",value:function(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}}],(n=[{key:"normalize",value:function(e){var t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}},{key:"includesHorizontally",value:function(e){return this.col<=e&&this.col+this.colspan-1>=e}},{key:"includesVertically",value:function(e){return this.row<=e&&this.row+this.rowspan-1>=e}},{key:"shift",value:function(e,t){var n=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",i=e[0]?"col":"row",a=Math.min(t,r),l=Math.max(t,r),s=this[i],c=this[i]+this[o]-1;if(s>=t&&(this[i]+=n),n>0)t<=c&&t>s&&(this[o]+=n);else if(n<0){if(a<=s&&l>=c)return this.removed=!0,!1;if(s>=a&&s<=l){var u=l-s+1,f=Math.abs(n)-u;this[i]-=f+n,this[o]-=u}else if(s<=a&&c>=l)this[o]+=n;else if(s<=a&&c>=a&&c<l){var h=c-a+1;this[o]-=h}}return!0}},{key:"isFarther",value:function(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return new m.b(new m.a(this.row,this.col),new m.a(this.row,this.col),new m.a(this.getLastRow(),this.getLastColumn()))}}])&&Ze(t.prototype,n),r&&Ze(t,r),e}(),et=n(182);function tt(e,t,n,r){t?t.row===n&&t.col===r?(e.setAttribute("rowspan",t.rowspan.toString()),e.setAttribute("colspan",t.colspan.toString())):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="")}function nt(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["The merged cell declared at [",", ","], overlaps with the other declared merged \n    cell. The overlapping merged cell was not added to the table, please fix your setup."],["The merged cell declared at [",", ","], overlaps with the other declared merged\\x20\n    cell. The overlapping merged cell was not added to the table, please fix your setup."]);return nt=function(){return e},e}function rt(e){return function(e){if(Array.isArray(e))return ot(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ot(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function it(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var at=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.mergedCells=[],this.hot=t.hot}var t,n,r;return t=e,r=[{key:"IS_OVERLAPPING_WARNING",value:function(e){return Object(Xe.a)(nt(),e.row,e.col)}}],(n=[{key:"get",value:function(e,t){var n=this.mergedCells,r=!1;return Object(o.arrayEach)(n,(function(n){return!(n.row<=e&&n.row+n.rowspan-1>=e&&n.col<=t&&n.col+n.colspan-1>=t&&(r=n,1))})),r}},{key:"getByRange",value:function(e){var t=this.mergedCells,n=!1;return Object(o.arrayEach)(t,(function(t){return!(t.row<=e.from.row&&t.row+t.rowspan-1>=e.to.row&&t.col<=e.from.col&&t.col+t.colspan-1>=e.to.col)||(n=t)})),n}},{key:"getWithinRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.mergedCells,r=[],i=e;if(!i.includesRange){var a=new m.a(i.from.row,i.from.col),l=new m.a(i.to.row,i.to.col);i=new m.b(a,a,l)}return Object(o.arrayEach)(n,(function(e){var n=new m.a(e.row,e.col),o=new m.a(e.row+e.rowspan-1,e.col+e.colspan-1),a=new m.b(n,n,o);t?i.overlaps(a)&&r.push(e):i.includesRange(a)&&r.push(e)})),!!r.length&&r}},{key:"add",value:function(t){var n=this.mergedCells,r=t.row,o=t.col,i=t.rowspan,a=t.colspan,l=new Je(r,o,i,a),s=this.get(r,o),c=this.isOverlapping(l);return s||c?(Object(et.b)(e.IS_OVERLAPPING_WARNING(l)),!1):(this.hot&&l.normalize(this.hot),n.push(l),l)}},{key:"remove",value:function(e,t){var n=this.mergedCells,r=this.get(e,t),o=r?this.mergedCells.indexOf(r):null;return!(!r||!1===o)&&(n.splice(o,1),r)}},{key:"clear",value:function(){var e=this,t=this.mergedCells,n=[],r=[];Object(o.arrayEach)(t,(function(t){var r=e.hot.getCell(t.row,t.col);r&&n.push([r,e.get(t.row,t.col),t.row,t.col])})),this.mergedCells.length=0,Object(o.arrayEach)(n,(function(t,o){Object(h.rangeEach)(0,t.rowspan-1,(function(n){Object(h.rangeEach)(0,t.colspan-1,(function(o){if(0!==o||0!==n){var i=e.hot.getCell(t.row+n,t.col+o);i&&r.push([i,null,null,null])}}))})),n[o][1]=null})),Object(o.arrayEach)(n,(function(e){tt.apply(void 0,rt(e))})),Object(o.arrayEach)(r,(function(e){tt.apply(void 0,rt(e))}))}},{key:"isOverlapping",value:function(e){var t=new m.b(null,new m.a(e.row,e.col),new m.a(e.row+e.rowspan-1,e.col+e.colspan-1)),n=!1;return Object(o.arrayEach)(this.mergedCells,(function(e){return!new m.b(null,new m.a(e.row,e.col),new m.a(e.row+e.rowspan-1,e.col+e.colspan-1)).overlaps(t)||(n=!0,!1)})),n}},{key:"isMergedParent",value:function(e,t){var n=this.mergedCells,r=!1;return Object(o.arrayEach)(n,(function(n){return n.row!==e||n.col!==t||(r=!0,!1)})),r}},{key:"shiftCollections",value:function(e,t,n){var r=this,i=[0,0];switch(e){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n}Object(o.arrayEach)(this.mergedCells,(function(e){e.shift(i,t)})),Object(h.rangeEachReverse)(this.mergedCells.length-1,0,(function(e){var t=r.mergedCells[e];t&&t.removed&&r.mergedCells.splice(r.mergedCells.indexOf(t),1)}))}}])&&it(t.prototype,n),r&&it(t,r),e}();function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return st(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return st(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ut=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}var t,n,i;return t=e,(n=[{key:"correctSelectionAreaSize",value:function(e){if(e[0]===e[2]&&e[1]===e[3]){var t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}},{key:"getDirection",value:function(e,t){return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left"}},{key:"snapDragArea",value:function(e,t,n,r){var o=t.slice(0),i=this.getAutofillSize(e,t,n),a=lt(e,4),l=a[0],s=a[1],c=a[2],u=a[3],f=["up","down"].indexOf(n)>-1?c-l+1:u-s+1,h=i-Math.floor(i/f)*f,d=this.getFarthestCollection(e,t,n,r);if(d)if("down"===n){var p=d.row+d.rowspan-l-h;o[2]+p>=this.plugin.hot.countRows()?o[2]-=h:o[2]+=h?p:0}else if("right"===n){var v=d.col+d.colspan-s-h;o[3]+v>=this.plugin.hot.countCols()?o[3]-=h:o[3]+=h?v:0}else if("up"===n){var y=c-h-d.row+1;o[0]+y<0?o[0]+=h:o[0]-=h?y:0}else if("left"===n){var g=u-h-d.col+1;o[1]+g<0?o[1]+=h:o[1]-=h?g:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:r,fillSize:i,dragArea:o,cycleLength:f}),o}},{key:"updateCurrentFillCache",value:function(e){this.currentFillData||(this.currentFillData={}),Object(r.extend)(this.currentFillData,e)}},{key:"getAutofillSize",value:function(e,t,n){var r=lt(e,4),o=r[0],i=r[1],a=r[2],l=r[3],s=lt(t,4),c=s[0],u=s[1],f=s[2],h=s[3];switch(n){case"up":return o-c;case"down":return f-a;case"left":return i-u;case"right":return h-l;default:return null}}},{key:"getDragArea",value:function(e,t,n){var r=lt(e,4),o=r[0],i=r[1],a=r[2],l=r[3],s=lt(t,4),c=s[0],u=s[1],f=s[2],h=s[3];switch(n){case"up":return[c,u,o-1,l];case"down":return[a+1,i,f,l];case"left":return[c,u,a,i-1];case"right":return[o,l+1,f,h];default:return null}}},{key:"getFarthestCollection",value:function(e,t,n,r){var i=lt(e,4),a=i[0],l=i[1],s=i[2],c=i[3],u=["up","down"].indexOf(n)>-1,f=u?s:c,h=u?a:l,d=this.getAutofillSize(e,t,n),p=u?s-a+1:c-l+1,v=d-Math.floor(d/p)*p,y=null,g=null,m=null;switch(n){case"up":y="includesVertically",m=f-v+1;break;case"left":y="includesHorizontally",m=f-v+1;break;case"down":y="includesVertically",m=h+v-1;break;case"right":y="includesHorizontally",m=h+v-1}return Object(o.arrayEach)(r,(function(e){e[y](m)&&e.isFarther(g,n)&&(g=e)})),g}},{key:"recreateAfterDataPopulation",value:function(e){if(this.currentFillData){var t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=function(e,n){switch(r){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}},i=0,a=null,l=1;do{for(var s=0;s<n.length;s+=1){if(o(a=n[s],i=l*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+i,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-i,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+i,colspan:a.colspan})}s===n.length-1&&(l+=1)}}while(o(a,i));this.currentFillData=null,this.plugin.hot.render()}}},{key:"getRangeFromChanges",value:function(e){var t=this,n={min:null,max:null},r={min:null,max:null};return Object(o.arrayEach)(e,(function(e){var o=e[0],i=t.plugin.hot.propToCol(e[1]);(null===n.min||o<n.min)&&(n.min=o),(null===n.max||o>n.max)&&(n.max=o),(null===r.min||i<r.min)&&(r.min=i),(null===r.max||i>r.max)&&(r.max=i)})),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}},{key:"dragAreaOverlapsCollections",value:function(e,t,n){var r=lt(this.getDragArea(e,t,n),4),o=r[0],i=r[1],a=r[2],l=r[3],s=new m.a(o,i),c=new m.a(a,l),u=new m.b(s,s,c);return!!this.mergedCellsCollection.getWithinRange(u,!0)}}])&&ct(t.prototype,n),i&&ct(t,i),e}();function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ht(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}var t,n,r;return t=e,(n=[{key:"snapDelta",value:function(e,t,n){var r=t.to,o=r.row+e.row,i=r.col+e.col;e.row?this.jumpOverMergedCell(e,n,o):e.col&&this.jumpOverMergedCell(e,n,i)}},{key:"jumpOverMergedCell",value:function(e,t,n){var r=e.row||e.col,o=null,i=null,a=null;e.row?(o=t.includesVertically(n),i=t.row,a=t.getLastRow()):e.col&&(o=t.includesHorizontally(n),i=t.col,a=t.getLastColumn()),0!==r&&(r>0?o&&n!==i&&(r+=a-n+1):o&&n!==a&&(r-=n-i+1),e.row?e.row=r:e.col&&(e.col=r))}},{key:"getUpdatedSelectionRange",value:function(e,t){return new m.b(e.highlight,e.from,new m.a(e.to.row+t.row,e.to.col+t.col))}},{key:"getSelectedMergedCellClassName",value:function(e,t,n,r){var o=ft(n,4),i=o[0],a=o[1],l=o[2],s=o[3];if(void 0!==r&&e>=i&&e<=l&&t>=a&&t<=s){if(!this.plugin.mergedCellsCollection.isMergedParent(e,t))return;var c=this.plugin.mergedCellsCollection.get(e,t);if(!c)return;if(c.row+c.rowspan-1<=l&&c.col+c.colspan-1<=s)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(r);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}},{key:"isMergeCellFullySelected",value:function(e,t){var n=[];if(!t||!e)return!1;for(var r=0;r<e.rowspan;r+=1)for(var o=0;o<e.colspan;o+=1)n.push(new m.a(e.row+r,e.col+o));for(var i=0;i<n.length;i+=1){for(var a=[],l=0;l<t.length;l+=1)a[l]=t[l].includes(n[i]);if(!a.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var e=[],t=0;t<=7;t+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(t));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}}])&&dt(t.prototype,n),r&&dt(t,r),e}();function vt(e){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||mt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(e){return function(e){if(Array.isArray(e))return bt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||mt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){if(e){if("string"==typeof e)return bt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(e,t):void 0}}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ct(e,t,n){return(Ct="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Tt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ot(e,t){return(Ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Tt(e);if(t){var o=Tt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return St(this,n)}}function St(e,t){return!t||"object"!==vt(t)&&"function"!=typeof t?Rt(e):t}function Rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tt(e){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}K.a.getSingleton().register("beforeMergeCells"),K.a.getSingleton().register("afterMergeCells"),K.a.getSingleton().register("beforeUnmergeCells"),K.a.getSingleton().register("afterUnmergeCells");var kt=new WeakMap,jt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ot(e,t)}(l,e);var t,n,i,a=Et(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=a.call(this,e),kt.set(Rt(t),{lastDesiredCoords:null}),t.mergedCellsCollection=null,t.autofillCalculations=null,t.selectionCalculations=null,t}return t=l,(n=[{key:"isEnabled",value:function(){return!!this.hot.getSettings().mergeCells}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.mergedCellsCollection=new at(this),this.autofillCalculations=new ut(this),this.selectionCalculations=new pt(this),this.addHook("afterInit",(function(){return e.onAfterInit.apply(e,arguments)})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown.apply(e,arguments)})),this.addHook("modifyTransformStart",(function(){return e.onModifyTransformStart.apply(e,arguments)})),this.addHook("afterModifyTransformStart",(function(){return e.onAfterModifyTransformStart.apply(e,arguments)})),this.addHook("modifyTransformEnd",(function(){return e.onModifyTransformEnd.apply(e,arguments)})),this.addHook("modifyGetCellCoords",(function(){return e.onModifyGetCellCoords.apply(e,arguments)})),this.addHook("beforeSetRangeEnd",(function(){return e.onBeforeSetRangeEnd.apply(e,arguments)})),this.addHook("afterIsMultipleSelection",(function(){return e.onAfterIsMultipleSelection.apply(e,arguments)})),this.addHook("afterRenderer",(function(){return e.onAfterRenderer.apply(e,arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){return e.addMergeActionsToContextMenu.apply(e,arguments)})),this.addHook("afterGetCellMeta",(function(){return e.onAfterGetCellMeta.apply(e,arguments)})),this.addHook("afterViewportRowCalculatorOverride",(function(){return e.onAfterViewportRowCalculatorOverride.apply(e,arguments)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){return e.onAfterViewportColumnCalculatorOverride.apply(e,arguments)})),this.addHook("modifyAutofillRange",(function(){return e.onModifyAutofillRange.apply(e,arguments)})),this.addHook("afterCreateCol",(function(){return e.onAfterCreateCol.apply(e,arguments)})),this.addHook("afterRemoveCol",(function(){return e.onAfterRemoveCol.apply(e,arguments)})),this.addHook("afterCreateRow",(function(){return e.onAfterCreateRow.apply(e,arguments)})),this.addHook("afterRemoveRow",(function(){return e.onAfterRemoveRow.apply(e,arguments)})),this.addHook("afterChange",(function(){return e.onAfterChange.apply(e,arguments)})),this.addHook("beforeDrawBorders",(function(){return e.onBeforeDrawAreaBorders.apply(e,arguments)})),this.addHook("afterDrawSelection",(function(){return e.onAfterDrawSelection.apply(e,arguments)})),this.addHook("beforeRemoveCellClassNames",(function(){return e.onBeforeRemoveCellClassNames.apply(e,arguments)})),Ct(Tt(l.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.hot.render(),Ct(Tt(l.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var e=this.hot.getSettings().mergeCells;this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),Ct(Tt(l.prototype),"updatePlugin",this).call(this)}},{key:"validateSetting",value:function(e){var t=!0;return!!e&&(Je.containsNegativeValues(e)?(Object(et.b)(Je.NEGATIVE_VALUES_WARNING(e)),t=!1):Je.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Object(et.b)(Je.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):Je.isSingleCell(e)?(Object(et.b)(Je.IS_SINGLE_CELL(e)),t=!1):Je.containsZeroSpan(e)&&(Object(et.b)(Je.ZERO_SPAN_WARNING(e)),t=!1),t)}},{key:"generateFromSettings",value:function(e){var t=this;if(Array.isArray(e)){var n,r=[];Object(o.arrayEach)(e,(function(e){if(t.validateSetting(e)){var n=new m.a(e.row,e.col),o=new m.a(e.row+e.rowspan-1,e.col+e.colspan-1),i=new m.b(n,n,o);r.push(t.mergeRange(i,!0,!0))}})),r=r.filter((function(e){return!0!==e}));var i=this.getBulkCollectionData(r);(n=this.hot).populateFromArray.apply(n,gt(i))}}},{key:"getBulkCollectionData",value:function(e){var t,n=this.getBulkCollectionDataRange(e),r=(t=this.hot).getData.apply(t,gt(n)).splice(0);return Object(o.arrayEach)(e,(function(e){var t=yt(e,3),i=t[0],a=t[1],l=t[2];Object(o.arrayEach)(l,(function(e,t){Object(o.arrayEach)(e,(function(e,o){r[i-n[0]+t][a-n[1]+o]=e}))}))})),[n[0],n[1],r]}},{key:"getBulkCollectionDataRange",value:function(e){var t=[0,0],n=[0,0],r=null,i=null,a=null;return Object(o.arrayEach)(e,(function(e){r=e[0],i=e[1],a=e[2],t[0]=Math.min(r,t[0]),t[1]=Math.min(i,t[1]),n[0]=Math.max(r+a.length-1,n[0]),n[1]=Math.max(i+a[0].length-1,n[1])})),[].concat(t,n)}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!t||this.validateSetting(e)}},{key:"toggleMergeOnSelection",value:function(){var e=this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,n=e.to;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){e.setDirection("NW-SE");var t=e.from,n=e.to;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"unmergeSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(e){var t=e.from,n=e.to;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}}},{key:"mergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.getTopLeftCorner(),i=e.getBottomRightCorner(),a={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},l=[],s=null;if(!this.canMergeRange(a,n))return!1;this.hot.runHooks("beforeMergeCells",e,n),Object(h.rangeEach)(0,a.rowspan-1,(function(e){Object(h.rangeEach)(0,a.colspan-1,(function(n){var r=null;l[e]||(l[e]=[]),0===e&&0===n?r=t.hot.getDataAtCell(a.row,a.col):t.hot.setCellMeta(a.row+e,a.col+n,"hidden",!0),l[e][n]=r}))})),this.hot.setCellMeta(a.row,a.col,"spanned",!0);var c=this.mergedCellsCollection.add(a);return!c||(r?s=[a.row,a.col,l]:this.hot.populateFromArray(a.row,a.col,l,void 0,void 0,this.pluginName),this.hot.runHooks("afterMergeCells",e,a,n),s)}},{key:"unmergeRange",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),Object(o.arrayEach)(r,(function(e){t.mergedCellsCollection.remove(e.row,e.col),Object(h.rangeEach)(0,e.rowspan-1,(function(n){Object(h.rangeEach)(0,e.colspan-1,(function(r){t.hot.removeCellMeta(e.row+n,e.col+r,"hidden")}))})),t.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}},{key:"toggleMerge",value:function(e){var t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}},{key:"merge",value:function(e,t,n,r){var o=new m.a(e,t),i=new m.a(n,r);this.mergeRange(new m.b(o,o,i))}},{key:"unmerge",value:function(e,t,n,r){var o=new m.a(e,t),i=new m.a(n,r);this.unmergeRange(new m.b(o,o,i))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings().mergeCells),this.hot.render()}},{key:"onBeforeKeyDown",value:function(e){(e.ctrlKey||e.metaKey)&&!e.altKey&&77===e.keyCode&&(this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render(),Object(Ge.stopImmediatePropagation)(e))}},{key:"onAfterIsMultipleSelection",value:function(e){if(e)for(var t=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=0;r<t.length;r+=1)if(n.highlight.row===t[r].row&&n.highlight.col===t[r].col&&n.to.row===t[r].row+t[r].rowspan-1&&n.to.col===t[r].col+t[r].colspan-1)return!1;return e}},{key:"onModifyTransformStart",value:function(e){var t,n=kt.get(this),r=this.hot.getSelectedRangeLast(),o={row:e.row,col:e.col},i=new m.a(r.highlight.row,r.highlight.col),a=this.mergedCellsCollection.get(i.row,i.col);if(n.lastDesiredCoords||(n.lastDesiredCoords=new m.a(null,null)),a){var l=new m.a(a.row,a.col),s=new m.a(a.row+a.rowspan-1,a.col+a.colspan-1);new m.b(l,l,s).includes(n.lastDesiredCoords)||(n.lastDesiredCoords=new m.a(null,null)),o.row=n.lastDesiredCoords.row?n.lastDesiredCoords.row-i.row:o.row,o.col=n.lastDesiredCoords.col?n.lastDesiredCoords.col-i.col:o.col,e.row>0?o.row=a.row+a.rowspan-1-i.row+e.row:e.row<0&&(o.row=i.row-a.row+e.row),e.col>0?o.col=a.col+a.colspan-1-i.col+e.col:e.col<0&&(o.col=i.col-a.col+e.col)}t=new m.a(r.highlight.row+o.row,r.highlight.col+o.col);var c=this.mergedCellsCollection.get(t.row,t.col);c&&(n.lastDesiredCoords=t,o={row:c.row-i.row,col:c.col-i.col}),0!==o.row&&(e.row=o.row),0!==o.col&&(e.col=o.col)}},{key:"onModifyTransformEnd",value:function(e){var t=this,n=this.hot.getSelectedRangeLast(),i=Object(r.clone)(e),a=this.selectionCalculations.getUpdatedSelectionRange(n,e),l=Object(r.clone)(i),s=this.mergedCellsCollection.getWithinRange(a,!0);do{l=Object(r.clone)(i),this.selectionCalculations.getUpdatedSelectionRange(n,i),Object(o.arrayEach)(s,(function(e){t.selectionCalculations.snapDelta(i,n,e)}))}while(i.row!==l.row||i.col!==l.col);e.row=i.row,e.col=i.col}},{key:"onModifyGetCellCoords",value:function(e,t){if(!(e<0||t<0)){var n=this.mergedCellsCollection.get(e,t);if(n){var r=n.row,o=n.col,i=n.colspan,a=n.rowspan;return[].concat(gt(this.translateMergedCellToRenderable(r,0,o,0)),gt(this.translateMergedCellToRenderable(r,a,o,i)))}}}},{key:"addMergeActionsToContextMenu",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name:function(){var e=this.getSelectedLast();if(e){var n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase($.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase($.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var e=this.getSelectedLast();return!e||Je.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}},{key:"onAfterRenderer",value:function(e,t,n){var o=this.mergedCellsCollection.get(t,n),i=Object(r.isObject)(o)?Object(r.clone)(o):void 0;if(Object(r.isObject)(i)){var a=this.hot,l=a.rowIndexMapper,s=a.columnIndexMapper,c=i.row,u=i.col,f=i.colspan,h=i.rowspan,d=yt(this.translateMergedCellToRenderable(c,h,u,f),2),p=d[0],v=d[1],y=p-l.getRenderableFromVisualIndex(t)+1,g=v-s.getRenderableFromVisualIndex(n)+1;i.row=l.getFirstNotHiddenIndex(i.row,1),i.col=s.getFirstNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,y),i.colspan=Math.min(i.colspan,g)}tt(e,i,t,n)}},{key:"onBeforeSetRangeEnd",value:function(e){var t=this.hot.getSelectedRangeLast();t.highlight=new m.a(t.highlight.row,t.highlight.col),t.to=e;var n=!1;if(!this.hot.selection.isSelectedByColumnHeader()&&!this.hot.selection.isSelectedByRowHeader())do{n=!1;for(var r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){var o=this.mergedCellsCollection.mergedCells[r].getRange();t.expandByRange(o)&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}},{key:"onAfterGetCellMeta",value:function(e,t,n){var r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(e){var t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}},{key:"modifyViewportRowStart",value:function(e,t){for(var n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(e.startRow),i=0;i<t;i+=1){var a=this.mergedCellsCollection.get(o,i);if(Object(r.isObject)(a)){var l=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(a.row,1));if(l<e.startRow)return e.startRow=l,void this.modifyViewportRowStart(e,t)}}}},{key:"modifyViewportRowEnd",value:function(e,t){for(var n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(e.endRow),i=0;i<t;i+=1){var a=this.mergedCellsCollection.get(o,i);if(Object(r.isObject)(a)){var l=a.row+a.rowspan-1,s=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(l,-1));if(s>e.endRow)return e.endRow=s,void this.modifyViewportRowEnd(e,t)}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(e){var t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}},{key:"modifyViewportColumnStart",value:function(e,t){for(var n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(e.startColumn),i=0;i<t;i+=1){var a=this.mergedCellsCollection.get(i,o);if(Object(r.isObject)(a)){var l=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(a.col,1));if(l<e.startColumn)return e.startColumn=l,void this.modifyViewportColumnStart(e,t)}}}},{key:"modifyViewportColumnEnd",value:function(e,t){for(var n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(e.endColumn),i=0;i<t;i+=1){var a=this.mergedCellsCollection.get(i,o);if(Object(r.isObject)(a)){var l=a.col+a.colspan-1,s=n.getRenderableFromVisualIndex(n.getFirstNotHiddenIndex(l,-1));if(s>e.endColumn)return e.endColumn=s,void this.modifyViewportColumnEnd(e,t)}}}},{key:"translateMergedCellToRenderable",value:function(e,t,n,r){var o,i,a=this.hot,l=a.rowIndexMapper,s=a.columnIndexMapper;return o=0===t?l.getFirstNotHiddenIndex(e,1):l.getFirstNotHiddenIndex(e+t-1,-1),i=0===r?s.getFirstNotHiddenIndex(n,1):s.getFirstNotHiddenIndex(n+r-1,-1),[e>=0?l.getRenderableFromVisualIndex(o):e,n>=0?s.getRenderableFromVisualIndex(i):n]}},{key:"onModifyAutofillRange",value:function(e,t){this.autofillCalculations.correctSelectionAreaSize(t);var n=this.autofillCalculations.getDirection(t,e),r=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,r,n))return r=t;var o=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return o?r=this.autofillCalculations.snapDragArea(t,r,n,o):r}},{key:"onAfterCreateCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}},{key:"onAfterRemoveCol",value:function(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}},{key:"onAfterCreateRow",value:function(e,t,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",e,t)}},{key:"onAfterRemoveRow",value:function(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}},{key:"onAfterChange",value:function(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}},{key:"onBeforeDrawAreaBorders",value:function(e,t){if(t&&"area"===t){var n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);Object(o.arrayEach)(r,(function(t){n.getBottomRightCorner().row===t.getLastRow()&&n.getBottomRightCorner().col===t.getLastColumn()&&(e[2]=t.row,e[3]=t.col)}))}}},{key:"onAfterModifyTransformStart",value:function(e,t,n){if(this.enabled){var r=this.mergedCellsCollection.get(e.row,e.col);if(r){var o=t>0,i=t<0,a=n<0,l=n>0,s=r.row+r.rowspan-1==this.hot.countRows()-1,c=0===r.row,u=r.col+r.colspan-1==this.hot.countCols()-1,f=0===r.col;(o&&s||i&&c||l&&u||a&&f)&&(e.row=r.row,e.col=r.col)}}}},{key:"onAfterDrawSelection",value:function(e,t,n,r){return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,r)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}])&&wt(t.prototype,n),i&&wt(t,i),l}(c);Object(i.d)("mergeCells",jt);var Mt=jt;function At(e){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _t(e,t,n){return(_t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lt(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ht(e,t){return(Ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function It(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lt(e);if(t){var o=Lt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xt(this,n)}}function xt(e,t){return!t||"object"!==At(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lt(e){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ht(e,t)}(a,e);var t,n,r,i=It(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).scrollbars=[],t.clones=[],t.lockedCollection=!1,t.freezeOverlays=!1,t}return t=a,(n=[{key:"isEnabled",value:function(){return Object(u.isTouchSupported)()}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterRender",(function(){return e.onAfterRender()})),this.registerEvents(),_t(Lt(a.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,_t(Lt(a.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){_t(Lt(a.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.addHook("beforeTouchScroll",(function(){return e.onBeforeTouchScroll()})),this.addHook("afterMomentumScroll",(function(){return e.onAfterMomentumScroll()}))}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var e=this.hot.view.wt.wtOverlays,t=e.topOverlay,n=e.bottomOverlay,r=e.leftOverlay,o=e.topLeftCornerOverlay,i=e.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),n.clone&&this.scrollbars.push(n),this.scrollbars.push(r),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones.length=0,t.needFullRender&&this.clones.push(t.clone.wtTable.wtRootElement),n.needFullRender&&this.clones.push(n.clone.wtTable.wtRootElement),r.needFullRender&&this.clones.push(r.clone.wtTable.wtRootElement),o&&this.clones.push(o.clone.wtTable.wtRootElement),i&&i.clone&&this.clones.push(i.clone.wtTable.wtRootElement)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,Object(o.arrayEach)(this.clones,(function(e){Object(I.addClass)(e,"hide-tween")}))}},{key:"onAfterMomentumScroll",value:function(){var e=this;this.freezeOverlays=!1,Object(o.arrayEach)(this.clones,(function(e){Object(I.removeClass)(e,"hide-tween"),Object(I.addClass)(e,"show-tween")})),setTimeout((function(){Object(o.arrayEach)(e.clones,(function(e){Object(I.removeClass)(e,"show-tween")}))}),400),Object(o.arrayEach)(this.scrollbars,(function(e){e.redrawClone(),e.adjustElementsPosition()})),this.hot.view.wt.wtOverlays.propagateMasterScrollPositionsToClones()}}])&&Nt(t.prototype,n),r&&Nt(t,r),a}(c);Object(i.d)("touchScroll",Pt);var Dt=Pt},function(e,t,n){"use strict";var r=n(161),o=n(197),i=n(178),a=n(210),l=n(166),s=n(163),c=n(155),u=n(156),f={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;Object(u.arrayEach)(this._hooksStorage[e]||[],(function(n){t.hot.removeHook(e,n)}))},clearHooks:function(){var e=this;Object(c.objectEach)(this._hooksStorage,(function(t,n){return e.removeHooksByKey(n)})),this._hooksStorage={}}};Object(c.defineGetter)(f,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var h=f;function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g(e);if(t){var o=g(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w="STATE_VIRGIN",C="STATE_EDITING",O="STATE_WAITING",E="STATE_FINISHED",S=function(){function e(t){m(this,e),this.hot=t,this.instance=t,this.state=w,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}var t,n,o;return t=e,(n=[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,t,n,r,o,i){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=o,this.cellProperties=i,this.state=w}},{key:"extend",value:function(){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,e);var t=v(n);function n(){return m(this,n),t.apply(this,arguments)}return n}(this.constructor)}},{key:"saveValue",value:function(e,t){var n,r;t?((n=this.hot.getSelectedLast())[0]>n[2]&&(r=n[0],n[0]=n[2],n[2]=r),n[1]>n[3]&&(r=n[1],n[1]=n[3],n[3]=r)):n=[this.row,this.col,null,null],this.hot.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")}},{key:"beginEditing",value:function(e,t){if(this.state===w){if(this.hot.view.scrollViewport(new r.a(this.row,this.col)),this.state=C,this.isInFullEditMode()){var n="string"==typeof e?e:Object(s.stringify)(this.originalValue);this.setValue(n)}this.open(t),this._opened=!0,this.focus(),this.hot.view.render(),this.hot.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,t,n){var r,o=this;if(n){var i=this._closeCallback;this._closeCallback=function(e){i&&i(e),n(e),o.hot.view.render()}}if(!this.isWaiting())if(this.state!==w){if(this.state===C){if(e)return this.cancelChanges(),void this.hot.view.render();var a=this.getValue();r=this.hot.getSettings().trimWhitespace?[["string"==typeof a?String.prototype.trim.call(a||""):a]]:[[a]],this.state=O,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(e){o.state=E,o.discardEditor(e)})):(this.state=E,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){o._fireCallbacks(!0)}))}},{key:"cancelChanges",value:function(){this.state=E,this.discardEditor()}},{key:"discardEditor",value:function(e){this.state===E&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=C,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=w,this._fireCallbacks(!0)))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===O}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"right":return"ht_clone_right";case"left":return"ht_clone_left";case"bottom":return"ht_clone_bottom";case"bottom-right-corner":return"ht_clone_bottom_right_corner";case"bottom-left-corner":return"ht_clone_bottom_left_corner";case"top":return"ht_clone_top";case"top-right-corner":return"ht_clone_top_right_corner";case"top-left-corner":return"ht_clone_top_left_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsLeft&&(t="left"),t}}])&&b(t.prototype,n),o&&b(t,o),e}();Object(c.mixin)(S,h);var R=n(157);function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.tableMeta=n,this.selection=r,this.eventManager=new l.a(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.lastKeyCode=void 0,this.instance.addHook("afterDocumentKeyDown",(function(e){return o.onAfterDocumentKeyDown(e)}));for(var i=this.instance.rootWindow;i;)this.eventManager.addEventListener(i.document.documentElement,"keydown",(function(e){o.destroyed||o.instance.runHooks("afterDocumentKeyDown",e)})),i=Object(R.getParentWindow)(i);this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(e){!o.destroyed&&o.activeEditor&&!o.activeEditor.isOpened()&&o.instance.isListening()&&o.openEditor("",e)})),this.instance.view.wt.update("onCellDblClick",(function(e,t,n){return o.onCellDblClick(e,t,n)}))}var t,n,s;return t=e,(n=[{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(t){t&&e.prepareEditor()}));else{var t=this.instance.selection.selectedRange.current().highlight,n=t.row,r=t.col;this.cellProperties=this.instance.getCellMeta(n,r);var o=this.instance.rootDocument.activeElement;if(o&&o.blur(),this.cellProperties.readOnly)this.clearActiveEditor();else{var i=this.instance.getCellEditor(this.cellProperties),l=this.instance.getCell(n,r,!0);if(i&&l){var s=this.instance.colToProp(r),c=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(n),r);this.activeEditor=Object(a.b)(i,this.instance),this.activeEditor.prepare(n,r,s,l,c,this.cellProperties)}else this.clearActiveEditor()}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,t){this.activeEditor&&this.activeEditor.beginEditing(e,t)}},{key:"closeEditor",value:function(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"moveSelectionAfterEnter",value:function(e){var t="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}},{key:"moveSelectionUp",value:function(e){e?this.selection.transformEnd(-1,0):this.selection.transformStart(-1,0)}},{key:"moveSelectionDown",value:function(e){e?this.selection.transformEnd(1,0):this.selection.transformStart(1,0)}},{key:"moveSelectionRight",value:function(e){e?this.selection.transformEnd(0,1):this.selection.transformStart(0,1)}},{key:"moveSelectionLeft",value:function(e){e?this.selection.transformEnd(0,-1):this.selection.transformStart(0,-1)}},{key:"onAfterDocumentKeyDown",value:function(e){if(this.instance.isListening()&&(this.instance.runHooks("beforeKeyDown",e),!this.destroyed&&229!==e.keyCode&&!Object(i.isImmediatePropagationStopped)(e)&&(this.lastKeyCode=e.keyCode,this.selection.isSelected()))){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;if(!this.activeEditor||this.activeEditor.isWaiting()||Object(o.isMetaKey)(e.keyCode)||Object(o.isCtrlMetaKey)(e.keyCode)||t||this.isEditorOpened()){var n,a=e.shiftKey,l=a?this.selection.setRangeEnd:this.selection.setRangeStart;switch(e.keyCode){case o.KEY_CODES.A:!this.isEditorOpened()&&t&&(this.instance.selectAll(),e.preventDefault(),e.stopPropagation());break;case o.KEY_CODES.ARROW_UP:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(t),this.moveSelectionUp(a),e.preventDefault(),e.stopPropagation();break;case o.KEY_CODES.ARROW_DOWN:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(t),this.moveSelectionDown(a),e.preventDefault(),e.stopPropagation();break;case o.KEY_CODES.ARROW_RIGHT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(t),this.moveSelectionRight(a),e.preventDefault(),e.stopPropagation();break;case o.KEY_CODES.ARROW_LEFT:this.isEditorOpened()&&!this.activeEditor.isWaiting()&&this.closeEditorAndSaveChanges(t),this.moveSelectionLeft(a),e.preventDefault(),e.stopPropagation();break;case o.KEY_CODES.TAB:n="function"==typeof this.tableMeta.tabMoves?this.tableMeta.tabMoves(e):this.tableMeta.tabMoves,a?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0),e.preventDefault(),e.stopPropagation();break;case o.KEY_CODES.BACKSPACE:case o.KEY_CODES.DELETE:this.instance.emptySelectedCells(),this.prepareEditor(),e.preventDefault();break;case o.KEY_CODES.F2:this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e),e.preventDefault();break;case o.KEY_CODES.ENTER:this.isEditorOpened()?(this.activeEditor&&this.activeEditor.state!==O&&this.closeEditorAndSaveChanges(t),this.moveSelectionAfterEnter(a)):this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.activeEditor&&(this.activeEditor.enableFullEditMode(),this.openEditor(null,e)):this.moveSelectionAfterEnter(a),e.preventDefault(),Object(i.stopImmediatePropagation)(e);break;case o.KEY_CODES.ESCAPE:this.isEditorOpened()&&(this.closeEditorAndRestoreOriginalValue(t),this.activeEditor.focus()),e.preventDefault();break;case o.KEY_CODES.HOME:e.ctrlKey||e.metaKey?l.call(this.selection,new r.a(0,this.selection.selectedRange.current().from.col)):l.call(this.selection,new r.a(this.selection.selectedRange.current().from.row,0)),e.preventDefault(),e.stopPropagation();break;case o.KEY_CODES.END:e.ctrlKey||e.metaKey?l.call(this.selection,new r.a(this.instance.countRows()-1,this.selection.selectedRange.current().from.col)):l.call(this.selection,new r.a(this.selection.selectedRange.current().from.row,this.instance.countCols()-1)),e.preventDefault(),e.stopPropagation();break;case o.KEY_CODES.PAGE_UP:this.selection.transformStart(-this.instance.countVisibleRows(),0),e.preventDefault(),e.stopPropagation();break;case o.KEY_CODES.PAGE_DOWN:this.selection.transformStart(this.instance.countVisibleRows(),0),e.preventDefault(),e.stopPropagation()}}else this.openEditor("",e)}}},{key:"onCellDblClick",value:function(e,t,n){"TD"===n.nodeName&&(this.activeEditor&&this.activeEditor.enableFullEditMode(),this.openEditor(null,e))}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}])&&T(t.prototype,n),s&&T(t,s),e}(),j=new WeakMap;k.getInstance=function(e,t,n){var r=j.get(e);return r||(r=new k(e,t,n),j.set(e,r)),r};t.a=k},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=function(){return o.a.createElement("div",{className:"developer-screen"},o.a.createElement("h1",{className:"developer-screen--title"},"Handsontable Spreadsheet Viewer"),o.a.createElement("p",null,"Hello, developer!"),o.a.createElement("p",null,"This app is intended to be run:"),o.a.createElement("ul",null,o.a.createElement("li",null,"with URL parameters, as explained in"," ",o.a.createElement("a",{href:"https://github.com/handsontable/spreadsheet-viewer/wiki/Query-String-API",target:"_blank",rel:"noopener noreferrer"},"Query String API")),o.a.createElement("li",null,"or, in an iframe driven by asynchronous messages, as explained in"," ",o.a.createElement("a",{href:"https://github.com/handsontable/spreadsheet-viewer/wiki/JavaScript-API",target:"_blank",rel:"noopener noreferrer"},"JavaScript API"))))},a=n(62),l=n(205),s=n(257),c=n(5),u=n(33),f=n(63),h=n(34),d=n(196);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var o=w(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b(this,n)}}function b(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(i,e);var t,n,r,o=m(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).floatingBoxSettings=[],t.floatingBoxMeta=new WeakMap,t.isFirstRender=!0,t.floatingBoxSettings=[],t.floatingBoxMeta=new WeakMap,t.resetState(),t}return t=i,(n=[{key:"resetState",value:function(){this.floatingBoxSettings=[],this.floatingBoxMeta=new WeakMap}},{key:"getExtendedHotSettings",value:function(){return this.hot.getSettings()}},{key:"isEnabled",value:function(){return!!this.getExtendedHotSettings().floatingBox}},{key:"enablePlugin",value:function(){this.enabled||(this.addHook("afterLoadData",this.afterLoadData.bind(this)),this.addHook("afterUpdateSettings",this.afterUpdateSettings.bind(this)),this.addHook("afterRenderer",this.afterRenderer.bind(this)),this.addHook("beforeRender",this.beforeRender.bind(this)),this.addHook("afterRender",this.afterRender.bind(this)),y(w(i.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.resetState(),y(w(i.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),y(w(i.prototype),"updatePlugin",this).call(this)}},{key:"afterLoadData",value:function(){this.afterUpdateSettings()}},{key:"afterRenderer",value:function(e,t,n){var r=this;this.floatingBoxSettings.forEach((function(o){var i,a,l,s,c=r.floatingBoxMeta.get(o);if(c&&o.topLeftRow<=t&&o.topLeftColumn<=n&&o.bottomRightRow>=t&&o.bottomRightColumn>=n){var u=(null===(s=null===(l=null===(a=null===(i=e.parentElement)||void 0===i?void 0:i.parentElement)||void 0===a?void 0:a.parentElement)||void 0===l?void 0:l.parentElement)||void 0===s?void 0:s.parentElement)||void 0;u&&!c.containerParents.has(u)&&c.containerParents.add(u)}}))}},{key:"beforeRender",value:function(){var e=this;this.floatingBoxSettings.forEach((function(t){var n=e.floatingBoxMeta.get(t);n||(n={top:void 0,left:void 0,width:void 0,height:void 0,containerParents:new Set,containers:new Map},e.floatingBoxMeta.set(t,n))}))}},{key:"afterRender",value:function(){var e=this;this.isFirstRender&&(this.isFirstRender=!1,this.getExtendedHotSettings().mergeCells.length>0)||0!==this.floatingBoxSettings.length&&(this.floatingBoxSettings.forEach((function(t){var n=e.floatingBoxMeta.get(t);if(n&&n.containerParents.size>0&&void 0===n.width){var r=e.hot.view.wt,o=-r.getSetting("columnHeaders").length,i=-r.getSetting("rowHeaders").length;n.left=-1+t.topLeftOffsetX+r.wtOverlays.leftOverlay.sumCellSizes(o,t.topLeftColumn),n.top=3+t.topLeftOffsetY+r.wtOverlays.topOverlay.sumCellSizes(i,t.topLeftRow);var a=r.wtOverlays.leftOverlay.sumCellSizes(t.topLeftColumn,t.bottomRightColumn+1);n.width=-1+t.bottomRightOffsetX-t.topLeftOffsetX+a;var l=r.wtOverlays.topOverlay.sumCellSizes(t.topLeftRow,t.bottomRightRow+1);n.height=-1+t.bottomRightOffsetY-t.topLeftOffsetY+l}})),this.floatingBoxSettings.forEach((function(t){var n=e.floatingBoxMeta.get(t);n&&n.containerParents.size>n.containers.size&&n.containerParents.forEach((function(e){if(!n.containers.has(e)){var r=function(e,t,n){var r=document.createElement("div");if(r.classList.add("sv-handsontable-floating-box"),r.style.left="".concat(t.left,"px"),r.style.top="".concat(t.top,"px"),r.style.width="".concat(t.width,"px"),r.style.height="".concat(t.height,"px"),n.appendChild(r),void 0===t.width||void 0===t.height)throw new Error("Could not retrieve sizes of the floating box");return e.renderer(r,t.width,t.height),r}(t,n,e);n.containers.set(e,r)}}))})))}},{key:"afterUpdateSettings",value:function(){var e=this.getExtendedHotSettings();Array.isArray(e.floatingBox)?this.floatingBoxSettings=e.floatingBox:this.floatingBoxSettings=[]}},{key:"destroy",value:function(){y(w(i.prototype),"destroy",this).call(this)}}])&&v(t.prototype,n),r&&v(t,r),i}(d.a.plugins.BasePlugin);d.a.plugins.registerPlugin("FloatingBoxPlugin",C);var O=n(9),E=n(270),S=n.n(E),R=n(46),T={Arial:"Liberation Sans","Times New Roman":"Liberation Serif","Courier New":"Liberation Mono",Calibri:"Carlito",Cambria:"Caladea"},k={"Liberation Serif":"serif","Liberation Mono":"monospace","Liberation Sans":"sans-serif",Carlito:"sans-serif",Caladea:"sans-serif"},j=new Map,M=1;var A,N;function _(e){var t=document.createElement("span");t.innerHTML=Array(100).join("wi"),t.style.position="absolute",t.style.fontSize="128px",t.style.left="-99999px",t.style.fontFamily=e,document.body.appendChild(t);var n=t.clientWidth;if(document.body.removeChild(t),n<1)throw new Error("Could not measure the text size. Maybe you called too early?");return n}var H=new Map;var I=function(){0===(M-=1)&&(document.body.dataset.webfontsLoaded="")};function x(e,t,n){var r=[],o=Object(R.b)(T,e,void 0);if(function(e){if(void 0===A&&(A=_("sans-serif")),void 0===N&&(N=_("serif")),H.has(e))return H.get(e);var t=_("".concat(e,", sans-serif")),n=_("".concat(e,", serif")),r=!(A===t&&N===n);return H.set(e,r),r}(e))r.push('"'.concat(e,'"'));else if(o){r.push('"'.concat(o,'"')),r.push('"'.concat(function(e){return Object(R.b)(k,e,"sans-serif")}(o),'"'));var i="".concat(o," ").concat(t," ").concat(n);if(!j.has(i)){1===(M+=1)&&delete document.body.dataset.webfontsLoaded;var a=function(e,t,n){return new S.a(e,{weight:t,style:n}).load(null,1e4)}(o,t,n).then((function(){console.log("Font loaded",o,t,n),I()})).catch((function(){console.log("Font failed to load",o,t,n),I()}));j.set(i,a)}}else r.push('"'.concat("Arial",'"')),r.push('"'.concat("sans-serif",'"'));return r.join(", ")}I();var L,P=n(64),D=n(217),B=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))};!function(e){e.CHART="chart",e.IMAGE="image"}(L||(L={}));var F=n(248),V=n(66),W=function(e,t){return e.type===L.IMAGE?function(e){return function(t,n,o){t.classList.add("sv-handsontable-image"),Object(P.render)(r.createElement("img",{src:e.imageData,alt:"",style:{width:n,height:o}}),t)}}(e):Object(V.a)()?function(e,t){return function(r,o,i){var a=this;Object(D.b)(),B(a,void 0,void 0,regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all([n.e(6),n.e(3)]).then(n.bind(null,306));case 2:a.sent.getChartRenderer(e,t)(r,o,i);case 5:case"end":return a.stop()}}),a)})))}}(e,t):function(e,t,n){e.classList.add("sv-handsontable-chart"),Object(P.render)(o.a.createElement(F.a,null),e)}},U=function(e){return null===e},z=n(65),G=["$","","","","","","","","","","","","","","","","Ar","B/.","Br","Bs.","Bs.S.","BTC","C$","CHF","EC$","HK$","kr","Ksh","L","MOP","Nfk","NT$","P","Q","R","R$","RF","RM","Rp","Rs","Rs.","S","S/","US$","XBT","XDR","","","","AED","ADP","AFA","AFN","ALL","AMD","ANG","AOA","ARS","ATS","AUD","AWG","AZM","AZN","BAM","BBD","BDT","BEF","BGN","BGL","BHD","BIF","BMD","BND","BOB","BOV","BRL","BSD","BTC","BTN","BWP","BYB","BYR","BYN","BZD","CAD","CDF","CHE","CHW","CLF","CLN","CLP","CNY","COP","COU","CSD","CRC","CUC","CUP","CVE","CYP","CZK","DJF","DEM","DKK","DOP","DZD","ECS","ECV","EEK","ESP","EGP","ERN","ETB","ETH","EUR","FJD","FIM","FKP","FRF","GBP","GEL","GGP","GHC","GHS","GIP","GMD","GNF","GTQ","GYD","GRD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","IEP","IMP","INR","IQD","IRR","ILS","IQD","ISK","ITL","JEP","JMD","JOD","JPY","KAF","KES","KGS","KHR","KMF","KPW","KRW","KPW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LTC","LTL","LVL","LYD","MAD","MDL","MGA","MGF","MKD","MMK","MNT","MOP","MRO","MRU","MUR","MVR","MWK","MXN","MYR","MZN","MZM","NAD","NGN","NIO","NOK","NLG","NPR","NTD","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","PTE","QAR","RMB","RON","ROL","RSD","RUB","RUR","RWF","SAR","SBD","SCR","SDD","SDP","SDG","SEK","SGD","SHP","SLL","SKK","SIT","SOS","SRD","SSP","SPL","STD","STN","SVC","SYP","SZL","THB","TJS","TJR","TMT","TND","TMM","TOP","TRL","TRY","TTD","TVD","TWD","TZS","UAH","UGX","USD","USN","USS","UYU","UYI","UZS","VEB","VEF","VES","VND","VUV","WST","XAF","XAG","XBT","XAU","XCD","XOF","XB5","XBA","XBB","XBC","XBD","XDR","XFO","XFU","XPD","XPF","XPT","XTS","XXX","YER","YUM","ZAR","ZWD","ZWL","ZWN","ZWR"];function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Y,q={viewportRowRenderingOffset:1e4,viewportColumnRenderingOffset:256},$=function(e){return e/9525},Q=function(e,t){return e/9525-t},Z=function(e,t){var n=e/9525-t;return-Math.round(Math.abs(n))};function J(){Object(c.c)(c.a.presentationHotRendering)}function ee(){this.getSettings().showGrid||this.rootElement.classList.add("sv-hide-gridlines")}!function(e){e.General="general",e.Accounting="accounting",e.Currency="currency"}(Y||(Y={}));var te=["color","fontSize","lineHeight","textDecoration","textShadow","overflow","textAlign","verticalAlign","direction","wordBreak","whiteSpace","display"],ne=function(e){var t,n,r="solid"===e.patternType,o=Object.assign({backgroundColor:r&&e.fgColor?"#".concat(e.fgColor.rgb):"",fontFamily:null!==(t=e.fontFamily)&&void 0!==t?t:"",fontStyle:null!==(n=e.fontStyle)&&void 0!==n?n:"",borderRightColor:r&&!U(e.border)?"transparent":"",borderBottomColor:r&&!U(e.border)?"transparent":""},e.fontFamily?function(){var t,n=function(e){if("number"==typeof e)return e;if(void 0===e)return 400;var t=parseInt(e,10);return t||("bold"===e?700:400)}(e.fontWeight||400),r=null!==(t=e.fontStyle)&&void 0!==t?t:"normal";return{fontWeight:n,fontStyle:r,fontFamily:x(e.fontFamily,n,r)}}():{});return te.forEach((function(t){e[t]&&(o[t]=e[t])})),o},re=function(e){var t=e.s,n=e.e,r=n.r-t.r,o=n.c-t.c;return r>=0&&(r+=1),o>=0&&(o+=1),{row:t.r,col:t.c,rowspan:r,colspan:o,mergedColumn:r>1e4,mergedRow:o>256}};function oe(e,t,n,r,o,i,a){t.firstElementChild||function(e){var t=document.createElement("div"),n=document.createElement("div");n.className="sv-cell-text-wrapper__currency";var r=document.createElement("div");r.className="sv-cell-text-wrapper__value",t.appendChild(n),t.appendChild(r),e.appendChild(t)}(t);var l=t.firstElementChild,s=null==l?void 0:l.firstElementChild,c=null==l?void 0:l.lastElementChild;l.removeAttribute("style"),l.className="sv-cell-text-wrapper";var u=we(n,r);if(!a.svMultiRowCells.has(u)&&Array.isArray(a.rowHeights)){var f=a.rowHeights[n],h=Number(f)-1,p=a.horizontalOverlap.styleMap;if(l.style.maxHeight="".concat(h,"px"),a.cellClassName){var v=p[a.cellClassName].lineHeight;if(v){var y=parseInt(v,10);l.style.lineHeight="".concat(Math.min(h,y),"px ")}}}var g=a.horizontalOverlap.obscuredNonText.get(u),m=a.numberFormat;(function(e){return(null==e?void 0:e.format)===Y.Accounting&&e.currencySymbol&&e.currencyValue})(a.numberFormat)&&!g?(l.classList.add("sv-cell-text-wrapper--accounting"),d.a.dom.fastInnerText(s," ".concat(m.currencySymbol," ")),d.a.dom.fastInnerText(c,m.currencyValue)):d.a.dom.fastInnerText(c,g||i||"");var b=a.rowClassNames.get(n);b&&t.classList.add(b);var w=a.columnClassNames.get(r);w&&t.classList.add(w),a.cellClassName&&t.classList.add(a.cellClassName);var C=a.horizontalOverlap,O=C.overlapStartCells.get(u);return O&&(l.classList.add("sv-handsontable-horizontal-overlay"),Object.assign(l.style,O)),C.hideRightGridlineTds.has(u)&&t.classList.add("sv-handsontable-hide-right-gridline"),t}var ie=function(e,t,n){var r={row:t,col:n};return["left","right","bottom","top"].forEach((function(t){var n,o=e[t];(null==o?void 0:o.width)&&(r[t]={width:(n=o.width,"thin"===n?1:"medium"===n?2:"thick"===n?3:1),color:"#".concat(o.color||"000")})})),r},ae=function(e,t,n){if(!e||"General"===t)return Y.General;var r=e.trim()!==e;return"n"===n&&r?Y.Accounting:"n"!==n||r?Y.General:Y.Currency},le=function(e,t){if(t===Y.Accounting&&e){var n,r,o=e.search(/[-\\(0-9]/);if(o>0){var i=X((r=o,[(n=e).substring(0,r),n.substring(r)]),2),a=i[0],l=i[1],s=a.trim();if(G.includes(s))return{currencySymbol:s,currencyValue:l}}}},se=function(e,t,n){return Math.min(n,Math.max(t,e))};function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function he(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t,n){return(pe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=me(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ve(e,t){return(ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=me(e);if(t){var o=me(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ge(this,n)}}function ge(e,t){return!t||"object"!==ce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var be,we=function(e,t){return"".concat(e,",").concat(t)},Ce=new Map,Oe=new Map,Ee=function(){Ce.clear(),Oe.clear(),be=function(e){if(document.getElementById(e))throw new Error("measuringContainer already exists");var t=document.createElement("div");return t.setAttribute("id",e),document.body.appendChild(t),t}("sv-handsontable-horizontal-overlay-measuring")},Se=function(e,t){var n="".concat(e,"|").concat(t),r=Oe.get(n);if(void 0!==r)return r;var o=Ce.get(t);o||(o=function(e){var t=document.createElement("canvas");if(void 0===be)throw new Error("measuringContainer doesn't exist");be.appendChild(t);var n=t.getContext("2d");if(null===n)throw new Error("Failed to obtain CanvasRenderingContext2D");return n.font=e,n}(t),Ce.set(t,o));var i=o.measureText(e).width;return Oe.set(n,i),i},Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ve(e,t)}(i,e);var t,n,r,o=ye(i);function i(){return he(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"resetState",value:function(){this.measureAllCells()}},{key:"getExtendedHotSettings",value:function(){return this.hot.getSettings()}},{key:"isEnabled",value:function(){return!!this.getExtendedHotSettings().horizontalOverlap}},{key:"enablePlugin",value:function(){this.enabled||(this.addHook("init",this.onInit.bind(this)),pe(me(i.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.resetState(),pe(me(i.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pe(me(i.prototype),"updatePlugin",this).call(this)}},{key:"onInit",value:function(){this.resetState()}},{key:"createCustomBordersMap",value:function(e){for(var t=new Map,n=0;n<e.length;n++){var r=e[n],o=r.row,i=r.col,a=we(o,i);t.set(a,e[n])}return t}},{key:"measureAllCells",value:function(){var e,t=this,n=this.getExtendedHotSettings(),r=n.customBorders,o=n.horizontalOverlap,i=this.createCustomBordersMap(r),a=this.hot.getData(),l=a[0].length;Ee(),o.startCells.forEach((function(e){var n=ue(e.split(",").map((function(e){return parseInt(e,10)})),2),r=n[0],o=n[1],s=a[r];t.performTextOverlapping(r,o,l,s,i)})),null===(e=null==be?void 0:be.parentElement)||void 0===e||e.removeChild(be)}},{key:"hideBorderLeftEdge",value:function(e,t,n){var r=we(t,n),o=e.get(r);o&&this.hideBorderEdge(o.left)}},{key:"hideBorderRightEdge",value:function(e,t,n){var r=we(t,n),o=e.get(r);o&&this.hideBorderEdge(o.right)}},{key:"hideBorderEdge",value:function(e){e&&!e.hide&&(e.hide=!0)}},{key:"obscureString",value:function(e){return Array(e.length).fill("#").join("")}},{key:"performTextOverlapping",value:function(e,t,n,r,o){var i="left",a=!1,l=0,s=this.getCellProperties(e,t),c=this.getExtendedHotSettings(),u=c.columns,f=c.colWidths,h=c.rowHeights,d=c.horizontalOverlap,p=d.stopCells.has(we(e,t-1)),v=d.stopCells.has(we(e,t+1));if(!(s.isTextContent&&p&&v)){var y=s.cellClassName||"",g=d.styleMap[y];if(g&&(g.textAlign&&(i=g.textAlign),g.indent&&(l=9*g.indent),"break-word"===g.wordBreak&&(a=!0)),s.isTextContent){if(a)return;if("right"===i){if(0===t)return;if(p)return}else if(v)return}var m=we(e,t);if(!Array.isArray(f))throw new Error("colWidths must be an Array");if(!Array.isArray(h))throw new Error("rowHeights must be an Array");var b=f[t],w=g?"".concat(g.fontStyle||""," ").concat(g.fontWeight||""," ").concat(g.fontStretch||""," ").concat(g.fontSize," ").concat(g.fontFamily):"",C=r[t];if(null===C)throw new Error("rowData[".concat(t,"] must be a string"));var O=Se(C,w)+l;if(O){var E=O+5;if(E>b){if(!s.isTextContent)return void d.obscuredNonText.set(m,this.obscureString(C));var S=0,R=b,T=!1;"right"===i&&(T=!0);for(var k=t-1,j=t+1;R<E;){if(T){if(k<0)break;if(d.stopCells.has(we(e,k)))break;var M=f[k];R+=Number(M),S-=Number(M),d.hideRightGridlineTds.add(we(e,k)),this.hideBorderLeftEdge(o,e,k+1),this.hideBorderRightEdge(o,e,k),k-=1}else{if(j===n){u.length===n&&(u.length=n+1,f[n]=0,this.hot.initIndexMappers());var A=E-R+4;f[n]<A&&(f[n]=A)}if(d.stopCells.has(we(e,j)))break;var N=f[j];R+=Number(N),d.hideRightGridlineTds.add(we(e,j-1)),this.hideBorderLeftEdge(o,e,j),this.hideBorderRightEdge(o,e,j-1),j+=1}"center"===i&&(T=!T)}var _=Number(h[e])-1;d.overlapStartCells.set(m,{left:"".concat(S,"px"),width:"".concat(R-4-1,"px"),height:"".concat(_,"px")})}}}}},{key:"getCellProperties",value:function(e,t){return this.hot.getCellMeta(e,t)}},{key:"destroy",value:function(){pe(me(i.prototype),"destroy",this).call(this)}}])&&de(t.prototype,n),r&&de(t,r),i}(d.a.plugins.BasePlugin);d.a.plugins.registerPlugin("HorizontalOverlapPlugin",Re);var Te=n(4);function ke(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return je(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Me=function(e){var t=e.children,n=e.holdDownChildRenderPromise,i=ke(Object(r.useState)(),2),a=i[0],l=i[1];return Object(r.useEffect)((function(){var e=!0;return n?n.then((function(){e&&l(t)})):l(t),function(){e=!1}}),[t,n]),o.a.createElement(o.a.Fragment,null,a)};function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Le(e);if(t){var o=Le(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xe(this,n)}}function xe(e,t){return!t||"object"!==Ae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Le(e){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pe=function(e){return function(t,n,r,o){Object(u.c)(e,[t,n,r,o])}},De=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(i,e);var t,n,r,o=Ie(i);function i(){return Ne(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"componentDidCatch",value:function(e){throw new Te.k(null==e?void 0:e.message)}},{key:"render",value:function(){return this.props.children}}])&&_e(t.prototype,n),r&&_e(t,r),i}(r.PureComponent),Be=function(e){var t=e.parsedData,n=e.sheet,i=e.shouldSimulateHandsontableError,a=e.shouldSimulateInterpreterError,l=e.requestMessageOnError,u=e.fullPage,p=e.svId,v=Object(r.useRef)(),y=Object(z.b)();Object(f.a)(h.f,h.c,l,(function(e){var t,n=e.range;null===(t=v.current)||void 0===t||t.selectCells([n])}));var g=function(e){v.current=null==e?void 0:e.hotInstance},m=Object(r.useMemo)((function(){Object(D.c)();try{if(Object(c.c)(c.a.interpreter),a)throw new Error("This is a simulation of an error in the interpreter");Object(c.c)(c.a.interpreterStyleClone);var e=JSON.parse(JSON.stringify(t.styleMap));Object(c.b)(c.a.interpreterStyleClone),Object(c.c)(c.a.interpreterCss);var r=(s=e,Object.entries(s).map((function(e){var t=X(e,2),n=t[0],r=t[1],o=document.createElement("style");document.head.appendChild(o);var i=o.sheet,a=n.includes("cell")?4:3,l=new Array(a).fill(".".concat(n)).join("");i.insertRule("".concat(l," {}"),0);var s=i.cssRules[0],c=ne(r);Object.assign(s.style,c),Object.assign(r,c);var u=s.cssText;if(document.head.removeChild(o),r.indent&&r.indent>0){var f=r.indent,h=9*Number(f),d="left"===r.textAlign?"padding-left":"padding-right";u+="\n        .handsontable td.".concat(n," .sv-cell-text-wrapper {\n          ").concat(d,": ").concat(h,"px;\n         }\n        ")}return u+=function(e,t){switch(e.textAlign){case"right":return"\n      .handsontable td.".concat(t," .sv-cell-text-wrapper {\n        margin-right: ").concat(4,"px;\n        justify-content: flex-end;\n        }\n    ");case"center":return"\n      .handsontable td.".concat(t," .sv-cell-text-wrapper {\n        justify-content: center;\n        min-width: 100%;\n        }\n    ");default:return"\n    .handsontable td.".concat(t," .sv-cell-text-wrapper {\n      margin-left: ").concat(4,"px;\n      justify-content: flex-start;\n      }\n  ")}}(r,n),"break-word"===r.wordBreak?u+=function(e,t){var n="";switch(e.verticalAlign){case"top":n="\n        position: absolute;\n        top: 0;\n        align-items: flex-start;\n      ";break;case"bottom":n="\n        position: absolute;\n        bottom: 0;\n        align-items: flex-end;\n      ";break;default:n="\n        position: relative;\n        align-items: center;\n      "}return"\n    .handsontable td.".concat(t," {\n      position: relative;\n    }\n    .handsontable td.").concat(t," .sv-cell-text-wrapper {\n      display: flex;\n      white-space: pre-wrap;\n      ").concat(n,"\n    }\n  ")}(r,n):u+=function(e,t){var n="";switch(e.verticalAlign){case"top":n="\n        align-items: flex-start;\n      ";break;case"bottom":n="\n        align-items: flex-end;\n      ";break;default:n="\n        align-items: center;\n      "}return"\n    .handsontable td.".concat(t," .sv-handsontable-horizontal-overlay {\n      ").concat(n,"\n    }\n  ")}(r,n),u})).join(" "));Object(c.b)(c.a.interpreterCss),Object(c.c)(c.a.interpreterHotConfig);var o=Object.values(t.sheetsData)[n];if(!o)throw new Error("Could not retrieve parsed data for the given sheet number (".concat(n,")"));var i=o.data;if(!i)throw new Error("Could not retrieve parsed data for the given sheet (".concat(o.title,")"));var l=function(e,t){var n,r;if(!e||e.hidden)return{};for(var o=new Map,i={data:[],cell:[],afterLoadData:J,afterInit:ee,readOnly:!0,colHeaders:!0,rowHeaders:!0,licenseKey:"non-commercial-and-evaluation",showGrid:!0,cells:function(){return{renderer:oe}},beforePaste:function(){return!1},columns:[],mergeCells:[],colWidths:[],rowHeights:[],fixedRowsTop:0,fixedColumnsLeft:0,fillHandle:!1,customBorders:new Array,floatingBox:[],selectionMode:"range",selectionStyle:{cell:{borderWidth:2,borderColor:"rgb(16, 74, 204)"},area:{borderWidth:1,borderColor:"rgb(16, 74, 204)"}},horizontalOverlap:{startCells:new Set,stopCells:new Set,styleMap:t,overlapStartCells:new Map,hideRightGridlineTds:new Set,obscuredNonText:new Map},svMultiRowCells:new Set,rowClassNames:new Map,columnClassNames:new Map,beforeInitWalkontable:function(e){e.externalRowCalculator=!0}},a=e[O.b],l=a.columns.wpx,s=a.rows.hpx,c=-1,u=-1,f=0,h=Object.entries(e);f<h.length;f++){var p=X(h[f],2),v=p[0],y=p[1];switch(v){case O.c:y.forEach((function(e){var t=e.s,n=e.e,r=re({s:t,e:n});i.mergeCells.push(r);var o=r.mergedColumn||r.mergedRow,a=t.c,l=t.r,s=Math.min(255,n.c),f=Math.min(9999,n.r);if(s>c&&!o&&(c=s),f>u&&!o&&(u=f),l<f){var h=we(l,a);i.svMultiRowCells.add(h)}for(var d=l;d<=f;d++)for(var p=a;p<=s;p++){var v=we(d,p);i.horizontalOverlap.stopCells.add(v),i.horizontalOverlap.startCells.delete(v)}}));break;case O.a:var g=y;g.length>256&&(g.length=256);for(var m=0;m<g.length;m++){var b=g[m];i.colWidths[m]=(null==b?void 0:b.wpx)||l,(null==b?void 0:b.svStyleId)&&i.columnClassNames.set(m,b.svStyleId),(null==b?void 0:b.hidden)&&i.fixedColumnsLeft&&i.fixedColumnsLeft>0&&m<i.fixedColumnsLeft&&(console.log("This sheet contains an unsupported hidden column inside a frozen pane. To avoid potentially incorrect rendering, we have disabled the frozen pane on the left."),i.fixedColumnsLeft=0)}break;case O.e:var w=y;w.length>1e4&&(w.length=1e4);for(var C=0;C<w.length;C++){var E=w[C],S=null==E?void 0:E.hpx;i.rowHeights[C]=S||s,(null==E?void 0:E.svStyleId)&&i.rowClassNames.set(C,E.svStyleId),(null==E?void 0:E.hidden)&&i.fixedRowsTop&&i.fixedRowsTop>0&&C<i.fixedRowsTop&&(console.log("This sheet contains an unsupported hidden row inside a frozen pane. To avoid potentially incorrect rendering, we have disabled the frozen pane on top."),i.fixedRowsTop=0)}break;case O.h:Object(z.b)()||(i.fixedColumnsLeft=parseInt(y,10));break;case O.i:Object(z.b)()||(i.fixedRowsTop=parseInt(y,10));break;case O.f:!1!==y&&0!==y||(i.showGrid=!1);break;case O.d:y.forEach((function(t){if(t&&t.anchor&&t.type){var n,r=t.anchor,o="number"==typeof r.dxL,a=parseInt(r.colR,10),f=parseInt(r.rwB,10),h=void 0===i.colWidths[a]?l:i.colWidths[a],d=void 0===i.rowHeights[f]?s:i.rowHeights[f],p={topLeftRow:parseInt(r.rwT,10),topLeftColumn:parseInt(r.colL,10),bottomRightColumn:a,bottomRightRow:f,topLeftOffsetX:o?0:(n=parseInt(r.dxL,10),n/9525),topLeftOffsetY:o?0:$(parseInt(r.dyT,10)),bottomRightOffsetX:o?0:Q(parseInt(r.dxR,10),h),bottomRightOffsetY:o?0:Z(parseInt(r.dyB,10),d),renderer:W(t,e)};i.floatingBox.push(p),a>c&&(c=a),f>u&&(u=f)}else console.warn("Skipping an embedded object of an unsupported type")}));break;default:if(!y)break;var R=v.match(/^([a-zA-Z]+)([0-9]+)/);if(!R||!R[1]||!R[2]||Number(R[2])>1e4)break;var T=Number(R[2])-1,k=d.a.helper.spreadsheetColumnIndex(R[1]);if(k+1>256)break;var j=y,M=i.data&&i.data[T]?i.data[T]:[],A=!1,N=!1;if(j.svStyleId){var _=t[j.svStyleId],H=_.border,I=_.wordBreak;if(H){A=!0;var x=ie(H,T,k);i.customBorders.push(x)}N=void 0===I}var L=j.w||j.v||"";N&&"string"==typeof L&&(L=L.replace(/[\r\n]+/gm,""));var P=!!L;if((P||A)&&(M[k]=L,i.data&&(i.data[T]=M),k>c&&(c=k),T>u&&(u=T),P)){var D=we(T,k);i.horizontalOverlap.stopCells.add(D),i.horizontalOverlap.startCells.add(D)}var B=ae(j.w,j.z,j.t),F=le(j.w,B),V={row:T,col:k,cellClassName:j.svStyleId,isTextContent:j.isTextContent,numberFormat:Object.assign({format:B},F&&Object.assign({},F))};o.set(we(T,k),j),null===(n=i.cell)||void 0===n||n.push(V)}}var U=se(c+1,6,256),G=se(u+1,20,1e4);if(i.mergeCells=i.mergeCells.map((function(e){return Object.assign(Object.assign({},e),{rowspan:Math.min(G-e.row,e.rowspan),colspan:Math.min(U-e.col,e.colspan)})})),i.data)if(i.data.length>G)i.data.splice(G);else if(i.data.length<G){var K=i.data.length;i.data.length=G,i.data.fill([],K,G)}if(i.rowHeights.length<G){var Y=i.rowHeights.length;i.rowHeights.length=G,i.rowHeights.fill(s,Y,G)}if(i.colWidths.length<U){var q=i.colWidths.length;i.colWidths.length=U,i.colWidths.fill(l,q,U)}for(var te=0;te<G;te++)for(var ne=0;ne<U;ne++){var ce=null===(r=i.data)||void 0===r?void 0:r[te],ue=ce&&ce[ne],fe=o.get(we(te,ne));if(void 0===ue&&!fe){var he=i.columnClassNames.get(ne);if(he){var de=t[he];if(de.border){var pe=ie(de.border,te,ne);i.customBorders.push(pe)}}var ve=i.rowClassNames.get(te);if(ve){var ye=t[ve];if(ye.border){var ge=ie(ye.border,te,ne);i.customBorders.push(ge)}}}}return i.columns.length=U,{tableProps:i}}(i,e).tableProps;if(!(l=u?Object.assign(Object.assign({},l),q):Object.assign(Object.assign({},l),{width:"100%",height:"100%"})))throw new Error("Could not create a `tableProps` object for the given sheet");return{cssText:r,tableProps:l,fontsLoadedPromise:Promise.all(Array.from(j.values()))}}catch(e){throw console.error("interpreter:",e),new Te.f(null==e?void 0:e.message)}finally{Object(c.b)(c.a.interpreterHotConfig),Object(c.b)(c.a.interpreter)}var s}),[t,n,a,u]),b=m.cssText,w=m.tableProps,C=m.fontsLoadedPromise,E=Object(r.useMemo)((function(){var e=Math.random().toString(32).substring(2);return o.a.createElement(s.a,{settings:w,afterSelection:function(e,t,n,r,o){y&&(o.value=!0)},afterSelectionEnd:Pe(p),afterRender:function(){if(Object(c.b)(c.a.presentationHotRendering),Object(c.b)(c.a.presentation),Object(D.d)(),i)throw new Error("This is a simulation of an error in rendering of Handsontable")},copyPaste:!y||{uiContainer:document.createElement("div")},ref:g,key:e})}),[i,w,y,p]);return o.a.createElement("div",{className:"sv-hottable-wrapper",role:"tabpanel"},o.a.createElement(Me,{holdDownChildRenderPromise:C},o.a.createElement("style",null,b),u&&o.a.createElement("style",null,"\n.sv-hottable-wrapper {\n  width: initial;\n  height: initial;\n  margin-bottom: initial;\n  margin-top: initial;\n  position: static;\n}\n.handsontable {\n  transform: none !important; /*disable row and column headings fixing to the viewport edge*/\n}\n"),o.a.createElement(De,null,E)))},Fe=n(302),Ve=n(303),We=n(305),Ue=n(164),ze=n(307),Ge=function(e){return r.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 16 16",preserveAspectRatio:"none"},e),r.createElement("path",{d:"M11.201 11.999V4.085a.074.074 0 00-.123-.066l-6.33 3.958a.074.074 0 000 .131l6.329 3.957a.074.074 0 00.123-.066z"}))},Xe=function(e){return r.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 16 16",preserveAspectRatio:"none"},e),r.createElement("path",{d:"M5 4.082v7.92a.082.082 0 00.126.07l6.335-3.96a.082.082 0 000-.14L5.126 4.011A.083.083 0 005 4.082z"}))};function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ye=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},qe=function(e){return Object.entries(e).filter((function(e){return e[1]})).map((function(e){return e[0]})).join(" ")},$e=r.forwardRef((function(e,t){var n,o=e.classes,i=e.className,a=e.direction,l=e.orientation,s=e.disabled,c=Ye(e,["classes","className","direction","orientation","disabled"]);return r.createElement(ze.a,Object.assign({component:"div",className:qe((n={},Ke(n,o.root||"",!0),Ke(n,o.vertical||"","vertical"===l),Ke(n,"sv-tab-scroll-button-disabled",Boolean(s)),Ke(n,i||"",!0),Ke(n,"sv-tab-scroll-button",!0),n)),ref:t},c),"left"===a?r.createElement(Ge,{"data-cy":"tabbar-left-caret"}):r.createElement(Xe,{"data-cy":"tabbar-right-caret"}))})),Qe=Object(Ue.a)({root:{width:40,flexShrink:0},disabled:{}})($e),Ze=n(312),Je=function(e){var t=e.isActive;return o.a.createElement(o.a.Fragment,null,o.a.createElement("svg",{height:"16",width:"16",viewBox:"5 4 16 16",className:t?"active":"inactive"},o.a.createElement("path",{className:"sv-hamburger-icon",d:"M19.922 11H4.078a.09.09 0 00-.078.1v1.8a.089.089 0 00.078.1h15.844a.089.089 0 00.078-.1v-1.8a.09.09 0 00-.078-.1zM19.922 6H4.078A.09.09 0 004 6.1v1.8a.089.089 0 00.078.1h15.844A.089.089 0 0020 7.9V6.1a.09.09 0 00-.078-.1zM19.922 16H4.078a.09.09 0 00-.078.1v1.8a.089.089 0 00.078.1h15.844a.089.089 0 00.078-.1v-1.8a.09.09 0 00-.078-.1z"})),o.a.createElement("div",{role:"tooltip",className:"icon-tooltip"},o.a.createElement("span",null,"More sheets")))},et=function(e){var t=e.isActive;return o.a.createElement(o.a.Fragment,null,o.a.createElement("svg",{height:"24",width:"24",viewBox:"0 0 24 24",className:t?"active":"inactive"},o.a.createElement("g",{transform:"translate(-679.64 -429.029)"},o.a.createElement("rect",{className:"sv-hamburger-icon",width:20.001,height:2,rx:.098,transform:"translate(681.64 433.029)"}),o.a.createElement("rect",{className:"sv-hamburger-icon",width:20.001,height:2,rx:.098,transform:"translate(681.64 440.029)"}),o.a.createElement("rect",{className:"sv-hamburger-icon",width:20.001,height:2,rx:.098,transform:"translate(681.64 447.029)"}))))},tt=function(e){var t=e.onClick,n=e.isClicked,r=e.isMobile;return o.a.createElement("div",{className:"sv-dropup-menu-button",role:"button",tabIndex:0,onClick:t,"data-cy":"dropup-menu-button"},r?o.a.createElement(et,{isActive:n}):o.a.createElement(Je,{isActive:n}))},nt=n(309),rt=function(e){var t=e.anchorEl,n=e.handleCloseMenu,r=e.children,i=e.isMobile;return o.a.createElement(nt.a,{anchorEl:t,keepMounted:!0,open:Boolean(t),onClose:n,anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},PaperProps:{style:i?{maxHeight:232,width:232}:{maxHeight:267,width:152}},classes:{paper:"sv-dropup-menu-container",list:"sv-dropup-menu-list"}},r)};function ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return it(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var at=function(e){var t=e.currentTabIndex,n=e.onTabChange,i=e.titles,a=ot(Object(r.useState)(void 0),2),l=a[0],s=a[1],c=Object(z.b)();return o.a.createElement(o.a.Fragment,null,o.a.createElement(tt,{onClick:function(e){s(e.currentTarget)},isClicked:!!l,isMobile:c}),o.a.createElement(rt,{anchorEl:l,handleCloseMenu:function(){s(void 0)},isMobile:c},i.map((function(e,r){var i=t===r?"active":"";return o.a.createElement(Ze.a,{key:r,selected:Boolean(i),classes:{root:"sv-dropup-menu-item",selected:i},onMouseDown:function(){return n(r)},disableRipple:!0,"data-cy":"dropup-menu-item-".concat(r)},o.a.createElement("div",null,e))}))))},lt=function(e){var t=e.currentTabIndex,n=e.onTabChange,i=e.titles;Object(r.useMemo)((function(){return Object(c.c)(c.a.presentationTabsRendering)}),[]),Object(r.useLayoutEffect)((function(){return Object(c.b)(c.a.presentationTabsRendering)}),[]),Object(c.c)(c.a.presentationTabsParsing);var a=o.a.createElement(Ve.a,{position:"static",color:"default",className:"sv-tabbar"},o.a.createElement(at,{onTabChange:n,currentTabIndex:t,titles:i}),o.a.createElement(We.a,{value:t,onChange:function(e,t){return n(Number(t))},textColor:"primary",variant:"scrollable",scrollButtons:"auto",ScrollButtonComponent:Qe,"aria-label":"scrollable auto tabs example",classes:{indicator:"sv-tab-indicator",scrollable:"sv-tabs-scrollable"},className:"sv-tabs","data-cy":"tabbar"},i.map((function(e,t){return function(e,t,n){return o.a.createElement(Fe.a,{label:e,key:t,className:"sv-tab","data-cy":"tabbar-workbook-tab",disableRipple:!0,onMouseDown:function(e){e.preventDefault(),n()}})}(e,t,(function(){return n(t)}))}))));return Object(c.b)(c.a.presentationTabsParsing),a},st=n(219);function ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ut(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ft=n(24),ht=n(204),dt=function(e){e.preventDefault()};t.default=function(e){var t,n,s,c,u=e.onSheetChange,f=e.simulateError,h=e.loadWorkbook,d=e.workbookState,p=e.latestLoadedSheet,v=e.requestMessageOnError,y=e.svId,g=Object(l.useModals)(),m=g.Modals,b=g.openModal,w=(t=1e3,n=ct(Object(r.useState)(!1),2),s=n[0],c=n[1],Object(r.useEffect)((function(){var e=setTimeout((function(){return c(!0)}),t);return function(){return clearTimeout(e)}}),[t]),s);return Object(r.useEffect)((function(){if(f===Te.l.REACT_INITIALIZATION_ERROR)throw new Error(Te.l.REACT_INITIALIZATION_ERROR)}),[f]),function(){var e;if(void 0===d)return w?o.a.createElement(i,null):o.a.createElement(a.a,null);if("initialising"===d.type)return null;var t=d.sheetHistory.latestSheet,n=void 0===p?void 0:d.sheets.get(p),r=Object(V.b)();Object(ft.a)(r,d.sheetNames.length);var l=d.input;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"sv-app-container",onContextMenu:dt},o.a.createElement(m,null),!r&&o.a.createElement(st.a,{fileName:null!==(e=Object(ht.a)(l))&&void 0!==e?e:ht.b,workbookLocation:"url"===l.type?l.url:l.arrayBuffer,renderWorkbook:h,openModal:b}),void 0!==p&&"ready"===(null==n?void 0:n.type)&&o.a.createElement(Be,{shouldSimulateHandsontableError:f===Te.l.RENDER_ERROR,shouldSimulateInterpreterError:f===Te.l.INTERPRETER_ERROR,parsedData:n.parsedData,sheet:p,requestMessageOnError:v,fullPage:r,svId:y}),!r&&o.a.createElement(lt,{currentTabIndex:t,onTabChange:u,titles:d.sheetNames})))}()||o.a.createElement(a.a,null)}}])]);